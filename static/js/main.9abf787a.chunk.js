(this.webpackJsonpeatlas=this.webpackJsonpeatlas||[]).push([[0],{103:function(e,t,n){"use strict";var a=n(29),r=n(1),i=n.n(r),o=n(126);t.a=function(e){var t=Object(r.useState)([]),n=Object(a.a)(t,2),l=n[0],c=n[1],s=e.onSelectCallback,u=e.values,d=e.filter,m=e.multiVarSelect,p=e.title,f=e.single;return i.a.createElement(o.Select,{options:u,labelKey:"id",valueKey:"value",placeholder:p||"Choose",maxDropdownHeight:"300px",type:o.TYPE.search,multi:!f,onChange:function(e){var t=e.value;c(t),m?(0===Object.keys(t).length?delete m[d]:m[d]=new Set(t.map((function(e){return e.value}))),"function"===typeof s&&s(0===Object.keys(m).length?{what:""}:{what:"multi",selected:m})):"function"===typeof s&&s(t)},value:e.value||l})}},127:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(115),r=n(204),i=n(29),o=n(1),l=n.n(o),c=n(31),s=n(618),u=n(17),d=Object(c.o)(c.m);function m(e){var t=Object(o.useState)(),n=Object(i.a)(t,2),m=n[0],p=n[1],f=Object(o.useState)(null),h=Object(i.a)(f,2),g=h[0],y=h[1],b=Object(o.useState)(null),v=Object(i.a)(b,2),k=v[0],O=v[1],E=Object(o.useState)(null),j=Object(i.a)(E,2),S=j[0],w=j[1],x=Object(o.useState)(null),C=Object(i.a)(x,2),_=C[0],N=C[1],M=Object(o.useState)(null),A=Object(i.a)(M,2),L=A[0],P=A[1],z=Object(o.useState)([]),V=Object(i.a)(z,2),F=V[0],T=V[1],D=e.type;if(!D)return null;var I=e.type!==c.i&&!e.noLimit&&e.data.length>10?e.data.slice(0,10):e.data,R=I.map((function(e,t){return Object(r.a)({},e,{color:I.length===F.length?0:Number(!F.includes(t))})})),B=e.plotStyle,Y=e.title,W=e.noXAxis,U=e.noYAxis,H=e.onValueClick,K=e.onDragSelected;return I&&I.length>1&&l.a.createElement("div",{className:"unselectable",style:{position:"relative"},onMouseDown:function(e){g||k||(y(e.clientX),O(e.clientY))},onMouseMove:function(e){if(g&&k){var t=e.clientX,n=e.clientY;w(t),N(n),P(l.a.createElement("div",{style:{position:"fixed",left:g>t?t:g,top:k>_?n:k,width:Math.abs(t-g),height:Math.abs(n-k),backgroundColor:"gray",opacity:.2}}))}},onMouseUp:function(e){y(null),O(null),w(null),N(null),P(null),L&&"function"===typeof K&&K(F.map((function(e){return R[e]&&R[e].x}))),T([])},onMouseOut:function(){L||T([])}},e.type!==c.i&&!e.noLimit&&e.data&&e.data.length>10&&l.a.createElement("h4",null,"Plotting first ",10," values:"),U&&Y&&l.a.createElement("h4",null,Y),l.a.createElement(d,{xType:"ordinal",margin:{bottom:B&&B.marginBottom||40},animation:{duration:1},height:B&&B.height||250,width:B&&B.width||250,onMouseLeave:function(){p(!1)}},!W&&l.a.createElement(c.l,{tickSize:0,tickFormat:function(e){return Object(u.q)(e,10)},tickValues:I.length>10?I.filter((function(e,t){if(t%Math.floor(I.length/10)===0)return e.x})).map((function(e){return e.x})):I.map((function(e){return e.x})),position:"right",tickLabelAngle:-65,style:{line:{strokeWidth:0},text:{fill:e.dark?"#fff":"#000"}}}),!U&&l.a.createElement(c.n,{tickSize:0,tickLabelAngle:-45,tickFormat:function(e){return Object(s.a)(".2s")(e)},style:{line:{strokeWidth:0},title:{fill:e.dark?"#fff":"#000"},text:{fill:e.dark?"#fff":"#000"}},position:"start",title:Y}),l.a.createElement(D,{onValueClick:H,onNearestX:function(e,t){var n=t.index,r=t.innerX;p({x:e.x,y:e.y}),L&&function(e){var t=e.x,n=e.x1,a=e.value;return n>t?a>t&&a<n:a<t&&a<n}({x:g,x1:S,value:r})?F.includes(n)||T([].concat(Object(a.a)(F),[n])):L||T([n])},colorDomain:[0,1],colorRange:["rgb(239, 93, 40)","rgb(18, 147, 154)"],data:R}),m&&l.a.createElement(c.e,{value:m})),g&&S&&L)}},17:function(e,t,n){"use strict";var a=n(115),r=n(1),i=n.n(r),o=n(656),l=n(398),c=n(639),s=n(648),u=n(642),d=n(652),m=n(643),p=n(646),f=n(655),h=n(141),g=n.n(h),y=n(365),b=n(85),v=n.n(b),k=n(37),O=n(42),E=n(43),j=n(49),S=n(48),w=n(50),x=n(629),C=n(396),_=n(395);var N=function(e){function t(){return Object(O.a)(this,t),Object(j.a)(this,Object(S.a)(t).apply(this,arguments))}return Object(w.a)(t,e),Object(E.a)(t,[{key:"shouldUpdateState",value:function(e){return e.changeFlags.somethingChanged}},{key:"updateState",value:function(e){var t=e.props,n=e.oldProps,a=e.changeFlags.dataChanged||t.sizeScale!==n.sizeScale;if(a){var r=new _.a({maxZoom:16,radius:t.sizeScale});r.load(t.data.map((function(e){return{geometry:{coordinates:t.getPosition(e)},properties:e}}))),this.setState({index:r})}var i=Math.floor(this.context.viewport.zoom);(a||i!==this.state.z)&&this.setState({data:this.state.index.getClusters([-180,-85,180,85],i),z:i})}},{key:"getPickingInfo",value:function(e){var t=e.info,n=e.mode,a=t.object&&t.object.properties;return a&&(a.cluster&&"hover"!==n&&(t.objects=this.state.index.getLeaves(a.cluster_id,25).map((function(e){return e.properties}))),t.object=a),t}},{key:"renderLayers",value:function(){var e=this.state.data,t=this.props,n=t.iconAtlas,a=t.iconMapping,r=t.sizeScale;return new C.a(this.getSubLayerProps({id:"icon",data:e,iconAtlas:n,iconMapping:a,sizeScale:r,getPosition:function(e){return e.geometry.coordinates},getIcon:function(e){return 0===(t=e.properties.cluster?e.properties.point_count:1)?"":t<10?"marker-".concat(t):t<100?"marker-".concat(Math.floor(t/10),"0"):"marker-100";var t},getSize:function(e){return t=e.properties.cluster?e.properties.point_count:1,Math.min(100,t)/100+1;var t}}))}}]),t}(x.a),M=n(654),A=n(254);n.d(t,"k",(function(){return F})),n.d(t,"t",(function(){return P})),n.d(t,"s",(function(){return D})),n.d(t,"f",(function(){return z})),n.d(t,"r",(function(){return Z})),n.d(t,"a",(function(){return H})),n.d(t,"p",(function(){return G})),n.d(t,"g",(function(){return X})),n.d(t,"d",(function(){return V})),n.d(t,"q",(function(){return R})),n.d(t,"b",(function(){return K})),n.d(t,"o",(function(){return B})),n.d(t,"c",(function(){return U})),n.d(t,"e",(function(){return L})),n.d(t,"l",(function(){return I})),n.d(t,"m",(function(){return W})),n.d(t,"h",(function(){return T})),n.d(t,"j",(function(){return J})),n.d(t,"i",(function(){return q})),n.d(t,"n",(function(){return Y}));var L=function(e,t){fetch(e).then((function(e){return e.text()})).then((function(e){try{var n=JSON.parse(e);t(n)}catch(a){t(void 0,a)}})).catch((function(e){console.error(e),t(null,e)}))},P=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e&&t){var a=new Map;e.forEach((function(e){var r=e.properties[t];"string"===typeof r&&r.split("/")[2]&&(r=r.split("/")[2]),n&&null!==r&&(a.get(r)?a.set(r,a.get(r)+1):a.set("number"===typeof r?+r:r,1))}));var r="number"===typeof Array.from(a.keys())[0]?Array.from(a.keys()).sort():Array.from(a.keys());return r.map((function(e){return{x:e,y:+a.get(e)}}))}},z=function(e,t,n,a){var r=function(e,t){Object.keys(e).forEach((function(n){return t[n]=e[n]}))};if("hex"===e){var i={id:"hexagon-layer",data:t,pickable:!0,extruded:!0,radius:100,elevationScale:1,getPosition:function(e){return e.geometry.coordinates},onHover:n};return r(a,i),new o.a(i)}if("scatterplot"===e){var f={id:"scatterplot-layer",data:t,pickable:!0,opacity:.8,radiusScale:6,radiusMinPixels:1,radiusMaxPixels:100,getPosition:function(e){return e&&e.geometry&&e.geometry.coordinates},getRadius:function(e){return Math.sqrt(e.exits)},getColor:function(e){return[255,140,0]},onHover:n};return r(a,f),new l.a(f)}if("geojson"===e){var h={id:"geojson-layer",data:t,pickable:!0,stroked:!1,filled:!0,extruded:!0,lineWidthScale:20,lineWidthMinPixels:2,getFillColor:[160,160,180,200],getLineColor:[255,160,180,200],getRadius:100,getLineWidth:1,getElevation:30,onHover:n};return r(a,h),new c.a(h)}if("icon"===e){var g={id:"icon-layer",data:t,pickable:!0,iconAtlas:"location-icon-atlas.png",iconMapping:y,sizeScale:60,getPosition:function(e){return e.geometry.coordinates},wrapLongitude:!0,onHover:n};return r(a,g),new N(g)}if("sgrid"===e){var b={id:"screen_grid",data:t,getPosition:function(e){return e.geometry.coordinates},cellSizePixels:4,onHover:n};return r(a,b),new s.a(b)}if("grid"===e){var v={id:"screen_grid",data:t,pickable:!0,extruded:!0,cellSize:100,elevationScale:4,getPosition:function(e){return e.geometry.coordinates},onHover:n};return r(a,v),new u.a(v)}if("line"===e){var k={id:"line-layer",data:t,pickable:!0,onHover:n};return r(a,k),new d.a(k)}if("arc"===e){var O={id:"arc-layer",data:t,pickable:!0,onHover:n};return r(a,O),new M.a(O)}if("path"===e){var E={id:"path-layer",data:t,pickable:!0,onHover:n};return r(a,E),new A.a(E)}if("heatmap"===e){var j={id:"heatmap-layer",data:t,pickable:!0,onHover:n};return r(a,j),new m.a(j)}if("scatterplot"===e){var S={id:"scatterplot",data:t,pickable:!0,onHover:n,opacity:.3};return r(a,S),new l.a(S)}if("text"===e){var w={id:"text-layer",data:t,pickable:!0,onHover:n};return r(a,w),new p.a(w)}return null},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{oldMax:10,oldMin:1,newMax:1,newMin:0},n=(e-t.oldMin)*(t.newMax-t.newMin)/(t.oldMax-t.oldMin)+t.newMin;return+n.toFixed(2)},F=function(e){if(!e)return null;var t=g.a.parse(e.replace("?","")),n=Number(t.lat).toFixed(3),a=Number(t.lng).toFixed(3);return{latitude:isNaN(n)?53.8321:Number(n),longitude:isNaN(a)?-1.6362:Number(a),zoom:Number(g.a.parse(e).zoom)||10,pit:Number(g.a.parse(e).pit)||55,bea:Number(g.a.parse(e).bea)||0,alt:Number(g.a.parse(e).alt)||1.5}},T=function(e){if(!e)return null;var t=e._sw.lng,n=e._ne.lng,a=e._sw.lat,r=e._ne.lat;return t>n&&(n=e._sw.lng,t=e._ne.lng),a>r&&(r=e._sw.lat,a=e._ne.lat),{xmin:t,ymin:a,xmax:n,ymax:r}},D=function(e){var t=v.a.UI_LIST;return e?1===e?t[0]:e>3&&e<=6?t[1]:2===e||3===e?t[2]:e>9&&e<15?t[3]:t[4]:t[1]},I=function(e){if(!e)return e;for(var t=e.split("_"),n=0;n<t.length;n++)t[n]=t[n].charAt(0).toUpperCase()+t[n].slice(1);return t.join(" ")},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:26;if(Object(k.isNumber)(e))return parseFloat(Number.parseFloat(e).toFixed(2).toString());if(!e||e.length<=t||!Object(k.isString)(e))return e;var n=e.trim(),a=e.split(".").length>1&&e.split(".").pop().length<10&&e.split(".").pop();return n.replace(a,""),e.length>10&&(n=n.substring(0,10)+"..."+(a||"")),n},B=function(e,t,n,a){return i.a.createElement("div",{key:e,onClick:function(){return"function"===typeof n&&n()},style:{cursor:"pointer",textAlign:"center",position:"relative",float:"left",width:"30%",color:a?"white":"black",margin:"10px 2px",border:"1px solid gray"}},i.a.createElement("span",{style:{position:"absolute",left:"10%"}},e),i.a.createElement("div",{style:{width:t+"%",height:20,background:"rgb(18, 147, 154)"}}))},Y=function(e){var t=document.createElement("a");return t.href=e,t.host&&t.host!==window.location.host},W=function(){var e,t=!1;return window.innerWidth<640||(e=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4)))&&(t=!0),t)};var U=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:180;if(!e||!t||0===t.length)return null;var i=Object(k.isNumber)(n)?Object.keys(e.properties)[n]:n,o=!0,l=t.map((function(e){var t=e.properties[i];return Object(k.isNumber)(t)&&"Mean.Travel.Time..Seconds."===n?Math.floor(t/300):(o&&!Object(k.isNumber)(t)&&(o=!1),Object(k.isNumber)(t)?+t:t)}));l=Array.from(new Set(l)),o&&(l=l.sort((function(e,t){return e-t})));var c=l.indexOf(Object(k.isNumber)(e.properties[i])&&"Mean.Travel.Time..Seconds."===n?Math.floor(e.properties[i]/300):e.properties[i]),s=Object(f.a)(c/l.length);return s=s.substring(4,s.length-1).replace(/ /g,"").split(",").map((function(e){return+e})),[].concat(Object(a.a)(s),[r])},H=["inverseDefault","yellowblue","greens","oranges","diverge","default"],K=function(e){if(e){return{yellowblue:[[255,255,204],[199,233,180],[127,205,187],[65,182,196],[44,127,184],[37,52,148]],greens:[[237,248,233],[199,233,192],[161,217,155],[116,196,118],[49,163,84],[0,109,44]],oranges:[[254,237,222],[253,208,162],[253,174,107],[253,141,60],[230,85,13],[166,54,3]],diverge:[[140,81,10],[216,179,101],[246,232,195],[199,234,229],[90,180,172],[1,102,94]],inverseDefault:[[189,0,38],[240,59,32],[253,141,60],[254,178,76],[254,217,118],[255,255,178]],default:[[255,255,178],[254,217,118],[254,178,76],[253,141,60],[240,59,32],[189,0,38]]}[e]}},G=function(e,t){L("https://nominatim.openstreetmap.org/search/"+e+"?format=json",(function(e){"function"===typeof t&&t(e)}))},X=function(e){var t=e.domain,n=e.interpolate,a=void 0===n?f.a:n,r=e.title;if(t&&Array.isArray(t)&&Object(k.isNumber)(t[0])){for(var o=t[t.length-1],l=t[0],c=[i.a.createElement("p",{key:"title"},r)],s=0;s<10;s+=1)c.push(i.a.createElement(i.a.Fragment,null,0===s&&i.a.createElement("i",null,(r===I("Mean.Travel.Time..Seconds.")?+l/300:l).toFixed(2)),i.a.createElement("span",{key:s,style:{background:a(s/10)}}),9===s&&i.a.createElement("i",null,(r===I("Mean.Travel.Time..Seconds.")?+o/300:o).toFixed(2))));return c}},Z=function(e){var t=!0;return e.map((function(e){return!Object(k.isNumber)(e)&&(t=!1)})),t&&(e=e.sort((function(e,t){return e-t}))),e},q=function(e){return e.reduce((function(e,t){return e>=t?e:t}),-1/0)},J=function(e){return e.reduce((function(e,t){return e<=t?e:t}),1/0)}},243:function(e,t){},281:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(42),r=n(43),i=n(49),o=n(48),l=n(50),c=n(1),s=n(372),u=function(e){function t(){var e,n;Object(a.a)(this,t);for(var r=arguments.length,l=new Array(r),c=0;c<r;c++)l[c]=arguments[c];return(n=Object(i.a)(this,(e=Object(o.a)(t)).call.apply(e,[this].concat(l)))).state={progressAmount:0},n.handleDrop=function(e,t){var a=n.props.contentCallback,r=e[0];if(!r.type||r.type.match(/text.*/)||r.type.match(/geo/)||r.type.match(/json/)){var i=new FileReader;i.onload=function(e){n.setState({progressAmount:100}),n.reset();var t=i.result;"function"===typeof a&&a({text:t,name:r.name})},i.readAsText(r)}else n.setState({progressAmount:100}),n.reset(),console.log("File not supported!");n.startProgress()},n.startProgress=function(){n.intervalId=setInterval((function(){n.state.progressAmount>=100?n.reset():n.setState({progressAmount:n.state.progressAmount+10})}),500)},n.reset=function(){clearInterval(n.intervalId),n.setState({progressAmount:0})},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return c.createElement("center",{className:"file-upload"},c.createElement(s.FileUploader,{onCancel:this.reset,onDrop:this.handleDrop,progressAmount:this.state.progressAmount,progressMessage:this.state.progressAmount&&"Uploading... ".concat(this.state.progressAmount,"% of 100%")}))}}]),t}(c.Component)},295:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(29),r=n(1),i=n.n(r),o=n(617),l=n(400),c=n(621),s=n(246),u=n(17);function d(e){var t=e.urlCallback,n=Object(r.useState)("https://domain.com/api/stats19"),d=Object(a.a)(n,2),m=d[0],p=d[1];return i.a.createElement("form",{onKeyPress:function(e){13===e.which&&(e.preventDefault(),Object(u.n)(m)&&"function"===typeof t&&t(m))},className:"search-form"},i.a.createElement(o.a,null,i.a.createElement(l.a,null,i.a.createElement(c.a,{onChange:function(e){var t=e.target.value;p(t)},style:{background:e.dark?"#242730":"white",color:e.dark?"white":"black"},value:m,placeholder:m,type:"text"}),i.a.createElement(l.a.Addon,{style:{background:e.dark?"#242730":"white",color:e.dark?"white":"black"}},i.a.createElement(s.a,{glyph:"globe"})))))}},312:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(42),r=n(43),i=n(49),o=n(48),l=n(60),c=n(50),s=n(1),u=n.n(s),d=(n(547),n(17)),m=n(37),p=n(71),f=n(35),h=n(103),g=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={list:null,showAll:!1,selected:e.multiVarSelect||{},n:5},n._geoJSONPropsOrValues=n._geoJSONPropsOrValues.bind(Object(l.a)(n)),n._showSelectedVars=n._showSelectedVars.bind(Object(l.a)(n)),n._generateList=n._generateList.bind(Object(l.a)(n)),n._processData=n._processData.bind(Object(l.a)(n)),n._multiSelect=n._multiSelect.bind(Object(l.a)(n)),n._showTopn=n._showTopn.bind(Object(l.a)(n)),n._shorten=n._shorten.bind(Object(l.a)(n)),n._button=n._button.bind(Object(l.a)(n)),n}return Object(c.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.data;if(!e||0===e.length)return null;this._processData(e)}},{key:"componentDidUpdate",value:function(e,t){var n=this.props.data;n&&0!==n.length&&(n.length===e.data.length&&this.state.showAll===t.showAll||this._processData(n))}},{key:"_generateList",value:function(){var e=this,t=this.props,n=t.data,a=t.onSelectCallback,r=t.style,i=t.subStyle,o=t.propertyValuesCallback,l=this.state.selected,c=Object(p.b)(n[0]),s=Object(p.c)({features:n}),d=Object.keys(n[0].properties),m=this.state.showAll?d.length:10;return d.slice(0,m).map((function(t){return u.a.createElement("span",{style:r,onClick:function(){if("date"!==t){var r=[];n.forEach((function(e){return Object.keys(e.properties).forEach((function(n){return n===t&&e.properties[t]&&!r.includes(e.properties[t])&&r.push(e.properties[t])}))})),"function"===typeof o&&o({key:t,sublist:r}),r=r.map((function(n){return n&&u.a.createElement("span",{style:i,onClick:function(){l.hasOwnProperty(t)||(l[t]=new Set),l[t].add(n+""),"function"===typeof a&&a(l),e.setState({selected:l})},className:"sub",key:n+""},e._shorten(n,20))})),e.setState({sublist:r,key:t})}},key:t},e._shorten(t)," ",u.a.createElement("i",{style:{color:"orange"},className:"data-type"},"[",c[t].name.substring(0,3),s&&s.includes(t)&&", UNQ","]"))}))}},{key:"_shorten",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return"string"!==typeof e?e:e.length<t?Object(d.l)(e):Object(d.l)(e).substring(0,t)+"..."}},{key:"_processData",value:function(e){var t=this._generateList();this.setState({list:t})}},{key:"_showTopn",value:function(e){var t=this.state,n=t.sublist,a=t.showAll,r=this.state.n;return e.length<r&&(r=e.length),u.a.createElement(u.a.Fragment,null,e.length>5&&u.a.createElement("div",{style:{width:"100%"}},a?this._button(a,"Less",5):this._button(a,void 0,n.length)),e.slice(0,r),u.a.createElement("p",null,"Showing ",r," out of ",e.length))}},{key:"_showSelectedVars",value:function(e,t){var n=this,a=this.props.onSelectCallback,r=[];return e&&e[t]&&e[t].size>0&&e[t].forEach((function(i){0===r.length&&r.push(u.a.createElement("p",{key:"chosen-label"},u.a.createElement("b",null," ".concat(Object(d.l)(t),"'s "))," values")),r.push(u.a.createElement("i",{className:"active-variable",style:n.props.subStyle,key:"remove-"+i,onClick:function(){e[t].delete(i),0===e[t].size&&delete e[t],"function"===typeof a&&a(e),n.setState({selected:e})}},"".concat(i," "),u.a.createElement("span",{style:{borderRadius:"50%"},className:"unselect-variable"},"x")))})),r}},{key:"_geoJSONPropsOrValues",value:function(e,t,n,a){var r=this.state.n;return a?e&&0!==e.length||t&&t[n]&&0!==t[n].size?t&&t[n]&&t[n].size===a.length?null:e.length>r?this._showTopn(e):e:this._showTopn(a):null}},{key:"render",value:function(){var e=this,t=this.state,n=t.list,a=t.sublist,r=t.key,i=t.selected,o=t.showAll,l=this.props,c=l.data,s=l.onSelectCallback,p=a&&i&&r&&a.filter((function(e){return i[r]&&e&&!i[r].has(e.key)}));return c&&0===Object.keys(c[0].properties).filter((function(e){return!Object(m.isEmptyOrSpaces)(e)})).length?u.a.createElement("h3",null,"There are no columns to inspect or filter."):u.a.createElement("div",{style:this.props.style},"Dataset:",u.a.createElement("div",null,u.a.createElement("div",{className:"tagcloud"},r?u.a.createElement(u.a.Fragment,null,u.a.createElement("i",null,"".concat(Object(d.l)(r))),u.a.createElement("span",{onClick:function(){return e.setState({sublist:null,key:null})},style:{borderRadius:"50%"},className:"unselect-variable"},"x")):c&&c.length>1&&Object.keys(c[0].properties).length>10&&!o?u.a.createElement(u.a.Fragment,null,"First (10) of ",Object.keys(c[0].properties).length,":",this._button(o),n):u.a.createElement(u.a.Fragment,null,Object.keys(c[0].properties).length>10&&this._button(o,"Less"),n)),this._multiSelect(r,i,a,s),u.a.createElement("div",{className:"tagcloud"},this._geoJSONPropsOrValues(p,i,r,a)),u.a.createElement("div",{className:"tagcloud"},this._showSelectedVars(i,r))))}},{key:"_multiSelect",value:function(e,t,n,a){var r=this;return e&&u.a.createElement(h.a,{title:"Choose value",multiVarSelect:t,values:n&&n.length>0&&n.map((function(e){return{id:e.key,value:e.key}})),filter:e,onSelectCallback:function(e){"function"===typeof a&&a(e.selected||{}),r.setState({selected:e.selected||{}})},value:t&&t[e]&&Array.from(t[e]).map((function(e){return{id:e,value:e}}))})}},{key:"_button",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Show all",a=arguments.length>2?arguments[2]:void 0;return u.a.createElement(f.Button,{size:f.SIZE.compact,kind:f.KIND.secondary,onClick:function(){t.setState({showAll:!e,n:a||t.state.n})}},n)}}]),t}(s.Component)},335:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(29),r=n(1),i=n.n(r),o=n(196),l=n(248),c=n(17);function s(e){var t=i.a.useState(1),n=Object(a.a)(t,2),r=n[0],s=n[1],u=e.data;if(!u||0===u.length)return null;var d=Math.floor(u.length/10),m=Object.keys(u[0].properties).map((function(e){return Object(c.l)(e)})),p=u.slice(10*r,10*r+10).map((function(e){return Object.keys(e.properties).map((function(t){return e.properties[t]}))}));return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.Pagination,{numPages:d,currentPage:r,onPageChange:function(e){var t=e.nextPage;s(Math.min(Math.max(t,1),d))}}),i.a.createElement(o.Table,{columns:m,data:p}),i.a.createElement(l.Pagination,{numPages:d,currentPage:r,onPageChange:function(e){var t=e.nextPage;s(Math.min(Math.max(t,1),d))}}))}},345:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(42),r=n(43),i=n(49),o=n(48),l=n(50),c=n(1),s=n.n(c),u=n(137),d=n(381),m=n(35),p=n(382),f=n(126),h=n(17),g=function(e){function t(e){var n;return Object(a.a)(this,t),(n=Object(i.a)(this,Object(o.a)(t).call(this,e))).state={checks:[]},n}return Object(l.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.title,a=t.sublist,r=t.suggested,i=t.onChange,o=t.steps;if(!n||!a||0===a.length)return null;var l=this.state.checks,c=r||Object(h.s)(a.length),g=null;if("checkbox"===c)g=s.a.createElement(s.a.Fragment,null,a.map((function(t,n){return s.a.createElement(d.Checkbox,{key:t,checked:e.state.checks[n],value:t,onChange:function(){l[n]=!l[n],e.setState({checks:l})}},t)})));else if("slider"===c&&parseInt(a[0])){var y=a;g=s.a.createElement(s.a.Fragment,null,s.a.createElement(u.Slider,{value:this.state.value||[y[0]],min:parseInt(y[0]),max:parseInt(y[y.length-1]),step:o||1,onChange:function(t){var n=t.value;e.setState({value:n}),"function"===typeof i&&i(n[0])}}),n)}else g="buttongroups"===c?s.a.createElement(s.a.Fragment,null,"Checkbox Mode StatefulButtonGroup",s.a.createElement(p.StatefulButtonGroup,{mode:"checkbox",initialState:{selected:[0]}},a.map((function(e,t){return s.a.createElement(m.Button,{key:e+"-"+t,value:e,onClick:function(e){return console.log(e.target.value)}},e)})))):s.a.createElement(f.StatefulSelect,{options:a.map((function(e){return{id:e}})),labelKey:"id",placeholder:"Choose "+Object(h.l)(n),type:f.TYPE.search,onChange:function(e){return console.log(e&&e.value[0]&&e.value[0].id)}});return g}}]),t}(s.a.Component)},354:function(e,t,n){},360:function(e,t,n){"use strict";var a=n(115),r=n(29),i=n(1),o=n.n(i),l=n(35),c=n(249),s=n(31),u=n(103),d=Object(s.o)(s.j);function m(e){var t=Object(i.useState)(!1),n=Object(r.a)(t,2),a=n[0],l=n[1],c=e.data,s=e.plotStyle,u=e.title,m={animation:{damping:9,stiffness:300},data:c,onLeafMouseOver:function(e){return l({hoveredNode:e})},onLeafMouseOut:function(){return l({hoveredNode:!1})},mode:"squarify",getLabel:function(e){return e.name},width:s&&s.width||300,height:s&&s.height||250};return c&&0!==c.length?o.a.createElement("div",{className:"dynamic-treemap-example"},o.a.createElement("h6",null,u),o.a.createElement(d,m),a&&a.value):null}var p=n(17),f=n(37),h=n(127);n.d(t,"a",(function(){return b}));var g=["Vertical Bar","Horizontal Bar","Line","Pop. Pyramid","Treemap"];function y(e,t,n,a,r,i){if(e&&0!==e.length&&Object(f.isString)(t)&&Object(f.isString)(n)){var l=Object(p.t)(e,t);return"Treemap"===n?o.a.createElement(m,{plotStyle:a,data:{title:t+" "+n,color:1,children:l.map((function(t,n){return{name:t.x,size:+t.y/e.length,color:Object(f.isNumber)(t.x)||n,style:{border:"thin solid red"}}}))},title:Object(p.l)(t)}):n.startsWith("Vertical")||n.startsWith("Horizontal")||n.startsWith("Line")?o.a.createElement(h.a,{dark:i,noLimit:r,plotStyle:a,data:l,type:n.startsWith("Vertical")?s.k:n.startsWith("Horizontal")?s.f:s.h,title:Object(p.l)(t),noYAxis:!0}):void 0}}function b(e){var t=Object(i.useState)(!1),n=Object(r.a)(t,2),s=n[0],d=n[1],m=Object(i.useState)(!1),f=Object(r.a)(m,2),h=f[0],b=f[1],v=Object(i.useState)([]),k=Object(r.a)(v,2),O=k[0],E=k[1],j=e.data,S=e.onSelectCallback,w=e.dark,x=e.noAccordion,C=e.plotStyle,_=e.noLimit;if(!j||0===j.length)return null;var N=Object.keys(j[0].properties);return o.a.createElement("div",null,o.a.createElement("h6",null,"Generate graphs from columns"),o.a.createElement("div",{className:"searchField"},o.a.createElement(u.a,{single:!0,title:"Choose column",values:N.map((function(e){return{id:Object(p.l)(e),value:e}})),onSelectCallback:function(e){d(e),"function"===typeof S&&S(e)},value:s}),s.length>0&&o.a.createElement(u.a,{single:!0,title:"Choose vis",values:g.map((function(e){return{id:e,value:e}})),onSelectCallback:function(e){b(e)},value:h})),o.a.createElement(l.Button,{kind:l.KIND.secondary,size:l.SIZE.compact,onClick:function(){0!==s.length&&0!==h.length&&s[0]&&E([].concat(Object(a.a)(O),[y(j,s[0].value,h[0].value,C,_,w)]))}},"Add"),o.a.createElement("div",{className:"visArea"},x?o.a.createElement("center",null,O.map((function(e,t){return e&&o.a.createElement("div",null,o.a.createElement(l.Button,{kind:l.KIND.secondary,size:l.SIZE.compact,onClick:function(){E(O.filter((function(e,n){return t!==n})))}},"X"),e)}))):o.a.createElement(c.Accordion,{expanded:!0,onChange:function(e){var t=e.expanded;return console.log(t)}},O.map((function(e,t){return o.a.createElement(c.Panel,{key:"panel-"+t},o.a.createElement(l.Button,{kind:l.KIND.secondary,size:l.SIZE.compact,onClick:function(){E(O.filter((function(e,n){return t!==n})))}},"X"),e)})))))}},365:function(e){e.exports=JSON.parse('{"marker-1":{"x":0,"y":0,"width":128,"height":128,"anchorY":128},"marker-2":{"x":128,"y":0,"width":128,"height":128,"anchorY":128},"marker-3":{"x":256,"y":0,"width":128,"height":128,"anchorY":128},"marker-4":{"x":384,"y":0,"width":128,"height":128,"anchorY":128},"marker-5":{"x":0,"y":128,"width":128,"height":128,"anchorY":128},"marker-6":{"x":128,"y":128,"width":128,"height":128,"anchorY":128},"marker-7":{"x":256,"y":128,"width":128,"height":128,"anchorY":128},"marker-8":{"x":384,"y":128,"width":128,"height":128,"anchorY":128},"marker-9":{"x":0,"y":256,"width":128,"height":128,"anchorY":128},"marker-10":{"x":128,"y":256,"width":128,"height":128,"anchorY":128},"marker-20":{"x":256,"y":256,"width":128,"height":128,"anchorY":128},"marker-30":{"x":384,"y":256,"width":128,"height":128,"anchorY":128},"marker-40":{"x":0,"y":384,"width":128,"height":128,"anchorY":128},"marker-50":{"x":128,"y":384,"width":128,"height":128,"anchorY":128},"marker-60":{"x":256,"y":384,"width":128,"height":128,"anchorY":128},"marker-70":{"x":384,"y":384,"width":128,"height":128,"anchorY":128},"marker-80":{"x":0,"y":512,"width":128,"height":128,"anchorY":128},"marker-90":{"x":128,"y":512,"width":128,"height":128,"anchorY":128},"marker-100":{"x":256,"y":512,"width":128,"height":128,"anchorY":128},"marker":{"x":384,"y":512,"width":128,"height":128,"anchorY":128}}')},37:function(e,t){var n=function(e){return null!==e&&void 0!==e&&e.constructor===String},a=function(e){return null!==e&&void 0!==e&&e.constructor===Number},r=function(e){return null!==e&&void 0!==e&&e.constructor===Boolean};t.isString=n,t.isNumber=a,t.isBoolean=r,t.isObject=function(e){return null!==e&&void 0!==e&&e.constructor===Object},t.isArray=function(e){return null!==e&&void 0!==e&&e.constructor===Array},t.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.getTime())},t.sanitizeFloat=function(e){if(a(e))return e;if(n(e)){var t=parseFloat(e);return isNaN(t)?null:t}return null},t.sanitizeInt=function(e){return a(e)?e:n(e)?parseInt(e):null},t.sanitizeString=function(e){return n(e)?e:a(e)?e.toString():null},t.sanitizeStringNonNull=function(e){return n(e)?e:a(e)?e.toString():""},t.sanitizeBool=function(e){return r(e)?e:a(e)?Boolean(e):null},t.isEmptyOrSpaces=function(e){return null===e||null!==e.match(/^ *$/)}},413:function(e,t,n){e.exports=n(611)},423:function(e,t){},436:function(e,t,n){},547:function(e,t,n){},588:function(e,t,n){},603:function(e,t,n){e.exports=n.p+"static/media/notes.d652360a.md"},611:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(69),o=n.n(i),l=n(651),c=n(29),s=n(658),u=n(635),d=n(204),m=n(42),p=n(43),f=n(49),h=n(48),g=n(60),y=n(50),b=n(636),v=n(210),k=n(362),O=n.n(k),E=n(363),j=n.n(E),S=n(364),w=n.n(S),x=n(17),C=n(85),_=n.n(C),N=n(632),M=n(653),A=n(633),L=n(617),P=n(400),z=n(621),V=n(246),F=n(35),T=(n(436),n(82)),D=n(245),I=(n(123),C.PRD_URL,n(281)),R=n(295),B=n(208),Y=function(e){return e?a.createElement(B.Card,{headerImage:e.image,title:e.title},a.createElement(B.StyledBody,null,e.body),a.createElement(B.StyledAction,null,a.createElement(F.Button,{onClick:function(){return"function"===typeof e.loadCallback&&e.loadCallback()},overrides:{BaseButton:{style:{width:"100%"}}}},e.button))):null},W=n(515),U=C.PRD_URL,H=function(e){var t=a.useState(!1),n=Object(c.a)(t,2),r=n[0],i=n[1],o=e.urlCallback,l=e.toggleOpen;return a.createElement(a.Fragment,null,a.createElement(F.Button,{kind:F.KIND.secondary,size:F.SIZE.compact,onClick:function(){i((function(e){return!e})),"function"===typeof l&&l()}},"Add data"),a.createElement(T.Modal,{onClose:function(){"function"===typeof l&&l(),i(!1)},isOpen:r},a.createElement(T.ModalHeader,null,"Your data remains on your browser. It is NOT uploaded anywhere."),a.createElement(T.ModalBody,null,a.createElement(T.FocusOnce,null,a.createElement(R.a,{urlCallback:function(e){i(!1),"function"===typeof o&&o(e)}})),a.createElement(I.a,{contentCallback:function(e){var t=e.text,n=e.name;if(n&&(n.split(".")[1].match(/geo/)||n.split(".")[1].match(/json/)))try{var a=JSON.parse(t);"function"===typeof o&&o(null,a,n),i(!1)}catch(r){console.log(r)}else W.csv2geojson(t,(function(e,t){e||"function"===typeof o&&o(null,t,n)}))}}),a.createElement(D.FlexGrid,{flexGridColumnCount:3,flexGridColumnGap:"scale800",flexGridRowGap:"scale800"},function(){var e={REGIONS:{image:"images/spenser.png",body:"England regions",api:U+"/api/covid19r"},WORLD:{image:"images/spenser.png",body:"England regions",api:U+"/api/covid19w"}};return Object.keys(e).map((function(t){return a.createElement(D.FlexGridItem,Object.assign({key:t},K),a.createElement(Y,{button:"Load",title:t,image:e[t].image,body:e[t].body,loadCallback:function(){var n=e[t].api;n&&"function"===typeof n?n((function(e,t){return o(void 0,e,t)})):"function"===typeof o&&o(n),i(!1)}}))}))}())),a.createElement(T.ModalFooter,null,a.createElement(T.ModalButton,{onClick:function(){i(!1),"function"===typeof l&&l()}},"Close"))))},K={display:"flex",alignItems:"center",justifyContent:"center"},G=n(631),X=n(641),Z=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={title:e.hasOwnProperty("title")?e.title:"No Title",menuitems:e.hasOwnProperty("menuitems")?e.menuitems:[]},n._generateMenuItems=n._generateMenuItems.bind(Object(g.a)(n)),n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"_generateMenuItems",value:function(e){var t=e&&"string"!==typeof e[0];return e.map((function(e,n){var a,i;return t&&(a=Object.keys(e)[0],i=Object.values(e)[0]),!t&&""===e||t&&""===a&&""===i?r.a.createElement(G.a,{className:"mi-class",key:n,divider:!0}):r.a.createElement(G.a,{className:"mi-class",key:n,eventKey:e},Object(x.l)(t?i:e))}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.title,a=t.menuitems,i=this.props,o=i.size,l=i.classNames,c=a&&"string"!==typeof a[0];return a&&0!==a.length?r.a.createElement(X.a,{style:{width:"100%"},title:n,className:"object"===typeof l&&l.length>0?l.join(" "):l,id:"string"===typeof o?o:"dropdown-size-medium",onSelect:function(t){e.setState({title:c?Object.values(t)[0]:t}),"function"===typeof e.props.onSelectCallback&&e.props.onSelectCallback(c?Object.values(t)[0]:t)}},this._generateMenuItems(a)):null}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.hasOwnProperty("title")&&e.title!==t.title?{title:e.title}:e.hasOwnProperty("menuitems")&&e.menuitems.length!==t.menuitems.length?{menuitems:e.menuitems}:null}}]),t}(r.a.Component),q=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={bases:["dark","basic","streets","bright","light","satellite","No map"],selected:"dark"},n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.selected,a=t.bases,i=this.props.onSelectCallback;return r.a.createElement(Z,{title:"dark"===n?"Default(dark)":n,menuitems:a,onSelectCallback:function(t){e.setState({selected:t}),"function"===typeof i&&i(t)}})}}]),t}(r.a.Component),J=n(31),$=n(312),Q=n(657),ee=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={timeDuration:!1},n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"componentWillUnmount",value:function(){this.dismissTimeoutId&&clearTimeout(this.dismissTimeoutId)}},{key:"componentWillReceiveProps",value:function(e){var t=this;if(e.alert&&this.props.alert!==e.alert){var n=e.alert.time;this.setState({timeDuration:Boolean(alert)},(function(){t.dismissTimeout=setTimeout((function(){return t.setState({timeDuration:!1})}),n||3e3)}))}}},{key:"render",value:function(){var e=this.props.alert;return this.state.timeDuration&&e&&e.content?r.a.createElement(Q.a,{style:{border:"none",background:"#f8d7da",color:"#721c24",textAlign:"center"},variant:"danger"},e.content):null}}]),t}(a.Component),te=n(71);function ne(e){var t=e.colourCallback;return r.a.createElement("div",{className:"color-picker-container"},r.a.createElement("p",null,"Color range:"),x.a.map((function(e,n){return r.a.createElement("div",{key:e,style:{backgroundColor:0===n?"red":1===n?"blue":2===n?"green":3===n?"orange":4===n?"brown":"yellow"},className:"color-box",onClick:function(){"function"===typeof t&&t(e)}})})))}var ae=function(e){var t=a.useState(!1),n=Object(c.a)(t,2),r=n[0],i=n[1],o=e.toggleOpen,l=e.title,s=e.component,u=e.button;return a.createElement(a.Fragment,null,a.createElement("i",{style:{margin:5,cursor:"pointer",fontSize:"1.5em"},onClick:function(){"function"===typeof o&&o(),i(!0)},className:u||"fa fa-table"}),a.createElement(T.Modal,{size:"80%",onClose:function(){"function"===typeof o&&o(),i(!1)},isOpen:r},a.createElement(T.ModalHeader,null,l),a.createElement(T.ModalBody,null,s),a.createElement(T.ModalFooter,null,a.createElement(F.Button,{kind:F.KIND.secondary,size:F.SIZE.compact,onClick:function(){i(!1),"function"===typeof o&&o()}},"Okay"))))},re=n(335),ie=n(137),oe=n(345),le=n(195),ce=n(618);var se=n(127),ue=n(37),de=n(103),me=n(360);function pe(e){var t=Object(a.useState)(),n=Object(c.a)(t,2),i=n[0],o=n[1];if(!Array.isArray(e.data)||e.data.length>10)return null;var l=e.plotStyle,s=e.title,u=e.noXAxis,d=e.noYAxis,m=e.onValueClick,p=e.data,f=e.legend;return e.data&&e.data.length>1&&r.a.createElement("div",{className:"unselectable",style:{position:"relative",color:"#fff"}},!e.noLimit&&e.data&&e.data.length>10&&r.a.createElement("h4",null,"Plotting first ",10," values:"),d&&s&&r.a.createElement("h4",null,s),r.a.createElement(J.m,{xType:"ordinal",margin:{bottom:l&&l.marginBottom||40},animation:{duration:1},height:l&&l.height||250,width:l&&l.width||250,onMouseLeave:function(){o(!1)}},!u&&r.a.createElement(J.l,{tickSize:0,tickFormat:function(e){return Object(x.q)(e,10)},position:"right",tickLabelAngle:-65,style:{line:{strokeWidth:0},text:{fill:e.dark?"#fff":"#000"}}}),!d&&r.a.createElement(J.n,{tickSize:0,tickLabelAngle:-45,tickFormat:function(e){return Object(ce.a)(".2s")(e)},style:{line:{strokeWidth:0},title:{fill:e.dark?"#fff":"#000"},text:{fill:e.dark?"#fff":"#000"}},position:"start",title:s}),p.map((function(e,t){return r.a.createElement(J.h,{key:"line-"+t,onValueClick:m,onNearestX:function(e,t){var n=t.index;o(p.map((function(e){return e[n]})))},style:{fill:"none"},data:e})})),i&&r.a.createElement(J.a,{values:i,className:"test-class-name"})),r.a.createElement(J.b,{orientation:"horizontal",width:250,items:f}))}var fe=n(383),he=n(647),ge=(n(588),function(e){var t=e.data,n=e.lineAttrs,a=e.plotStyle,i=e.dark;if(!t||!Array.isArray(t)||0===t.length)return null;var o=!0;if(t.forEach((function(e){Object(ue.isNumber)(e)||(o=!1)})),!o)return null;var l=a&&a.height||100,c=t.sort(fe.a);c=c.map((function(e){return Object(x.d)(e,{oldMax:c[c.length-1],oldMin:c[0],newMax:95,newMin:5})}));var s=+Object(he.a)(c,.25).toFixed(2),u=+Object(he.a)(c,.5).toFixed(2),d=+Object(he.a)(c,.75).toFixed(2),m=+(d-s).toFixed(2),p=+(s-1.5*m).toFixed(2),f=+(s+1.5*m).toFixed(2),h=c.filter((function(e){return e>f||e<p})),g=t;return t.length>5&&(g=[],t.forEach((function(e,n){var a=Math.floor(t.length/5);if(1===a&&(a=2),n%a===0){var r=Math.floor(e);r>1e3&&(r=(r/1e3).toFixed(1)+"k"),g.push(r)}}))),r.a.createElement("div",{style:{width:"100%",height:l,position:"relative",display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement("div",{style:{width:"100%",height:"100%",maxWidth:"600px"}},r.a.createElement("svg",{width:"100%",height:"100%"},r.a.createElement("g",{style:{stroke:a&&a.lineColor||"rgb(18, 147, 154)"}},r.a.createElement("line",Object.assign({x1:p+"%",x2:s+"%",y1:"35%",y2:"35%"},n)),r.a.createElement("line",Object.assign({style:{strokeWidth:1},x1:p+"%",x2:p+"%",y1:"5%",y2:"65%"},n)),r.a.createElement("line",Object.assign({x1:f+"%",x2:d+"%",y1:"35%",y2:"35%"},n)),r.a.createElement("line",Object.assign({style:{strokeWidth:1},x1:f+"%",x2:f+"%",y1:"5%",y2:"65%"},n)),r.a.createElement("rect",{x:s+"%",width:m+"%",y:"5%",height:"60%",fill:a&&a.fillColor||"rgb(18, 147, 154)",stroke:(i?"white":"black")+" 0.5px"}),r.a.createElement("line",Object.assign({style:{stroke:i?"white":"black",strokeWidth:1},x1:u+"%",x2:u+"%",y1:"5%",y2:"65%"},n)),h.map((function(e,t){return r.a.createElement("circle",{key:e+"-"+t,r:"5",cx:(e>f?e+2:e-2)+"%",cy:"35%",style:{fill:"none",opacity:1}})})),g&&g.map((function(e,t){var n=t*(100/g.length);return r.a.createElement("g",{key:n+"-"+t},r.a.createElement("text",{fill:i?"white":"black",x:n+2+"%",y:"85%",className:"d3-axis-labels"},e))}))))))}),ye=C.PRD_URL,be=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this,e))).state={radius:100,elevation:4,all_road_types:["Dual carriageway","Single carriageway","Roundabout","Unknown","Slip road","One way street"],year:"",reset:!1,multiVarSelect:{},barChartVariable:"road_type",datasetName:e.datasetName},n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){var n=this.props,a=n.data,r=n.alert,i=n.loading,o=this.state,l=o.elevation,c=o.radius,s=o.reset,u=o.barChartVariable;return s!==t.reset||l!==t.elevation||c!==t.radius||r!==e.alert||i!==e.loading||u!==t.barChartVariable||!(a&&e&&e.data&&a.length===e.data.length)}},{key:"render",value:function(){var e=this,t=this.state,n=t.elevation,a=t.radius,i=t.all_road_types,o=t.year,l=t.subsetBoundsChange,c=t.multiVarSelect,s=t.barChartVariable,u=this.props,d=u.onChangeRadius,m=u.onChangeElevation,p=u.onSelectCallback,f=u.data,h=u.colourCallback,g=(u.layerStyle,u.toggleSubsetBoundsChange),y=u.urlCallback,b=u.alert,v=u.onlocationChange,k=u.column,O=u.dark,E=u.toggleOpen,j=u.toggleHexPlot,S=[],w=[[],[]],_=f&&f.length>1;S=function(e,t,n,a){return e&&Object.keys(t[1].properties).forEach((function(e){if(e.match(/date|datetime|datestamp|timestamp/g)&&"string"===typeof t[1].properties[e]&&t[1].properties[e].split("/")[2]){n=Object(x.t)(t,"date");var r=Object(te.e)(t,"sex_of_casualty",n.map((function(e){return e.x})),"date");n.length>1&&Object.keys(r).forEach((function(e){a[0].push({x:e,y:r[e].Male}),a[1].push({x:e,y:r[e].Female})}))}})),n}(_,f,S,w);var T=Object(te.d)(f,"accident_severity"),D=[],I=_?Object(x.t)(f,k||s):[];_&&f[0].geometry.type.toLowerCase();_&&k&&Object(ue.isNumber)(f[0].properties[k])&&(D=I.map((function(e){return e.x})),D=Object(x.r)(D),this.props.showLegend(Object(x.g)({domain:D,title:Object(x.l)(k)})));var R={data:I,opacity:1,stroke:"rgb(72, 87, 104)",fill:"rgb(18, 147, 154)"},B=function(t){e.setState({reset:!0,year:"",multiVarSelect:{},barChartVariable:"road_type",datasetName:t||e.state.datasetName})};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{color:O?"white":"black",background:O?"#242730":"white"},className:"side-panel"},r.a.createElement(ee,{alert:b}),r.a.createElement("div",{style:{background:O?"#29323C":"#eee"},className:"side-pane-header"},f&&f.length&&f[0].properties.TotalCases?r.a.createElement("h2",null,this.props.TotalCases+" cases"):r.a.createElement("h2",null,f&&f.length?f.length+" row"+(f.length>1?"s":"")+".":"Nothing to show"),"dataset: ",this.props.datasetName),r.a.createElement("div",null,r.a.createElement(H,{toggleOpen:function(){return"function"===typeof E&&E()},urlCallback:function(e,t,n){B(e||n),"function"===typeof y&&y(e,t),"function"===typeof E&&E()}}),r.a.createElement(ae,{toggleOpen:function(){return"function"===typeof E&&E()},component:r.a.createElement(re.a,{data:f})}),this.state.reset&&r.a.createElement(F.Button,{kind:F.KIND.secondary,size:F.SIZE.compact,onClick:function(){B(),"function"===typeof y&&y(ye+"/api/covid19"),"function"===typeof e.props.showLegend&&e.props.showLegend(!1)}},"Reset")),r.a.createElement("div",{className:"side-panel-body"},r.a.createElement("div",{className:"side-panel-body-content"},function(e){var t=e.data,n=e.year,a=e.multiVarSelect,i=e.onSelectCallback,o=e.callback;return t&&t.length>1&&(t[0].properties.date||t[0].properties.YEAR)&&(le.DateTime.fromFormat(t[0].properties.date+"","dd/MM/yyyy").isValid||le.DateTime.fromFormat(t[0].properties.YEAR+"","yyyy").isValid)&&r.a.createElement(oe.a,{title:r.a.createElement("h5",null,"Year(s): ",n||"2009 - 2017",".",n&&r.a.createElement("i",{style:{fontSize:"2rem"},className:"fa fa-trash",onClick:function(){a.date?delete a.date:delete a.YEAR,"function"===typeof i&&i(0===Object.keys(a).length?{what:""}:{what:"multi",selected:a}),o({year:"",multiVarSelect:a})}})),sublist:t[0].properties.date?Array.apply(null,{length:9}).map(Number.call,Number).map((function(e){return e+2009})):Array.apply(null,{length:31}).map(Number.call,Number).map((function(e){return e+2020})),suggested:"slider",onChange:function(e){a[t[0].properties.date?"date":"YEAR"]=new Set([e+""]),o({year:e+"",multiVarSelect:a}),"function"===typeof i&&i({selected:a,what:"multi"})}})}({data:f,year:o,multiVarSelect:c,onSelectCallback:p,callback:function(t){return e.setState(t)}}),f&&f.length>1&&f[0].properties.road_type&&r.a.createElement(de.a,{title:Object(x.l)("road_type"),filter:"road_type",multiVarSelect:c,values:i.map((function(e){return{id:e,value:e}})),onSelectCallback:function(t){p&&p(t),e.setState({multiVarSelect:t.selected||{}})},value:c&&c.road_type&&Array.from(c.road_type).map((function(e){return{id:e,value:e}}))}),r.a.createElement("br",null),T&&T.map((function(t){return Object(x.o)(t.x,100*t.y/f.length,(function(){c&&c.accident_severity&&c.accident_severity.has(t.x)?delete c.accident_severity:(c.accident_severity=new Set([t.x]),e.setState({multiVarSelect:c})),p&&p(0===Object.keys(c).length?{what:""}:{what:"multi",selected:c})}),O)})),r.a.createElement("hr",{style:{clear:"both"}}),D.length>1&&r.a.createElement(ge,{dark:O,data:D}),r.a.createElement(N.a,{defaultActiveKey:"1",id:"main-tabs"},r.a.createElement(M.a,{eventKey:"1",title:r.a.createElement("i",{style:{fontSize:"2rem"},className:"fa fa-info"})},r.a.createElement(me.a,{data:f,dark:O}),_&&f[0].properties.hasOwnProperty(["age_of_casualty"])&&r.a.createElement(se.a,{dark:O,title:"Casualty age",noYAxis:!0,plotStyle:{height:100},noLimit:!0,type:J.h,data:Object(x.t)(f,"age_of_casualty")}),_&&w[0].length>0&&r.a.createElement(pe,{dark:O,data:[].concat(w,[S]),legend:["Male","Female","Total"],title:"Crashes",noYAxis:!0,plotStyle:{height:100,marginBottom:50}}),_&&Object.keys(f[0].properties).filter((function(e){return!Object(ue.isEmptyOrSpaces)(e)})).length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h6",null,"Column for layer:"),r.a.createElement(de.a,{title:"Choose Column",single:!0,values:Object.keys(f[0].properties).map((function(e){return{id:Object(x.l)(e),value:e}})),onSelectCallback:function(t){var n=t&&t[0]?t[0].value:s;e.setState({barChartVariable:n}),"function"===typeof p&&p({what:"column",selected:n})}})),r.a.createElement(se.a,{dark:O,data:R.data,type:J.k,onValueClick:function(t){c[k||s]=new Set([t.x+""]),e.setState({multiVarSelect:c}),p&&p({what:"multi",selected:c})},onDragSelected:function(t){c[k||s]=new Set(t.map((function(e){return e+""}))),e.setState({multiVarSelect:c}),p&&p({what:"multi",selected:c})},plotStyle:{marginBottom:100},noYAxis:!0}),function(e){if(e&&e.data&&e.data[0]&&e.data[0].properties.date&&e.data[0].properties.sex_of_casualty){var t=Object(te.e)(e.data,"sex_of_casualty",["Male","Female"],"date"),n=[],a=[];if(1!==Object.keys(t).length)return t&&Object.keys(t).forEach((function(e,a){n.push({x:0,x0:+t[e].Male,y:0===a?0:a,y0:a+1,color:"#428BCA"})})),t&&Object.keys(t).forEach((function(e,n){a.push({x:0,x0:-1*+t[e].Female,y:0===n?0:n,y0:n+1})})),r.a.createElement(J.m,{margin:{left:e.margin||60},height:e.plotStyle&&e.plotStyle.height||250,width:e.plotStyle&&e.plotStyle.width||250},r.a.createElement(J.g,{color:"rgb(18, 147, 154)",stroke:"black",data:a}),r.a.createElement(J.g,{color:"rgb(239, 93, 40)",stroke:"black",data:n}),r.a.createElement(J.n,{tickSize:0,tickFormat:function(e){return 0===e?2009:e-2+2009},style:{line:{strokeWidth:0},text:{fill:e.dark?"#fff":"#000",fontWeight:400}}}),r.a.createElement(J.l,{tickSize:0,tickFormat:function(e){return Object(ce.a)(".2s")(e<0?-1*e:e)},style:{line:{strokeWidth:0},text:{fill:e.dark?"#fff":"#000",fontWeight:400}}}))}}({data:f,dark:O})),r.a.createElement(M.a,{eventKey:"2",title:r.a.createElement("i",{style:{fontSize:"2rem"},className:"fa fa-sliders"})},_&&r.a.createElement("div",null,r.a.createElement(ne,{colourCallback:function(e){return"function"===typeof h&&h(e)}}),r.a.createElement("input",{type:"range",id:"radius",min:50,max:1e3,step:50,value:a,onChange:function(t){e.setState({radius:t.target.value}),"function"===typeof d&&d(t.target.value)}}),r.a.createElement("h5",null,"Radius: ",a,"."),r.a.createElement("input",{type:"range",id:"elevation",min:2,max:8,step:2,value:n,onChange:function(t){e.setState({elevation:t.target.value}),"function"===typeof m&&m(t.target.value)}}),r.a.createElement("h5",null,"Elevation: ",n,".")),_&&r.a.createElement(r.a.Fragment,null,r.a.createElement("h6",null,"Deck Layer:"),r.a.createElement(de.a,{title:"Choose Layer",single:!0,values:C.LAYERSTYLES.map((function(e){return{id:Object(x.l)(e),value:e}})),onSelectCallback:function(t){var n=t&&t[0]?t[0].value:s;e.setState({barChartVariable:n}),"function"===typeof p&&p({what:"layerStyle",selected:n})}})),"Map Styles",r.a.createElement("br",null),r.a.createElement(q,{onSelectCallback:function(e){return p&&p({selected:e,what:"mapstyle"})}}),r.a.createElement(A.a,{onChange:function(){return j&&j()}},"Hex Plot"),r.a.createElement(A.a,{onChange:function(){e.setState({subsetBoundsChange:!l}),g&&"function"===typeof g&&g(!l)}},"Subset by map boundary")),r.a.createElement(M.a,{eventKey:"3",title:r.a.createElement("i",{style:{fontSize:"2rem"},className:"fa fa-filter"})},f&&f.length>0&&r.a.createElement($.a,{dark:O,multiVarSelect:c,onSelectCallback:function(t){"function"===typeof p&&p(0===Object.keys(t).length?{what:""}:{what:"multi",selected:t}),e.setState({multiVarSelect:t})},data:f})))),r.a.createElement("div",{className:"space"}),r.a.createElement("form",{className:"search-form",onSubmit:function(t){t.preventDefault(),Object(x.p)(e.state.search,(function(e){var t=e&&e.length>0&&e[0].boundingbox;t=t&&t.map((function(e){return+e})),"function"===typeof v&&t&&v({bbox:t,lon:+e[0].lon,lat:+e[0].lat})}))}},r.a.createElement(L.a,null,r.a.createElement(P.a,null,r.a.createElement(z.a,{style:{background:O?"#242730":"white",color:O?"white":"black"},onChange:function(t){return e.setState({search:t.target.value})},placeholder:"fly to...",type:"text"}),r.a.createElement(P.a.Addon,{style:{background:O?"#242730":"white",color:O?"white":"black"}},r.a.createElement(V.a,{glyph:"search"}))))))))}}]),t}(r.a.Component),ve=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={hoveredNode:null,radius:10,offset:0},n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.data,a=t.options,i=this.state,o=i.radius;i.hoveredNode;return n&&n.length?r.a.createElement("div",{className:"centered-and-flexed",style:{color:"#fff"}},r.a.createElement(ie.Slider,{value:[this.state.radius],min:5,max:50,step:5,onChange:function(t){var n=t.value;e.setState({radius:n[0]})}}),"Radius (pixels)",r.a.createElement(J.m,{margin:{left:10,bottom:10},height:a&&a.plotStyle&&a.plotStyle.height||350,width:a&&a.plotStyle&&a.plotStyle.width||350,onMouseLeave:function(){return e.setState({hoveredNode:null})}},r.a.createElement(J.d,{animation:!0,className:"hexbin-example",style:{stroke:"#125C77",strokeLinejoin:"round"},colorRange:["orange","cyan"],radius:o,data:n}),a&&!a.noXAxis&&r.a.createElement(J.l,{tickLabelAngle:-45,style:{text:{fill:"#fff",fontWeight:400}}}),a&&!a.noYAxis&&r.a.createElement(J.n,{tickLabelAngle:-45,style:{text:{fill:"#fff",fontWeight:400}}}))):null}}]),t}(a.Component),ke=function(e){var t=Object(a.useState)(!1===e.isMobile),n=Object(c.a)(t,2),i=n[0],o=n[1];Object(a.useEffect)((function(){!0!==e.open&&o(e.open)}),[e.open]);var l=e.data,s=l&&l.length>1;return s&&"POINT"===l[0].geometry.type.toUpperCase()?r.a.createElement("div",{style:{marginRight:i?0:-350},className:"right-panel-container"},r.a.createElement("div",{className:"close-button",onClick:function(){return o(!i)},style:{color:"white"}},r.a.createElement("i",{style:{marginLeft:-16,bottom:0,position:"absolute",backgroundColor:"#242730",fontSize:"2rem",color:"white !important"},className:i?"fa fa-arrow-circle-right":"fa fa-arrow-circle-left"})),r.a.createElement("div",{className:"right-side-panel"},s&&r.a.createElement(ve,{data:Object(te.a)({features:l}),options:{noXAxis:!0,noYAxis:!0}}))):null},Oe=function(e){var t=Object(a.useState)(!e.isMobile),n=Object(c.a)(t,2),i=n[0],o=n[1],l=Object(a.useState)(!1),s=Object(c.a)(l,2),u=s[0],d=s[1];return r.a.createElement("div",{className:"side-panel-container",style:{marginLeft:i?0:"-320px"}},r.a.createElement(be,Object.assign({},e,{toggleOpen:function(){return o((function(e){return!e}))},toggleHexPlot:function(){return d((function(e){return!e}))}})),u&&r.a.createElement(ke,{open:i,isMobile:e.isMobile,data:e.data}),r.a.createElement("div",{className:"close-button",onClick:function(){return o(!i)},style:{color:"white"}},r.a.createElement("div",{style:{backgroundColor:"#242730"}},r.a.createElement("i",{style:{fontSize:"2rem",color:"white !important"},className:i?"fa fa-arrow-circle-left":"fa fa-arrow-circle-right"}))))},Ee=n(138),je=Object(Ee.a)(),Se=(n(354),n(115)),we=n(196),xe=function(e){function t(e){var n;return Object(m.a)(this,t),(n=Object(f.a)(this,Object(h.a)(t).call(this)))._handleWindowSizeChange=function(){n.forceUpdate()},n.state={isMobile:e.isMobile},n._listPropsAndValues=n._listPropsAndValues.bind(Object(g.a)(n)),n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"componentWillMount",value:function(){window.addEventListener("resize",this._handleWindowSizeChange.bind(this))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._handleWindowSizeChange.bind(this))}},{key:"render",value:function(){var e=this.props,t=e.topx,n=e.topy,a=e.hoveredObject,i=this.state.isMobile;if(!a)return null;var o,l=a.type&&"Feature"===a.type,c=a&&a.cluster,s=[],u=[],d=[],m=[];if(!l&&!c){o=a.points.map((function(e){var t={};return e.properties.hasOwnProperty("accident_severity")&&(t.severity=e.properties.accident_severity),e.properties.hasOwnProperty("date")&&(t.year=e.properties.date.split("/")[2]),t}));var p=new Map;o.forEach((function(e){e.hasOwnProperty("severity")&&(p.get(e.severity)?p.set(e.severity,p.get(e.severity)+1):p.set(e.severity,1)),e.hasOwnProperty("year")&&(p.get(e.year)?p.set(e.year,p.get(e.year)+1):p.set(e.year,1))})),Array.from(p.keys()).forEach((function(e){parseInt(e)?u.push({x:e,y:p.get(e)}):d.push({x:e,y:p.get(e)})})),s=Array.from(new Set(d.map((function(e){return e.x}))));var f=Object(te.e)(a.points,"accident_severity",s,"date");Object.keys(f).forEach((function(e){f[e]&&Object.keys(f[e]).forEach((function(t){var n=s.indexOf(t);m[n]||(m[n]=[]),m[n].push({x:+e,y:f[e][t]})}))}))}var h=window.innerWidth,g=window.innerHeight,y=i?10:n+300>g?n-220:n,b=i?10:t+220>h?t-220:t;return r.a.createElement("div",{className:"xyz",style:{top:n+300>g?y:n,left:t+220>h?b:t}},r.a.createElement("div",null,r.a.createElement("b",null,"Total: ",c?a.point_count:l?1:a.points.length)),r.a.createElement("div",null,!c&&(l||a.points.length<=2)&&this._listPropsAndValues(a),m.length>1?r.a.createElement(pe,{data:[].concat(m,[u]),legend:[].concat(Object(Se.a)(s),["Total"]),title:"Crashes",noYAxis:!0,plotStyle:{height:100,marginBottom:50}}):r.a.createElement(se.a,{title:1===s.length&&s[0],data:u,type:J.h})))}},{key:"_listPropsAndValues",value:function(e){var t=[],n=e.properties;return t=n?Object.keys(n).map((function(e){return[Object(x.l)(e),n[e]]})):Object.keys(e.points[0].properties).map((function(t){var n=[Object(x.l)(t),e.points[0].properties[t]];return e.points[1]&&n.push(e.points[1].properties[t]),n})),r.a.createElement(we.Table,{style:{maxWidth:"320px"},columns:e.points&&2===e.points.length?["Property","Value p1","Value p2"]:["Property","Value"],data:t})}}]),t}(r.a.Component),Ce={version:8,sources:{"simple-tiles":{type:"raster",tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg"],tileSize:256}},layers:[{id:"simple-tiles",type:"raster",source:"simple-tiles"}]},_e=_.a.PRD_URL,Ne="/data/COVID19_NZ.json",Me=Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REACT_APP_MAPBOX_ACCESS_TOKEN,Ae="linear-gradient(to top, red , yellow)",Le={lightsPosition:[-.144528,49.739968,8e3,-3.807751,54.104682,8e3],ambientRatio:.4,diffuseRatio:.6,specularRatio:.2,lightsStrength:[.8,0,.8,0],numberOfLights:2},Pe=function(e){function t(e){var n;Object(m.a)(this,t),n=Object(f.a)(this,Object(h.a)(t).call(this,e));var a={longitude:-1.6362,latitude:53.8321,zoom:5},r=Object(x.k)(e.location.search);return r&&Object.keys(r).forEach((function(e){Object.keys(a).forEach((function(t){t.startsWith(e)&&(a[e]=r[e])}))})),n.state={layerStyle:"heatmap",column:"TotalCases",loading:!0,layers:[],backgroundImage:Ae,radius:100,elevation:4,mapStyle:Me?"mapbox://styles/mapbox/"+(e.dark?"dark":"basic")+"-v9":Ce,initialViewState:a,subsetBoundsChange:!1,lastViewPortChange:new Date,colourName:"default",iconLimit:500,legend:!1},n._generateLayer=n._generateLayer.bind(Object(g.a)(n)),n._renderTooltip=n._renderTooltip.bind(Object(g.a)(n)),n._fetchAndUpdateState=n._fetchAndUpdateState.bind(Object(g.a)(n)),n._fitViewport=n._fitViewport.bind(Object(g.a)(n)),n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this._fetchAndUpdateState()}},{key:"_fetchAndUpdateState",value:function(e,t){var n=this;if((!e||Object(x.n)(e))&&(!t||"object"===typeof t)){var a=e||_e+Ne;Object(x.e)(a,(function(e,r){r?n.setState({loading:!1,alert:{content:"Could not reach: "+a}}):(n.setState({loading:!1,data:e,alert:t||null}),n._fitViewport(e),n._generateLayer())}))}}},{key:"_generateLayer",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.radius,a=t.elevation,r=t.filter,i=t.cn;if(r&&"mapstyle"===r.what)this.setState({mapStyle:Me?r&&"mapstyle"===r.what?"mapbox://styles/mapbox/"+r.selected+"-v9":this.state.mapStyle:Ce});else{var o=this.state.data&&this.state.data.features,l=this.state,c=l.colourName,s=l.iconLimit,u=r&&"column"===r.what&&r.selected||this.state.column;if(o){r&&"%"===r.what&&(o=o.slice(0,r.selected/100*o.length)),this.state.coords&&(o=this.state.filtered);var d=Object(te.f)(o[0]).toLowerCase();r&&""!==r.selected&&(o=o.filter((function(t){if("multi"===r.what)for(var n=r.selected,a=0,i=Object.keys(n);a<i.length;a++){var o=i[a],l="date"===o?t.properties[o].split("/")[2]:t.properties[o]+"";if(!n[o].has(l))return!1}return"coords"!==r.what||0===w.a.difference(r.selected||e.state.coords,t.geometry.coordinates.flat()).length})));var m=r&&"layerStyle"===r.what&&r.selected||this.state.layerStyle||"grid";"point"!==d&&(m="geojson"),o.length<s&&!u&&"point"===d&&(m="icon");var p={radius:n||this.state.radius,cellSize:n||this.state.radius,elevationScale:a||this.state.elevation,lightSettings:Le,colorRange:Object(x.b)(i||c)};"geojson"===m&&(p.getFillColor=function(e){return Object(x.c)(e,o)});var f=r&&"column"===r.what&&r.selected||u||1;if("heatmap"===m&&(p.getPosition=function(e){return e.geometry.coordinates}),"linestring"===d&&(m="line",p.getColor=function(e){return[235,170,20]},p.getPath=function(e){return e.geometry.coordinates},p.onClick=function(t){t&&t.hasOwnProperty("coordinate")&&["path","arc","line"].includes(e.state.layerStyle)&&t.object.geometry.coordinates&&e._generateLayer({filter:{what:"coords",selected:t.object.geometry.coordinates[0]}})},"line"===m&&(p.getSourcePosition=function(e){return e.geometry.coordinates[0]},p.getTargetPosition=function(e){return e.geometry.coordinates[1]}),Object(ue.isNumber)(o[0]&&o[0].properties&&o[0].properties[f]))){var h=o.map((function(e){return e.properties[f]})),g=Object(x.i)(h),y=Object(x.j)(h);p.getWidth=function(e){var t=10,n=.1;return o.length>1e5&&(t=.5,n=.005),Object(x.d)(e.properties[f],{oldMin:y,oldMax:g,newMax:t,newMin:n})}}var b=Object.keys(o&&o[0]&&o[0].properties);if("polygon"===d||"multipolygon"===d){var v=Object(ue.isArray)(b)&&b.length>0&&"GEOGRAPHY_CODE"===b[1];v&&(p.getElevation=function(e){return Object(ue.isNumber)(e.properties[u])&&"YEAR"!==u&&e.properties[u]||null}),p.getFillColor=function(e){return Object(x.c)(e,o,u||(v?1:0))}}"point"===d&&b.includes("TotalCases")&&(p.getPosition=function(e){return e.geometry.coordinates},p.getFillColor=function(e){return Object(x.c)(e,o,1)},p.getRadius=function(e){return 30*+Object.values(e.properties)[2]});var k=Object(x.f)(m,o,this._renderTooltip,p);this.setState({loading:!1,layerStyle:m,geomType:d,tooltip:"",filtered:o,layers:[k],radius:n||this.state.radius,elevation:a||this.state.elevation,road_type:r&&"road_type"===r.what?r.selected:this.state.road_type,colourName:i||c,column:u,coords:r&&"coords"===r.what?r.selected:this.state.coords})}}}},{key:"_fitViewport",value:function(e,t){var n=e||this.state.data;if(n&&0!==n.length){var a=O()(n).geometry.coordinates,r=t?t.bbox:j()(n);this.map.fitBounds(r);var i=Object(d.a)({},this.state.viewport,{longitude:t?t.lon:a[0],latitude:t?t.lat:a[1],transitionDuration:500,transitionInterpolator:new v.a});this.setState({viewport:i})}}},{key:"_renderTooltip",value:function(e){var t=e.x,n=e.y,a=e.object;a?this.setState({tooltip:r.a.createElement(xe,{isMobile:Object(x.m)(),topx:t,topy:n,hoveredObject:a})}):this.setState({tooltip:""})}},{key:"_updateURL",value:function(e){var t=this,n=e.latitude,a=e.longitude,r=e.zoom,i=e.bearing,o=e.pitch,l=e.altitude,c=this.state,s=c.subsetBoundsChange,u=c.lastViewPortChange;new Date-u>1e3&&(je.push("/?lat=".concat(n.toFixed(3))+"&lng=".concat(a.toFixed(3))+"&zoom=".concat(r.toFixed(2))+"&bea=".concat(i)+"&pit=".concat(o)+"&alt=".concat(l)),this.setState({lastViewPortChange:new Date}));var d=this.map&&this.map.getBounds();if(d&&s){var m=Object(x.h)(d),p=m.xmin,f=m.ymin,h=m.xmax,g=m.ymax;Object(x.e)(_e+Ne+p+"/"+f+"/"+h+"/"+g,(function(e,n){n||(t.setState({data:e.features}),t._generateLayer())}))}}},{key:"render",value:function(){var e=this,t=this.state,n=t.tooltip,a=t.viewport,i=t.initialViewState,o=t.loading,l=t.mapStyle,c=t.alert,s=t.layerStyle,u=t.geomType,d=t.legend,m=t.coords;return r.a.createElement("div",{id:"html2pdf"},r.a.createElement("div",{className:"loader",style:{zIndex:o?999:-1,visibility:"string"===typeof l&&l.endsWith("No map-v9")?"hidden":"visible"}}),r.a.createElement(v.c,{ref:function(t){e.map=t&&t.getMap()},mapStyle:l,onViewportChange:function(t){e._updateURL(t),e.setState({viewport:t})},height:window.innerHeight-54+"px",width:window.innerWidth+"px",viewState:a||i},r.a.createElement("div",{className:"mapboxgl-ctrl-top-right",style:{zIndex:9}},r.a.createElement(v.b,Object.assign({},a,{onViewportChange:function(t){return e.setState({viewport:t})}}))),r.a.createElement(b.a,{viewState:a||i,initialViewState:i,layers:this.state.layers,onClick:function(t){!t.layer&&m&&(e.setState({coords:null}),e._generateLayer())}},n)),r.a.createElement(Oe,{dark:this.props.dark,layerStyle:s,isMobile:Object(x.m)(),key:"decksidebar",alert:c,TotalCases:this.state.filtered&&this.state.filtered.map((function(e){return e.properties.TotalCases})).reduce((function(e,t){return e+t})),data:this.state.filtered,colourCallback:function(t){return e._generateLayer({cn:t})},urlCallback:function(t,n){if(e.setState({tooltip:"",road_type:"",radius:100,elevation:4,loading:!0,coords:null,layerStyle:t&&t.endsWith("covid19w")?"heatmap":e.state.layerStyle}),n)try{e.setState({data:n}),e._fitViewport(n),e._generateLayer()}catch(a){e._fetchAndUpdateState(void 0,{content:a.message})}else e._fetchAndUpdateState(t)},column:this.state.column,onSelectCallback:function(t){return e._generateLayer({filter:t})},onChangeRadius:function(t){return e._generateLayer({radius:t})},onChangeElevation:function(t){return e._generateLayer({elevation:t})},toggleSubsetBoundsChange:function(t){e.setState({loading:!0,subsetBoundsChange:t}),e._fetchAndUpdateState()},onlocationChange:function(t){e._fitViewport(t)},showLegend:function(t){return e.setState({legend:t})},datasetName:Ne}),d&&("polygon"===u||"multipolygon"===u)&&r.a.createElement("div",{className:"right-side-panel mapbox-legend"},d))}}]),t}(r.a.Component),ze=n(640),Ve=n(385),Fe=n(384),Te=n(634),De=n(659),Ie=[{key:1,to:"fui",title:"DUI"},{key:2,to:"about",title:"About"}];var Re=Object(De.a)((function(e){var t=Object(a.useState)(e.dark),n=Object(c.a)(t,2),i=n[0],o=n[1];return r.a.createElement(ze.a,{inverse:i,collapseOnSelect:!0},r.a.createElement(ze.a.Header,null,r.a.createElement(ze.a.Brand,null,r.a.createElement(Te.a,{to:"/"},r.a.createElement("span",{style:{color:i?"white":"black"}},"COVID19"))),r.a.createElement(ze.a.Toggle,null)),r.a.createElement(ze.a.Collapse,null,r.a.createElement(Ve.a,null,Ie.map((function(t,n){return r.a.createElement(Fe.a,{key:n,eventKey:t.key,onClick:function(){return e.history.push(t.to)}},t.title)}))),r.a.createElement(Ve.a,{pullRight:!0},r.a.createElement(Fe.a,{href:"https://github.com/layik/eAtlas"},r.a.createElement("i",{style:{fontSize:"1.5em"},className:"fa fa-github"}))),r.a.createElement(Ve.a,{pullRight:!0},r.a.createElement(Fe.a,{onClick:function(){"function"===typeof e.toggleTheme&&e.toggleTheme(),o(!i)}},r.a.createElement("svg",{width:"24",height:"24",viewBox:"0 0 24 24","aria-hidden":"true"},r.a.createElement("g",{transform:"matrix( 1 0 0 1 4 1 )"},r.a.createElement("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.3999 11C15.7999 10.1 16 9 16 8C16 3.6 12.4 0 8 0C3.6 0 0 3.6 0 8C0 9.1 0.200098 10.1 0.600098 11L2.19995 15L13.8 15L15.3999 11ZM11 22L12.6001 18L3.3999 18L5 22L11 22Z",fill:i?"#fff":"#000",opacity:"1"})))))))})),Be=n(388),Ye=n.n(Be),We=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={markdown:null},n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=n(603);fetch(t).then((function(e){return e.text()})).then((function(t){e.setState({markdown:Ye()(t)})}))}},{key:"render",value:function(){var e=this.state.markdown;return r.a.createElement("section",{style:{background:"white",padding:"5%"}},r.a.createElement("article",{dangerouslySetInnerHTML:{__html:e}}))}}]),t}(a.Component),Ue=function(e){function t(){var e,n;Object(m.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(f.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).state={component:null},n}return Object(y.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.load().then((function(t){e.setState((function(){return{component:t.default?t.default:t}}))}))}},{key:"render",value:function(){return this.props.children(this.state.component)}}]),t}(a.Component),He=n(239),Ke=n(209),Ge=n(391),Xe=(n(606),new Ge.a),Ze=function(e){return r.a.createElement(Ue,{load:function(){return n.e(3).then(n.bind(null,660))}},(function(t){return null===t?r.a.createElement("div",{className:"loader",style:{zIndex:999}}):r.a.createElement(t,e)}))};var qe=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],i=t[1];return r.a.createElement("main",null,r.a.createElement(Re,{dark:n,toggleTheme:function(){return i(!n)}}),r.a.createElement(He.Provider,{value:Xe},r.a.createElement(Ke.BaseProvider,{theme:n?Ke.DarkTheme:Ke.LightTheme},r.a.createElement(s.a,null,r.a.createElement(u.a,{exact:!0,path:"/",component:function(e){return r.a.createElement(Pe,Object.assign({},e,{dark:n}))}}),r.a.createElement(u.a,{exact:!0,path:"/fui",component:function(e){return r.a.createElement(Ze,Object.assign({},e,{dark:n}))}}),r.a.createElement(u.a,{exact:!0,path:"/about",component:We})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Je=n(253),$e=n.n(Je);delete $e.a.Icon.Default.prototype._getIconUrl,$e.a.Icon.Default.mergeOptions({iconRetinaUrl:n(608),iconUrl:n(609),shadowUrl:n(610)}),o.a.render(r.a.createElement(l.a,null,r.a.createElement(qe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},71:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return d})),n.d(t,"f",(function(){return i}));var a=n(37),r=n(195).DateTime,i=function(e){return"FeatureCollection"===e.type?"FeatureCollection":"GeometryCollection"===e.type?"GeometryCollection":"Feature"===e.type&&null!==e.geometry?e.geometry.type:e.type},o=function(e){if(!e||!e.features)return null;var t=[],n=c(e);return Object.keys(n).forEach((function(a){Array.from(n[a]).length===e.features.length&&t.push(a)})),t.length>0?t:null},l=function(e){if(!e||"Feature"!==e.type)return null;var t={};return Object.keys(e.properties).forEach((function(n){var i=String,o=e.properties[n];Object(a.isDate)(o)||r.fromFormat(o+"","MMMM dd yyyy").isValid||r.fromFormat(o+"","MMMM d yyyy").isValid||r.fromFormat(o+"","MMM d yyyy").isValid||r.fromFormat(o+"","MMM dd yyyy").isValid||r.fromFormat(o+"","dd/MM/yyyy").isValid||r.fromISO(o).isValid||r.fromHTTP(o).isValid||typeof o===Number&&r.fromMillis(o).isValid?i=Date:Object(a.isNumber)(o)?i=Number:Object(a.isBoolean)(o)?i=Boolean:Object(a.isObject)(o)&&(i=Object),t[n]=i})),t},c=function(e,t){if(!e||!e.features)return null;var n={},a=new Set;return e.features.forEach((function(e){Object.keys(e.properties).forEach((function(r){t&&t===r?a.add(e.properties[r]):("object"===typeof n[r]||(n[r]=new Set),n[r].add(e.properties[r]))}))})),t?Array.from(a):n},s=function(e,t,n){if(e&&t){var a=[],r=n;return n&&0!==n.length||(r=c({features:e},t)),e.forEach((function(e){Object.keys(e.properties).forEach((function(n){if(n===t){var i=r.indexOf(e.properties[n]);a[i]&&a[i].x===e.properties[n]?a[i].y+=1:a[i]={x:e.properties[n],y:1}}}))})),a}},u=function(e,t,n,a){if(e&&t&&n&&a&&t!==a){var i={};return e.forEach((function(e){var n="date"===a&&r.fromFormat(e.properties[a]+"","dd/MM/yyyy").isValid?e.properties[a].split("/")[2]:e.properties[a];Object.keys(e.properties).forEach((function(a){a===t&&(i[n]&&i[n][e.properties[a]]?i[n][e.properties[a]]+=1:i[n]=Object.assign(i[n]||{},{[e.properties[a]]:1}))}))})),i}},d=function(e,t){return e.features?e.features.map((function(e){var n={x:e.geometry.coordinates[0],y:e.geometry.coordinates[1]};return t&&e.properties[t]&&(n.size=e.properties[t]),n})):null}},85:function(e,t){function n(e,n){Object.defineProperty(t,e,{value:n,enumerable:!0})}n("PRD_URL","https://uoa-eresearch.github.io/eAtlas"),n("DEV_URL",""),n("UI_LIST",["checkbox","radio","buttongroups","dropdown","slider"]),n("LAYERSTYLES",["arc","geojson","grid","heatmap","hex","icon","line","path","scatterplot","sgrid"])}},[[413,1,2]]]);
//# sourceMappingURL=main.9abf787a.chunk.js.map