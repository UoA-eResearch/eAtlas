{"version":3,"sources":["components/MultiSelect.jsx","components/Showcases/SeriesPlot.jsx","icon-cluster-layer.js","utils.js","components/File.jsx","components/URL.jsx","components/Variables.jsx","components/Table.jsx","components/UI.js","components/TreeMap.jsx","components/AddVIS.jsx","JSUtils.js","notes.md","components/Showcases/util_quant.js","components/Card.jsx","components/DataInput.jsx","components/RBDropdownComponent.jsx","components/MapboxBaseLayers.jsx","components/RBAlert.jsx","components/ColourPicker.jsx","components/Modal.jsx","components/Showcases/MultiLinePlot.jsx","components/Boxplot/Boxplot.jsx","components/DeckSidebar/DeckSidebar.jsx","components/Showcases/Plots.jsx","components/Showcases/Widgets.jsx","components/Showcases/HexbinSeries.jsx","components/DeckSidebar/HexPlot.jsx","components/DeckSidebar/DeckSidebarContainer.jsx","history.js","components/Tooltip.jsx","Welcome.js","components/Header.jsx","About.js","components/DynamicImport.jsx","App.js","registerServiceWorker.js","index.js","geojsonutils.js","Constants.js"],"names":["props","useState","value","setValue","onSelectCallback","values","filter","multiVarSelect","title","single","options","labelKey","valueKey","placeholder","maxDropdownHeight","type","TYPE","search","multi","onChange","Object","keys","length","Set","map","e","what","selected","FlexibleXYPlot","makeWidthFlexible","XYPlot","SeriesPlot","hint","setHint","x","setX","y","setY","x1","setX1","y1","setY1","rect","setRect","setSelected","ReactSeries","data","MarkSeries","noLimit","slice","dataWithColor","d","i","color","Number","includes","plotStyle","noXAxis","noYAxis","onValueClick","onDragSelected","className","style","position","onMouseDown","clientX","clientY","onMouseMove","newX","newY","left","top","width","Math","abs","height","backgroundColor","opacity","onMouseUp","onMouseOut","xType","margin","bottom","marginBottom","animation","duration","onMouseLeave","tickSize","tickFormat","v","shortenName","tickValues","item","idx","floor","tickLabelAngle","line","strokeWidth","text","fill","dark","format","onNearestX","datapoint","index","innerX","isWithinRect","colorDomain","colorRange","IconClusterLayer","changeFlags","somethingChanged","oldProps","rebuildIndex","dataChanged","sizeScale","Supercluster","maxZoom","radius","load","geometry","coordinates","getPosition","properties","this","setState","z","context","viewport","zoom","state","getClusters","info","mode","pickedObject","object","cluster","objects","getLeaves","cluster_id","f","iconAtlas","iconMapping","IconLayer","getSubLayerProps","id","getIcon","size","point_count","getSize","min","CompositeLayer","fetchData","url","callback","fetch","then","response","json","JSON","parse","error","undefined","catch","console","xyObjectByProperty","property","noNulls","Map","forEach","feature","split","get","set","sortedMap","Array","from","sort","key","generateDeckLayer","name","renderTooltip","addOptionsToObject","opt","obj","hexObj","pickable","extruded","elevationScale","onHover","HexagonLayer","scatterObj","radiusScale","radiusMinPixels","radiusMaxPixels","getRadius","sqrt","exits","getColor","ScatterplotLayer","geojsonObj","stroked","filled","lineWidthScale","lineWidthMinPixels","getFillColor","getLineColor","getLineWidth","getElevation","GeoJsonLayer","iconObj","mapping","wrapLongitude","sgridObject","cellSizePixels","ScreenGridLayer","gridObject","cellSize","GridLayer","lineObject","LineLayer","arcObject","ArcLayer","pathObject","PathLayer","heatObject","HeatmapLayer","scatterObject","textObject","TextLayer","convertRange","oldValue","oldMax","oldMin","newMax","newMin","toFixed","getParamsFromSearch","qsResult","qs","replace","lat","lng","latitude","isNaN","longitude","pit","bea","alt","getBbx","bounds","xmin","_sw","xmax","_ne","ymin","ymax","suggestUIforNumber","number","UI_LIST","Constants","humanize","str","frags","charAt","toUpperCase","join","n","isNumber","parseFloat","toString","isString","shortened","trim","extension","pop","substring","percentDiv","cb","onClick","cursor","textAlign","float","border","background","isURL","a","document","createElement","href","host","window","location","isMobile","check","innerWidth","navigator","userAgent","vendor","opera","test","substr","colorScale","features","p","alpha","domainIsNumeric","domain","b","indexOf","col","interpolateOrRd","colorRangeNames","colorRanges","yellowblue","greens","oranges","diverge","inverseDefault","default","searchNominatom","generateLegend","interpolate","isArray","jMax","jMin","legend","push","sortNumericArray","array","getMax","arr","reduce","max","Infinity","getMin","Uploader","progressAmount","handleDrop","acceptedFiles","rejectedFiles","contentCallback","file","match","reader","FileReader","onload","reset","result","readAsText","log","startProgress","intervalId","setInterval","clearInterval","onCancel","onDrop","progressMessage","React","URL","urlCallback","setUrl","onKeyPress","event","which","preventDefault","target","Addon","glyph","Variables","list","showAll","_geoJSONPropsOrValues","bind","_showSelectedVars","_generateList","_processData","_multiSelect","_showTopn","_shorten","_button","prevProps","prevState","subStyle","propertyValuesCallback","description","describeFeatureVariables","getKeyColumns","all","limit","sublist","each","hasOwnProperty","add","shownSublist","ret","delete","borderRadius","has","isEmptyOrSpaces","SIZE","compact","kind","KIND","secondary","Component","DataTable","currentPage","setCurrentPage","numPages","columns","rows","onPageChange","nextPage","UI","checks","suggested","steps","new_checks","ui_name","ui_returned","checked","parseInt","s","step","initialState","FlexibleTreemap","Treemap","TreeMap","hoveredNode","setHoveredNode","treeProps","damping","stiffness","onLeafMouseOver","onLeafMouseOut","getLabel","H","VIS","generateVIS","column","vis","counts","children","startsWith","VerticalBarSeries","HorizontalBarSeries","LineSeries","AddVIS","setColumn","setVis","setList","noAccordion","MultiSelect","plot","j","expanded","constructor","String","isBoolean","Boolean","exports","isObject","isDate","prototype","call","getTime","sanitizeFloat","sanitizeInt","sanitizeString","string","sanitizeStringNonNull","sanitizeBool","bool","module","PRD_URL","headerImage","image","body","loadCallback","overrides","BaseButton","button","csv2geojson","require","partURL","isOpen","setOpen","toggleOpen","onClose","File","err","flexGridColumnCount","flexGridColumnGap","flexGridRowGap","REGIONS","api","WORLD","itemProps","Card","geojson","apiURL","cards","display","alignItems","justifyContent","RBDropDown","menuitems","_generateMenuItems","entry","MenuItem","divider","eventKey","classNames","keyIsArray","DropdownButton","onSelect","MapboxBaseLayers","bases","ToastAlert","timeDuration","dismissTimeoutId","clearTimeout","nextProps","alert","time","dismissTimeout","setTimeout","content","Alert","variant","ColorPicker","colourCallback","open","component","fontSize","MultiLinePlot","_","orientation","items","lineAttrs","isNumeric","data_sorted","ascending","W","q1","quantile","median","q3","interQuantileRange","outliers","scale","l","maxWidth","stroke","lineColor","x2","yMiddle","y2","Y","yHeight","fillColor","r","cx","cy","DeckSidebar","elevation","all_road_types","year","barChartVariable","datasetName","nextState","loading","subsetBoundsChange","onChangeRadius","onChangeElevation","toggleSubsetBoundsChange","layerStyle","onlocationChange","toggleHexPlot","plot_data","plot_data_multi","notEmpty","mf","propertyCountByProperty","k","Male","Female","crashes_plot_data","severity_data","propertyCount","columnDomain","columnData","toLowerCase","showLegend","columnPlot","resetState","urlOrName","RBAlert","TotalCases","DataInput","Modal","date","DateTime","fromFormat","isValid","YEAR","apply","yearSlider","changes","clear","Boxplot","Tabs","defaultActiveKey","Tab","newBarChartVar","datapoints","sex_of_casualty","mf_array_male","mf_array_female","x0","y0","fontWeight","popPyramid","LAYERSTYLES","Checkbox","mvs","onSubmit","bbox","boundingbox","num","lon","FormGroup","InputGroup","FormControl","Glyphicon","HexHeatmap","offset","strokeLinejoin","useEffect","marginRight","marginLeft","coordsAsXY","hex","setHex","o","h","HexPlot","createBrowserHistory","Tooltip","_handleWindowSizeChange","forceUpdate","_listPropsAndValues","addEventListener","removeEventListener","topx","topy","hoveredObject","type_feature","severity_keys","crashes_data","severity_data_separate","points","aKey","severity","accident_severity","element","severity_by_year","kk","w","innerHeight","n_topy","n_left","DATA","osmtiles","defualtURL","MAPBOX_ACCESS_TOKEN","process","REACT_APP_MAPBOX_ACCESS_TOKEN","gradient","LIGHT_SETTINGS","lightsPosition","ambientRatio","diffuseRatio","specularRatio","lightsStrength","numberOfLights","Welcome","init","param","iKey","layers","backgroundImage","mapStyle","initialViewState","lastViewPortChange","Date","colourName","iconLimit","_generateLayer","_renderTooltip","_fetchAndUpdateState","_fitViewport","aURL","customError","fullURL","cn","coords","filtered","geomType","sfType","nextValue","difference","flat","lightSettings","columnNameOrIndex","getPath","getSourcePosition","getTargetPosition","colArray","getWidth","cols","SPENSER","alayer","tooltip","road_type","newData","bboxLonLat","center","centroid","fitBounds","transitionDuration","transitionInterpolator","FlyToInterpolator","bearing","pitch","altitude","history","getBounds","box","zIndex","visibility","endsWith","ref","getMap","onViewportChange","_updateURL","viewState","layer","DeckSidebarContainer","t","url_returned","geojson_returned","message","navs","to","withRouter","setDark","Navbar","inverse","collapseOnSelect","Header","Brand","Link","Toggle","Collapse","Nav","NavItem","pullRight","toggleTheme","viewBox","aria-hidden","transform","fill-rule","clip-rule","About","markdown","readmePath","marked","padding","dangerouslySetInnerHTML","__html","DynamicImport","engine","Styletron","DUI","App","theme","DarkTheme","LightTheme","Switch","Route","exact","path","hostname","L","Icon","Default","_getIconUrl","mergeOptions","iconRetinaUrl","iconUrl","shadowUrl","ReactDOM","render","BrowserRouter","basename","getElementById","serviceWorker","ready","registration","unregister","all_property_counts","getPropertyValues","v_type","fromISO","fromHTTP","fromMillis","sub_data","list_copy","key2","k2","assign","sizeProperty","define","defineProperty","enumerable"],"mappings":"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","file":"static/js/main.5d4443e1.chunk.js","sourcesContent":["import React, { useState } from 'react';\nimport { Select, TYPE } from 'baseui/select';\n\nexport default (props) => {\n  const [value, setValue] = useState([]);\n  const { onSelectCallback, values, filter, multiVarSelect,\n    title, single } = props;  \n  return (\n    <Select\n      options={values}\n      labelKey=\"id\"\n      valueKey=\"value\"\n      placeholder={title || \"Choose\"}\n      maxDropdownHeight=\"300px\"\n      type={TYPE.search}\n      multi={!single}\n      onChange={({ value }) => {\n        setValue(value);\n        if (multiVarSelect) {\n          Object.keys(value).length === 0 ? delete multiVarSelect[filter] :\n            // everytime it gives back the chosen list of objects\n            multiVarSelect[filter] = new Set(value.map(e => e.value));\n          typeof onSelectCallback === 'function' &&\n            onSelectCallback(Object.keys(multiVarSelect).length === 0 ?\n              { what: '' } : { what: 'multi', selected: multiVarSelect });\n        } else {\n          typeof onSelectCallback === 'function' &&\n          onSelectCallback(value)\n        }\n      }}\n      value={props.value || value}\n    />\n  );\n};","import React, { useState } from 'react';\nimport {\n  makeWidthFlexible,\n  XYPlot, XAxis, YAxis, MarkSeries,\n  Hint\n} from 'react-vis';\nimport { format } from 'd3-format';\n\nimport { shortenName } from '../../utils';\n\nconst W = 250;\nconst FlexibleXYPlot = makeWidthFlexible(XYPlot);\n\nexport default function SeriesPlot(options) {\n  const [hint, setHint] = useState();\n  const [x, setX] = useState(null);\n  const [y, setY] = useState(null);\n  const [x1, setX1] = useState(null);\n  const [y1, setY1] = useState(null);\n  const [rect, setRect] = useState(null);\n  const [selected, setSelected] = useState([]);\n\n  const ReactSeries = options.type;\n  if (!ReactSeries) return null;\n  const limit = 10;\n\n  const data = options.type !== MarkSeries && !options.noLimit &&\n    options.data.length > limit ? options.data.slice(0, limit)\n    : options.data;\n  const dataWithColor = data.map((d, i) => ({\n    ...d,\n    // if selected return 0 which is:\n    // ['rgb(239, 93, 40)', 'rgb(18, 147, 154)']\n    color: data.length === selected.length ? 0 : Number(!selected.includes(i))\n  }));\n\n  const { plotStyle, title, noXAxis, noYAxis,\n    onValueClick, onDragSelected } = options;\n      \n  return data && data.length > 1 &&\n    // https://github.com/uber/react-vis/issues/584#issuecomment-401693372\n    <div className=\"unselectable\"\n      style={{ position: 'relative' }}\n      onMouseDown={(e) => {\n        if (!x && !y) {\n          setX(e.clientX); setY(e.clientY)\n        }\n      }}\n      onMouseMove={(e) => {\n        if (x && y) {\n          const newX = e.clientX; const newY = e.clientY;\n          setX1(newX); setY1(newY);\n          setRect(\n            <div style={{\n              position: 'fixed',\n              left: x > newX ? newX : x, top: y > y1 ? newY : y,\n              width: Math.abs(newX - x), height: Math.abs(newY - y),\n              backgroundColor: 'gray', opacity: 0.2\n            }} />\n          )\n        }\n      }}\n      onMouseUp={(e) => {\n        setX(null); setY(null); setX1(null); setY1(null);\n        setRect(null);\n        if(rect) {\n          typeof(onDragSelected) === 'function' && \n          onDragSelected(selected.map(e => \n            dataWithColor[e] && dataWithColor[e].x))\n        }\n        setSelected([])\n      }}\n      onMouseOut={() => {\n        if(!rect) {\n          setSelected([])\n        }\n      }}\n    >\n      {options.type !== MarkSeries && !options.noLimit &&\n        options.data && options.data.length > limit &&\n        <h4>Plotting first {limit} values:</h4>}\n      {noYAxis && title &&\n        <h4>{title}</h4>\n      }\n      <FlexibleXYPlot xType=\"ordinal\"\n        margin={{ bottom: (plotStyle && plotStyle.marginBottom) || 40 }} // default is 40\n        animation={{ duration: 1 }}\n        height={(plotStyle && plotStyle.height) || W}\n        width={(plotStyle && plotStyle.width) || W}\n        onMouseLeave={() => { setHint(false) }}\n      >\n        {!noXAxis && // if provided dont\n          <XAxis\n            tickSize={0}\n            tickFormat={v => shortenName(v, 10)}\n            tickValues={\n              (data.length > limit)\n                ? data\n                  .filter((item, idx) => {\n                    if ((idx % Math.floor(data.length / limit)) === 0) {\n                      return item.x\n                    }\n                  }).map(item => (item.x))\n                : data.map(item => (item.x))\n            }\n            position=\"right\" tickLabelAngle={-65} style={{\n              line: { strokeWidth: 0 },\n              text: { fill: options.dark ? '#fff' : '#000' } //, fontWeight: plotStyle && plotStyle.fontWeight || 400 }\n            }} />}\n        {!noYAxis && // if provided dont\n          <YAxis\n            tickSize={0}\n            tickLabelAngle={-45} tickFormat={v => format(\".2s\")(v)} style={{\n              line: { strokeWidth: 0 },\n              title: { fill: options.dark ? '#fff' : '#000' },\n              text: { fill: options.dark ? '#fff' : '#000' } //, fontWeight: plotStyle && plotStyle.fontWeight || 400 }\n            }} position=\"start\" title={title} />\n        }\n        <ReactSeries\n          onValueClick={onValueClick}\n          // see abstract-series.js\n          /*\n          onNearestX(value, {\n            innerX: xScaleFn(value),\n            index: valueIndex,\n            event: event.nativeEvent\n          });\n          */\n          onNearestX={(datapoint, { index, innerX }) => {\n            setHint({ x: datapoint.x, y: datapoint.y });\n            if (rect && isWithinRect({ x, x1, value: innerX })) {\n              if (!selected.includes(index)) { // prevent rerender\n                setSelected([...selected, index]);\n              }\n              // TODO see how one can detect \"leaving\"\n              // outside the box but rect is dragging\n              // console.log(\"DEselect \", index);\n              // setSelected(selected.filter(e => e !== index));\n            } else {\n              if (!rect) {              \n                setSelected([index]); // single hover\n              }\n            }\n          }}\n          colorDomain={[0, 1]}\n          colorRange={['rgb(239, 93, 40)', 'rgb(18, 147, 154)']}\n          // style={{ fill: type === LineSeries ? 'none' : 'rgb(18, 147, 154)' }}\n          data={dataWithColor} />\n        {hint && <Hint value={hint} />}\n      </FlexibleXYPlot>\n      {x && x1 && rect}\n    </div>;\n}\n\nfunction isWithinRect(options) {\n  const { x, x1, value } = options;\n  if (x1 > x) {\n    if (value > x && value < x1) {\n      return true\n    }\n    return false\n  } else {\n    if (value < x && value < x1) {\n      return true\n    }\n    return false\n  }\n}","import {CompositeLayer} from '@deck.gl/core';\nimport {IconLayer} from '@deck.gl/layers';\nimport Supercluster from 'supercluster';\n\nfunction getIconName(size) {\n  if (size === 0) {\n    return '';\n  }\n  if (size < 10) {\n    return `marker-${size}`;\n  }\n  if (size < 100) {\n    return `marker-${Math.floor(size / 10)}0`;\n  }\n  return 'marker-100';\n}\n\nfunction getIconSize(size) {\n  return Math.min(100, size) / 100 + 1;\n}\n\nexport default class IconClusterLayer extends CompositeLayer {\n  shouldUpdateState({changeFlags}) {\n    return changeFlags.somethingChanged;\n  }\n\n  updateState({props, oldProps, changeFlags}) {\n    const rebuildIndex = changeFlags.dataChanged || props.sizeScale !== oldProps.sizeScale;\n\n    if (rebuildIndex) {\n      const index = new Supercluster({maxZoom: 16, radius: props.sizeScale});\n      index.load(\n        props.data.map(d => ({\n          geometry: {coordinates: props.getPosition(d)},\n          properties: d\n        }))\n      );\n      this.setState({index});\n    }\n\n    const z = Math.floor(this.context.viewport.zoom);\n    if (rebuildIndex || z !== this.state.z) {\n      this.setState({\n        data: this.state.index.getClusters([-180, -85, 180, 85], z),\n        z\n      });\n    }\n  }\n\n  getPickingInfo({info, mode}) {\n    const pickedObject = info.object && info.object.properties;\n    if (pickedObject) {\n      if (pickedObject.cluster && mode !== 'hover') {\n        info.objects = this.state.index\n          .getLeaves(pickedObject.cluster_id, 25)\n          .map(f => f.properties);\n      }\n      info.object = pickedObject;\n    }\n    return info;\n  }\n\n  renderLayers() {\n    const {data} = this.state;\n    const {iconAtlas, iconMapping, sizeScale} = this.props;\n\n    return new IconLayer(\n      this.getSubLayerProps({\n        id: 'icon',\n        data,\n        iconAtlas,\n        iconMapping,\n        sizeScale,\n        getPosition: d => d.geometry.coordinates,\n        getIcon: d => getIconName(d.properties.cluster ? d.properties.point_count : 1),\n        getSize: d => getIconSize(d.properties.cluster ? d.properties.point_count : 1)\n      })\n    );\n  }\n}\n","import React from 'react';\nimport {\n  ScatterplotLayer, HexagonLayer, GeoJsonLayer,\n  ScreenGridLayer, GridLayer, LineLayer,\n  HeatmapLayer,\n  TextLayer\n} from 'deck.gl';\nimport {\n  interpolateOrRd, // schemeBlues\n} from 'd3-scale-chromatic';\n\nimport qs from 'qs'; // warning: importing it otherways would cause minificatino issue.\n\nimport mapping from './location-icon-mapping.json';\nimport Constants from './Constants';\nimport { isString, isNumber } from './JSUtils.js';\nimport IconClusterLayer from './icon-cluster-layer';\nimport { ArcLayer, PathLayer } from '@deck.gl/layers';\n\nconst getResultsFromGoogleMaps = (string, callback) => {\n\n  if (typeof (string) === 'string' && typeof (callback) === 'function') {\n    let fullURL = \"https://maps.googleapis.com/maps/api/geocode/json?address=\" +\n      string\n      + \"&key=WRONG_KEY\";\n    // console.log(fullURL);\n    fetch(fullURL)\n      .then((response) => {\n        if (response.status !== 200) {\n          console.log('Looks like there was a problem. Status Code: ' +\n            response.status);\n          return;\n        }\n        // Examine the text in the response\n        response.json()\n          .then((data) => {\n            //rouch search results will do.\n            if (data.results.length === 0 || response.status === 'ZERO_RESULTS') {\n              callback(response.status);\n            } else {\n              callback(data.results[0].geometry.location)\n            }\n          });\n      })\n      .catch((err) => {\n        console.log('Fetch Error :-S', err);\n      });\n\n  }\n  //ignore\n};\n\nconst fetchData = (url, callback) => {\n  fetch(url) // [0] => \"\", [1] => roads and [2] => qfactor\n    .then((response) => response.text())\n    .then((response) => {\n      try {\n        const json = JSON.parse(response);\n        // console.log(json);\n        callback(json)\n      } catch (error) {\n        callback(undefined, error)\n      }\n    })\n    .catch((error) => {\n      console.error(error);\n      callback(null, error)\n    });\n\n}\n\n/**\n * Function to count frequency of values of `property` given.\n * \n * TODO: Double check to see if it is slightly different\n * version of propertyCount\n * \n * \n * @param {Object} data \n * @param {String} property \n * @param {Boolean} noNulls \n */\nconst xyObjectByProperty = (data, property, noNulls = true) => {\n  if (!data || !property) return;\n  //data = [{...data = 12/12/12}]       \n  const map = new Map()\n  data.forEach(feature => {\n    let value = feature.properties[property];\n    if (typeof (value) === 'string' && value.split(\"/\")[2]) {\n      value = value.split(\"/\")[2]\n    }\n    if (noNulls && value !== null) { // remove nulls here\n      if (map.get(value)) {\n        map.set(value, map.get(value) + 1)\n      } else {\n        map.set(typeof value === 'number' ? +(value) : value, 1)\n      }\n    }\n  });\n  const sortedMap = typeof Array.from(map.keys())[0] === 'number' ?\n    Array.from(map.keys()).sort() : Array.from(map.keys())\n\n  return sortedMap.map(key => {\n    return (\n      {\n        x: key,\n        y: +(map.get(key))\n      }\n    )\n  })\n}\n\nconst generateDeckLayer = (name, data, renderTooltip, options) => {\n  const addOptionsToObject = (opt, obj) => {\n    Object.keys(opt).forEach(key =>\n      obj[key] = opt[key]\n    )\n  }\n  if (name === 'hex') {\n    const hexObj = {\n      id: 'hexagon-layer',\n      data: data,\n      pickable: true,\n      extruded: true,\n      radius: 100,\n      elevationScale: 1,\n      getPosition: d => d.geometry.coordinates,\n      onHover: renderTooltip\n    }\n    addOptionsToObject(options, hexObj)\n    return (new HexagonLayer(hexObj))\n  } else if (name === 'scatterplot') {\n    const scatterObj = {\n      id: 'scatterplot-layer',\n      data,\n      pickable: true,\n      opacity: 0.8,\n      radiusScale: 6,\n      radiusMinPixels: 1,\n      radiusMaxPixels: 100,\n      getPosition: d => d && d.geometry && d.geometry.coordinates,\n      getRadius: d => Math.sqrt(d.exits),\n      getColor: d => [255, 140, 0],\n      onHover: renderTooltip\n    }\n    addOptionsToObject(options, scatterObj)\n    return (new ScatterplotLayer(scatterObj))\n  } else if (name === 'geojson') {\n    const geojsonObj = {\n      id: 'geojson-layer',\n      data,\n      pickable: true,\n      stroked: false,\n      filled: true,\n      extruded: true,\n      lineWidthScale: 20,\n      lineWidthMinPixels: 2,\n      getFillColor: [160, 160, 180, 200],\n      getLineColor: [255, 160, 180, 200],\n      getRadius: 100,\n      getLineWidth: 1,\n      getElevation: 30,\n      onHover: renderTooltip\n    }\n    addOptionsToObject(options, geojsonObj)\n    return (new GeoJsonLayer(geojsonObj))\n  } else if (name === 'icon') {\n    // console.log(data);\n\n    //icon from https://github.com/uber/deck.gl/blob/8d5b4df9e4ad41eaa1d06240c5fddb922576ee21/website/src/static/images/icon-atlas.png\n    const iconObj = {\n      id: 'icon-layer',\n      data,\n      pickable: true,\n      iconAtlas: 'location-icon-atlas.png',\n      iconMapping: mapping,\n      sizeScale: 60,\n      getPosition: d => d.geometry.coordinates,\n      wrapLongitude: true,\n      // getIcon: d => 'marker-1',\n      // getSize: d => 5,\n      // getColor: d => [Math.sqrt(d.exits), 140, 0],\n      onHover: renderTooltip\n    }\n    addOptionsToObject(options, iconObj)\n    return (new IconClusterLayer(iconObj))\n  } else if (name === 'sgrid') {\n    const sgridObject = {\n      id: 'screen_grid',\n      data,\n      getPosition: d => d.geometry.coordinates,\n      // getWeight: d => d.properties.weight,\n      cellSizePixels: 4,\n      // colorRange,\n      // gpuAggregation,\n      onHover: renderTooltip\n    }\n    addOptionsToObject(options, sgridObject)\n    return (new ScreenGridLayer(sgridObject))\n  } else if (name === 'grid') {\n    const gridObject = {\n      id: 'screen_grid',\n      data,\n      pickable: true,\n      extruded: true,\n      cellSize: 100,\n      elevationScale: 4,\n      getPosition: d => d.geometry.coordinates,\n      onHover: renderTooltip\n    }\n    addOptionsToObject(options, gridObject)\n    return (new GridLayer(gridObject))\n  } else if (name === 'line') {\n    const lineObject = {\n      id: 'line-layer',\n      data,\n      pickable: true,\n      onHover: renderTooltip\n    }\n    addOptionsToObject(options, lineObject)\n    return (new LineLayer(lineObject))\n  } else if (name === 'arc') {\n    const arcObject = {\n      id: 'arc-layer',\n      data,\n      pickable: true,\n      onHover: renderTooltip\n      // getSourcePosition: d => d.geometry.coordinates[0],\n      // getTargetPosition: d => d.geometry.coordinates[1],\n    }\n    addOptionsToObject(options, arcObject)\n    return (new ArcLayer(arcObject))\n  } else if (name === 'path') {\n    const pathObject = {\n      id: 'path-layer',\n      data,\n      pickable: true,\n      onHover: renderTooltip\n    }\n    addOptionsToObject(options, pathObject)\n    return (new PathLayer(pathObject))\n  } else if (name === 'heatmap') {\n    const heatObject = {\n      id: 'heatmap-layer',\n      data,\n      pickable: true,\n      onHover: renderTooltip,\n    }\n    addOptionsToObject(options, heatObject);\n    return (new HeatmapLayer(heatObject))\n  } else if (name === \"scatterplot\") {    \n    const scatterObject = {\n      id: 'scatterplot',\n      data,\n      pickable: true,\n      onHover: renderTooltip,\n      opacity: 0.3\n    }\n    addOptionsToObject(options, scatterObject);\n    return (new ScatterplotLayer(scatterObject))\n  } else if (name === \"text\") {\n    const textObject = {\n      id: 'text-layer',\n      data,\n      pickable: true,\n      onHover: renderTooltip,\n    }\n    addOptionsToObject(options, textObject);\n    return (new TextLayer(textObject))\n  }\n\n  return (null)\n}\n\nconst getCentroid = (coords) => {\n  let center = coords.reduce((x, y) => {\n    return [x[0] + y[0] / coords.length, x[1] + y[1] / coords.length]\n  }, [0, 0])\n  center = [parseFloat(center[1].toFixed(3)), parseFloat(center[0].toFixed(3))]\n  return center;\n}\n\nconst convertRange = (oldValue = 2, values = {\n  oldMax: 10, oldMin: 1,\n  newMax: 1, newMin: 0\n}) => {\n  // thanks to https://stackoverflow.com/a/929107/2332101\n  // OldRange = (OldMax - OldMin)  \n  // NewRange = (NewMax - NewMin)  \n  // NewValue = (((OldValue - OldMin) * NewRange) / OldRange) + NewMin\n  let value = (((oldValue - values.oldMin) * (values.newMax - values.newMin))\n    / (values.oldMax - values.oldMin)) + values.newMin\n  return +value.toFixed(2)\n}\n\nconst getParamsFromSearch = (search) => {\n  if (!search) return (null);\n\n  const qsResult = qs.parse(search.replace(\"?\", \"\"))\n  // 3 decimal points is street level\n  const lat = Number(qsResult.lat).toFixed(3);\n  const lng = Number(qsResult.lng).toFixed(3);\n  return ({\n    latitude: !isNaN(lat) ? Number(lat) : 53.8321,\n    longitude: !isNaN(lng) ? Number(lng) : -1.6362,\n    zoom: Number(qs.parse(search).zoom) || 10,\n    pit: Number(qs.parse(search).pit) || 55,\n    bea: Number(qs.parse(search).bea) || 0,\n    alt: Number(qs.parse(search).alt) || 1.5,\n  })\n};\n\nconst getBbx = (bounds) => {\n  if (!bounds) return null;\n  // xmin = -1.6449\n  // ymin = 53.82925\n  // xmax = -1.6270\n  // ymax = 53.8389\n  let xmin = bounds._sw.lng;\n  let xmax = bounds._ne.lng;\n  let ymin = bounds._sw.lat;\n  let ymax = bounds._ne.lat;\n  if (xmin > xmax) {\n    xmax = bounds._sw.lng;\n    xmin = bounds._ne.lng;\n  }\n  if (ymin > ymax) {\n    ymax = bounds._sw.lat;\n    ymin = bounds._ne.lat;\n  }\n  return ({ xmin, ymin, xmax, ymax })\n}\n\nconst suggestDeckLayer = (geojson) => {\n  // basic version should suggest a layer\n  // based on the geojson data types\n  // go through each feature? in case of features.\n\n}\nconst suggestUIforNumber = (number) => {\n  // \"checkbox\",     \n  // \"radio\",        \n  // \"buttongroups\", \n  // \"dropdown\",     \n  // \"slider\"])      \n  const { UI_LIST } = Constants;\n  if (!number) return UI_LIST[1];\n  if (number === 1) {\n    return UI_LIST[0];\n  } else if (number > 3 && number <= 6) {\n    return UI_LIST[1];\n  } else if (number === 2 || number === 3) {\n    return UI_LIST[2];\n  } else if (number > 9 && number < 15) {\n    return UI_LIST[3];\n  } else {\n    return UI_LIST[4]; // slider\n  }\n}\n\n/**\n * Changes a `_` separated `str` to space separated and\n * camel cases all words\n * \n * @param {*} str \n */\nconst humanize = (str) => {\n  if (!str) return str\n  let frags = str.split('_');\n  for (let i = 0; i < frags.length; i++) {\n    frags[i] = frags[i].charAt(0).toUpperCase() + frags[i].slice(1);\n  }\n  return frags.join(' ');\n}\n\nconst shortenName = (name, n = 26) => {\n  if (isNumber(name)) {\n    return parseFloat(Number.parseFloat(name).toFixed(2).toString())\n  }\n  if (!name || name.length <= n || !isString(name)) return name;\n  let shortened = name.trim();\n  const extension = name.split('.').length > 1 &&\n    name.split('.').pop().length < 10 && name.split('.').pop();\n  shortened.replace(extension, \"\");\n  if (name.length > 10) {\n    shortened = shortened.substring(0, 10) + \"...\" + (extension || \"\")\n  }\n  return (shortened);\n}\n\nconst percentDiv = (title, left, cb, dark) => {\n  return (\n    <div\n      key={title}\n      onClick={() => typeof (cb) === 'function' && cb()}\n      style={{\n        cursor: 'pointer',\n        textAlign: 'center',\n        position: 'relative',\n        float: 'left',\n        width: '30%',\n        color: dark ? 'white' : 'black',\n        margin: '10px 2px',\n        border: '1px solid gray',\n      }}>\n      <span style={{ position: 'absolute', left: '10%' }}>\n        {title}\n      </span>\n      <div style={{\n        width: left + '%',\n        height: 20,\n        background: 'rgb(18, 147, 154)',\n        // background: 'rgb(200, 120, 0)'\n      }}>\n      </div>\n    </div>\n  )\n}\n\n/**\n * Thanks to https://stackoverflow.com/a/34695026/2332101\n * @param {*} str \n */\nconst isURL = (str) => {\n  var a = document.createElement('a');\n  a.href = str;\n  return (a.host && a.host !== window.location.host);\n}\n\nconst isMobile = function () {\n  var check = false;\n  if (window.innerWidth < 640) return true;\n  (function (a) { if (/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(a.substr(0, 4))) check = true; })(navigator.userAgent || navigator.vendor || window.opera);\n  return check;\n};\n\nfunction hexToRgb(hex) {\n  let bigint = parseInt(hex.substring(1, hex.length), 16);\n  let r = (bigint >> 16) & 255;\n  let g = (bigint >> 8) & 255;\n  let b = bigint & 255;\n\n  return 'rgb(' + r + \",\" + g + \",\" + b + \")\";\n}\n\n/**\n * Generate colour scale for unique set of values\n * based on the index of the values in an array.\n * \n * @param {object} d particular property to get color for from features\n * @param {*} features features in a geojson featureset\n * @param {*} p index/name of column to generate color scale with\n * @param {Number} alpha value to add to colour pallete\n */\nconst colorScale = (d, features, p = 0, alpha = 180) => {\n  if (!d || !features || features.length === 0) return null;\n  const x = isNumber(p) ? Object.keys(d.properties)[p] : p;\n  let domainIsNumeric = true;\n  let domain = features.map(feature => {\n    // uber move to show isochrones\n    const i = feature.properties[x];\n    if (isNumber(i) &&\n      p === 'Mean.Travel.Time..Seconds.') {\n      return (Math.floor(i / 300))\n    } else if (domainIsNumeric && !isNumber(i)) {\n      // stop getting here if already been\n      domainIsNumeric = false;\n    }\n    return isNumber(i) ? +(i) : i\n  })\n  domain = Array.from(new Set(domain))\n  // sort the domain if possible\n  if (domainIsNumeric) {\n    domain = domain.sort((a, b) => { return (a - b) })\n  }\n  const index = domain.indexOf(isNumber(d.properties[x]) &&\n    p === 'Mean.Travel.Time..Seconds.' ?\n    Math.floor(d.properties[x] / 300) : d.properties[x])\n  // console.log(domain, index)\n  let col = interpolateOrRd(index / domain.length);\n  col = col.substring(4, col.length - 1)\n    .replace(/ /g, '')\n    .split(',').map(x => +x); // deck.gl 8 int not strings\n  return [...col, alpha]\n}\n\nconst colorRangeNames = ['inverseDefault', 'yellowblue', 'greens',\n  'oranges', 'diverge', 'default'];\n\nconst colorRanges = (name) => {\n  if (!name) return\n  const colors = {\n    yellowblue: [\n      [255, 255, 204],\n      [199, 233, 180],\n      [127, 205, 187],\n      [65, 182, 196],\n      [44, 127, 184],\n      [37, 52, 148]\n    ],\n    greens: [\n      [237, 248, 233],\n      [199, 233, 192],\n      [161, 217, 155],\n      [116, 196, 118],\n      [49, 163, 84],\n      [0, 109, 44],\n    ],\n    oranges: [\n      [254, 237, 222],\n      [253, 208, 162],\n      [253, 174, 107],\n      [253, 141, 60],\n      [230, 85, 13],\n      [166, 54, 3],\n    ],\n    diverge: [\n      [140, 81, 10],\n      [216, 179, 101],\n      [246, 232, 195],\n      [199, 234, 229],\n      [90, 180, 172],\n      [1, 102, 94]\n    ],\n    inverseDefault: [\n      [189, 0, 38],\n      [240, 59, 32],\n      [253, 141, 60],\n      [254, 178, 76],\n      [254, 217, 118],\n      [255, 255, 178]\n    ],\n    default: [\n      [255, 255, 178],\n      [254, 217, 118],\n      [254, 178, 76],\n      [253, 141, 60],\n      [240, 59, 32],\n      [189, 0, 38],\n    ]\n  }\n  return (colors[name])\n}\n\nconst iconJSType = (dataType) => {\n  // describeFeatureVariables in geojsonutils\n  // String, Number, Boolean and Object\n  if (!dataType) return (null)\n  switch (dataType) {\n    case \"String\":\n      dataType = \"fa fa-globe\";\n      break;\n    case \"Number\":\n      dataType = \"fa fa-list\";\n      break;\n    case \"Object\":\n      dataType = \"fa fa-sack\";\n      break;\n    default:\n      dataType = \"fa fa-question-circle\";\n  }\n  return dataType\n}\n\nconst searchNominatom = (location, callback) => {\n  const url = \"https://nominatim.openstreetmap.org/search/\" +\n    location + \"?format=json\";\n  fetchData(url, (json) => {\n    typeof callback === 'function' && callback(json)\n  })\n}\n\nconst ATILOGO = (dark = true) => (\n  <g id=\"Page-1\" stroke=\"none\" strokeWidth=\"1\" fill=\"none\" fillRule=\"evenodd\">\n    <g id=\"ATI_logo_black_ATI_logo_black_W1024px\" fill={dark ? \"#ffffff\" : '#000000'}>\n      <g id=\"logo-line-1\" data-svg-origin=\"0.8190000057220459 0.7929999828338623\" transform=\"matrix(1,0,0,1,0,0)\" style={{ zIndex: 0, visibility: 'inherit', opacity: 1 }}>\n        <path d=\"M273.346,71.521 L233.737,71.521 C235.771,58.945 242.738,52.485 253.966,52.485 C265.183,52.485 272.837,60.128 273.346,71.521 M299.694,83.932 C299.694,52.816 282.185,33.27 254.131,33.27 C226.425,33.27 207.72,52.816 207.72,81.718 C207.72,111.985 226.08,131.363 254.983,131.363 C277.938,131.363 293.744,120.479 299.529,100.424 L272.495,100.424 C269.775,107.735 263.987,111.475 255.493,111.475 C242.573,111.475 234.588,103.654 233.902,90.05 L299.529,90.05 C299.694,87.327 299.694,84.948 299.694,83.932\" id=\"Fill-13\"></path>\n        <path d=\"M117.531,128.642 L143.027,128.642 L143.027,83.08 C143.027,63.192 148.647,53.667 160.371,53.667 C171.081,53.667 175.162,59.62 175.162,74.751 L175.162,128.642 L200.658,128.642 L200.658,72.031 C200.658,57.749 198.622,50.437 193.181,44.156 C187.738,37.861 178.392,33.78 169.209,33.78 C159.354,33.78 149.664,38.713 143.027,47.042 L143.027,0.793 L117.531,0.793 L117.531,128.642\" id=\"Fill-12\"></path>\n        <polyline id=\"Fill-11\" points=\"55.645 0.796 0.819 0.796 0.819 23.242 42.3 23.242 42.3 128.632 69.158 128.632 69.158 23.242 110.474 23.242 110.474 0.796 55.645 0.796\"></polyline>\n      </g>\n      <g id=\"logo-line-2\" transform=\"matrix(1,0,0,1,169,149)\" data-svg-origin=\"0.9760000109672546 0.0860000029206276\" style={{ zIndex: 0, visibility: 'inherit', opacity: 1 }}>\n        <path d=\"M831.16,79.656 C831.16,94.445 823.69,104.3 812.635,104.3 C801.586,104.3 794.45,94.279 794.45,78.804 C794.45,63.671 801.928,53.308 812.814,53.308 C824.03,53.308 831.16,63.506 831.16,79.656 M855.82,108.724 L855.82,35.289 L832.87,35.289 L832.87,46.848 C825.9,37.158 818.078,33.076 807.029,33.076 C784.253,33.076 768.268,52.112 768.268,78.97 C768.268,106.169 783.222,124.202 805.668,124.202 C817.571,124.202 825.05,120.451 831.85,111.281 L831.85,120.972 C831.85,137.794 826.24,145.106 813.486,145.106 C804.306,145.106 798.025,140.515 797.504,133.382 L772.173,133.382 C773.877,152.076 789.175,163.125 813.145,163.125 C835.42,163.125 849.19,154.121 853.95,136.268 C855.65,129.631 855.82,127.087 855.82,108.724\" id=\"Fill-22\"></path>\n        <path d=\"M701.193,35.283 L676.88,35.283 L676.88,127.932 L702.389,127.932 L702.389,79.994 C702.389,61.465 707.819,52.792 719.557,52.792 C724.997,52.792 729.589,55.349 732.133,59.417 C733.836,62.482 734.346,65.547 734.346,73.534 L734.346,127.932 L759.842,127.932 L759.842,75.402 C759.842,58.91 758.825,52.957 755.085,47.007 C749.476,38.168 739.951,33.249 728.227,33.249 C716.834,33.249 707.144,38.168 701.193,46.841 L701.193,35.283\" id=\"Fill-21\"></path>\n        <path d=\"M637.104,24.567 L662.601,24.567 L662.601,0.088 L637.104,0.088 L637.104,24.567 Z M637.104,127.938 L662.601,127.938 L662.601,35.285 L637.104,35.285 L637.104,127.938 Z\" id=\"Fill-20\"></path>\n        <path d=\"M569.69,127.936 L595.186,127.936 L595.186,86.965 C595.186,64.189 601.991,55.339 619.334,55.339 C622.055,55.339 623.747,55.515 626.467,56.191 L626.467,34.09 C624.089,33.238 622.564,33.073 619.676,33.073 C608.106,33.073 598.926,38.172 594.004,47.352 L594.004,35.286 L569.69,35.286 L569.69,127.936\" id=\"Fill-19\"></path>\n        <path d=\"M532.476,127.936 L556.789,127.936 L556.789,35.286 L531.28,35.286 L531.28,83.225 C531.28,93.259 530.442,98.358 527.884,102.44 C524.822,107.538 519.721,110.424 514.112,110.424 C508.672,110.424 504.08,108.048 501.536,103.798 C499.833,100.737 499.323,97.672 499.323,89.685 L499.323,35.286 L473.827,35.286 L473.827,87.816 C473.827,104.308 474.847,110.259 478.584,116.212 C484.193,125.05 493.883,129.97 505.442,129.97 C516.67,129.97 526.36,125.05 532.476,116.377 L532.476,127.936\" id=\"Fill-18\"></path>\n        <polyline id=\"Fill-17\" points=\"425.87 127.936 452.728 127.936 452.728 22.531 494.041 22.531 494.041 0.086 384.389 0.086 384.389 22.531 425.87 22.531 425.87 127.936\"></polyline>\n        <path d=\"M287.694,35.283 L263.38,35.283 L263.38,127.932 L288.89,127.932 L288.89,79.994 C288.89,61.465 294.319,52.792 306.057,52.792 C311.498,52.792 316.089,55.349 318.633,59.417 C320.336,62.482 320.846,65.547 320.846,73.534 L320.846,127.932 L346.342,127.932 L346.342,75.402 C346.342,58.91 345.325,52.957 341.585,47.007 C335.977,38.168 326.452,33.249 314.728,33.249 C303.334,33.249 293.644,38.168 287.694,46.841 L287.694,35.283\" id=\"Fill-16\"></path>\n        <path d=\"M226.718,85.77 C226.718,102.428 219.24,111.952 206.144,111.952 C197.991,111.952 192.206,107.364 192.206,101.08 C192.206,93.934 198.501,90.362 214.472,87.818 L223.322,86.456 C223.653,86.28 224.849,86.115 226.718,85.77 M250.687,87.473 C250.852,80.671 250.852,76.59 250.852,74.553 C250.852,57.388 248.818,50.077 241.851,43.272 C235.046,36.305 224.339,32.565 210.912,32.565 C186.088,32.565 170.448,44.468 169.254,64.356 L195.436,64.356 C195.944,55.175 201.221,50.584 211.419,50.584 C221.961,50.584 226.552,56.192 226.718,69.278 C215.5,69.964 200.37,72.177 192.041,74.388 C174.353,78.635 165.68,87.818 165.68,101.92 C165.68,118.413 179.451,129.971 199.353,129.971 C214.307,129.971 223.653,125.049 230.457,113.656 L230.457,117.396 C230.457,120.967 230.623,122.839 231.309,127.937 L253.244,127.937 C251.373,120.116 250.687,110.935 250.687,96.147 L250.687,87.473\" id=\"Fill-15\"></path>\n        <polygon id=\"Fill-14\" points=\"130.939 127.937 156.435 127.937 156.435 0.087 130.939 0.087\"></polygon>\n        <path d=\"M79.347,73.37 L45.508,73.37 L62.51,20.319 L79.347,73.37 Z M125.075,127.937 L80.529,0.087 L45.343,0.087 L0.976,127.937 L28.341,127.937 L38.541,96.311 L86.659,96.311 L97.024,127.937 L125.075,127.937 Z\" id=\"Fill-1\"></path>\n      </g>\n      <g id=\"logo-line-3\" transform=\"matrix(1,0,0,1,24,297)\" data-svg-origin=\"0.7670000195503235 0.34700000286102295\" style={{ zIndex: 0, visibility: 'inherit', opacity: 1 }}>\n        <path d=\"M592.476,71.073 L552.866,71.073 C554.9,58.497 561.868,52.037 573.096,52.037 C584.313,52.037 591.966,59.68 592.476,71.073 M618.824,83.484 C618.824,52.368 601.315,32.822 573.261,32.822 C545.552,32.822 526.849,52.368 526.849,81.273 C526.849,111.537 545.21,130.915 574.113,130.915 C597.068,130.915 612.874,120.031 618.659,99.976 L591.625,99.976 C588.902,107.29 583.117,111.028 574.623,111.028 C561.702,111.028 553.718,103.206 553.032,89.602 L618.659,89.602 C618.824,86.879 618.824,84.501 618.824,83.484\" id=\"Fill-10\"></path>\n        <path d=\"M521.303,35.543 L506.348,35.543 L506.348,13.1 L480.839,13.1 L480.839,35.543 L467.246,35.543 L467.246,54.758 L480.839,54.758 L480.839,97.256 C480.839,109.501 481.858,114.765 485.43,120.029 C490.187,127.175 497.168,130.24 508.548,130.24 C513.826,130.24 516.546,129.898 521.303,128.702 L521.303,109.666 C518.238,110.008 517.221,110.173 516.039,110.173 C509.058,110.173 506.348,106.271 506.348,96.236 L506.348,54.758 L521.303,54.758 L521.303,35.543\" id=\"Fill-9\"></path>\n        <path d=\"M434.281,128.196 L458.595,128.196 L458.595,35.546 L433.085,35.546 L433.085,83.485 C433.085,93.52 432.247,98.618 429.69,102.7 C426.625,107.799 421.527,110.684 415.918,110.684 C410.478,110.684 405.886,108.308 403.342,104.061 C401.639,100.997 401.129,97.932 401.129,89.945 L401.129,35.546 L375.633,35.546 L375.633,88.076 C375.633,104.568 376.65,110.519 380.39,116.472 C385.998,125.31 395.689,130.23 407.247,130.23 C418.476,130.23 428.163,125.31 434.281,116.637 L434.281,128.196\" id=\"Fill-8\"></path>\n        <path d=\"M364.433,35.543 L349.479,35.543 L349.479,13.1 L323.969,13.1 L323.969,35.543 L310.376,35.543 L310.376,54.758 L323.969,54.758 L323.969,97.256 C323.969,109.501 324.989,114.765 328.56,120.029 C333.317,127.175 340.298,130.24 351.678,130.24 C356.956,130.24 359.676,129.898 364.433,128.702 L364.433,109.666 C361.368,110.008 360.351,110.173 359.169,110.173 C352.188,110.173 349.479,106.271 349.479,96.236 L349.479,54.758 L364.433,54.758 L364.433,35.543\" id=\"Fill-7\"></path>\n        <path d=\"M288.764,0.347 L276.009,0.347 L276.009,24.823 L301.519,24.823 L301.519,0.347 L288.764,0.347 Z M288.764,35.533 L276.009,35.533 L276.009,128.197 L301.519,128.197 L301.519,35.533 L288.764,35.533 Z\" id=\"Fill-6\"></path>\n        <path d=\"M265.918,35.543 L250.964,35.543 L250.964,13.1 L225.454,13.1 L225.454,35.543 L211.862,35.543 L211.862,54.758 L225.454,54.758 L225.454,97.256 C225.454,109.501 226.474,114.765 230.046,120.029 C234.803,127.175 241.784,130.24 253.164,130.24 C258.441,130.24 261.162,129.898 265.918,128.702 L265.918,109.666 C262.854,110.008 261.837,110.173 260.654,110.173 C253.673,110.173 250.964,106.271 250.964,96.236 L250.964,54.758 L265.918,54.758 L265.918,35.543\" id=\"Fill-5\"></path>\n        <path d=\"M207.476,65.123 C207.641,44.891 193.194,32.825 168.373,32.825 C144.404,32.825 129.105,44.384 129.105,62.238 C129.105,69.029 131.991,75.83 137.092,80.422 C142.877,85.697 148.993,88.076 165.995,91.65 C178.57,94.359 183.162,97.421 183.162,103.209 C183.162,108.638 177.553,112.213 169.059,112.213 C158.341,112.213 152.732,107.111 152.909,97.256 L126.892,97.256 C127.236,118.849 142.367,130.918 168.883,130.918 C194.048,130.918 209.689,119.357 209.689,100.83 C209.689,86.714 201.36,78.209 182.997,73.452 L164.633,68.698 C157.666,66.826 154.601,64.272 154.601,60.19 C154.601,54.581 159.369,51.186 167.356,51.186 C177.719,51.186 181.98,55.091 182.487,65.123 L207.476,65.123\" id=\"Fill-4\"></path>\n        <path d=\"M61.442,35.543 L37.128,35.543 L37.128,128.192 L62.638,128.192 L62.638,80.254 C62.638,61.725 68.068,53.055 79.806,53.055 C85.246,53.055 89.838,55.609 92.381,59.68 C94.085,62.742 94.594,65.807 94.594,73.794 L94.594,128.192 L120.091,128.192 L120.091,75.662 C120.091,59.17 119.074,53.22 115.334,47.267 C109.725,38.428 100.2,33.509 88.476,33.509 C77.083,33.509 67.392,38.428 61.442,47.102 L61.442,35.543\" id=\"Fill-3\"></path>\n        <polyline id=\"Fill-2\" points=\"13.508 0.347 0.767 0.347 0.767 128.197 26.249 128.197 26.249 0.347 13.508 0.347\"></polyline>\n      </g>\n    </g>\n  </g>\n)\n\n/**\n * \n * @param {*} options \n */\nconst generateLegend = (options) => {\n  //quick check \n  const { domain, interpolate = interpolateOrRd, title } = options;\n  if (!domain || !Array.isArray(domain) || !isNumber(domain[0])) return\n  const jMax = domain[domain.length - 1], jMin = domain[0];\n  const legend = [<p key='title'>{title}</p>]\n\n  for (var i = 0; i < 10; i += 1) {\n    legend.push(\n      <>\n        {i === 0 &&\n          <i>{(title === humanize('Mean.Travel.Time..Seconds.') ?\n            +(jMin) / 300 : jMin).toFixed(2)\n          }</i>\n        }\n        <span key={i} style={{ background: interpolate(i / 10) }}>\n        </span>\n        {i === 9 &&\n          <i>{(title === humanize('Mean.Travel.Time..Seconds.') ?\n            +(jMax) / 300 : jMax).toFixed(2)\n          }</i>\n        }\n      </>)\n  }\n  return legend;\n}\n\n/**\n * \n * @param {*} data features from a geojson object\n * @param {*} column \n */\nconst generateDomain = (data, column) => {\n  if (!data || !Array.isArray(data) || !column ||\n    !isString(column) || data.length === 0) return;\n\n  let domainIsNumeric = true;\n  let domain = data.map(feature => {\n    // uber move to show isochrones\n    const i = feature.properties[column];\n    if (isNumber(i) &&\n      column === 'Mean.Travel.Time..Seconds.') {\n      return (Math.floor(i / 300));\n    }\n    return isNumber(i) ? +(i) : i;\n  });\n  domain = Array.from(new Set(domain));\n  // sort the domain if possible\n  if (domainIsNumeric) {\n    domain = domain.sort((a, b) => { return (a - b); });\n  }\n  return domain\n}\n\nconst sortNumericArray = (array) => {\n  let domainIsNumeric = true;\n  // sort the domain if possible\n  array.map(e => !isNumber(e) && (domainIsNumeric = false))\n  if (domainIsNumeric) {\n    array = array.sort((a, b) => { return (a - b); });\n  }\n  return array\n}\n\nconst getMax = (arr) => {\n  return arr.reduce((max, v) => max >= v ? max : v, -Infinity);\n}\nconst getMin = (arr) => {\n  return arr.reduce((max, v) => max <= v ? max : v, Infinity);\n}\nexport {\n  getResultsFromGoogleMaps,\n  getParamsFromSearch,\n  xyObjectByProperty,\n  suggestUIforNumber,\n  generateDeckLayer,\n  suggestDeckLayer,\n  sortNumericArray,\n  colorRangeNames,\n  searchNominatom,\n  generateLegend,\n  generateDomain,\n  convertRange,\n  getCentroid,\n  shortenName,\n  colorRanges,\n  percentDiv,\n  iconJSType,\n  colorScale,\n  fetchData,\n  humanize,\n  isMobile,\n  ATILOGO,\n  getBbx,\n  getMin,\n  getMax,\n  isURL,\n}","import * as React from 'react';\nimport { FileUploader } from 'baseui/file-uploader';\n\nexport default class Uploader extends React.Component {\n  state = { progressAmount: 0 };\n\n  handleDrop = (acceptedFiles, rejectedFiles) => {\n    const { contentCallback } = this.props;\n    const textType = /text.*/;\n    const file = acceptedFiles[0]\n    // console.log(file);\n    // console.log(file.type);\n\n    if (!file.type || file.type.match(textType) || file.type.match(/geo/) \n    || file.type.match(/json/)) {\n      const reader = new FileReader();\n      reader.onload = (e) => {\n        this.setState({ progressAmount: 100 });\n        this.reset();\n        const text = reader.result;\n        typeof (contentCallback) === 'function' &&\n          contentCallback({ text, name: file.name })\n        // console.log(text)        \n      }\n      reader.readAsText(file);\n    } else {\n      this.setState({ progressAmount: 100 });\n      this.reset();\n      console.log(\"File not supported!\")\n    }\n    // handle file upload...\n    this.startProgress();\n  };\n\n  // startProgress method is only illustrative. Use the progress info returned\n  // from your upload endpoint. If unavailable, do not provide a progressAmount.\n  startProgress = () => {\n    this.intervalId = setInterval(() => {\n      if (this.state.progressAmount >= 100) {\n        this.reset();\n      } else {\n        this.setState({ progressAmount: this.state.progressAmount + 10 });\n      }\n    }, 500);\n  };\n\n  // reset the component to its original state. use this to cancel/retry the upload.\n  reset = () => {\n    clearInterval(this.intervalId);\n    this.setState({ progressAmount: 0 });\n  };\n\n  render() {\n    return (\n      <center className=\"file-upload\">\n        <FileUploader\n          onCancel={this.reset}\n          onDrop={this.handleDrop}\n          progressAmount={this.state.progressAmount}\n          progressMessage={\n            this.state.progressAmount &&\n            `Uploading... ${this.state.progressAmount}% of 100%`\n          }\n        />\n      </center>\n    );\n  }\n}","import React, { useState } from 'react';\nimport {\n  InputGroup, FormControl,\n  Glyphicon, FormGroup\n} from 'react-bootstrap';\n\nimport { isURL } from '../utils';\n\nexport default function URL(props) {\n  const { urlCallback } = props;\n  const [url, setUrl] = useState(\"https://domain.com/api/stats19\")\n\n  return (\n    <form\n      onKeyPress={(event) => {\n        if (event.which === 13 /* Enter */) {\n          event.preventDefault();\n          isURL(url) && typeof (urlCallback) === 'function' &&\n            urlCallback(url)\n        }\n      }}\n      className=\"search-form\">\n      <FormGroup>\n        <InputGroup>\n          <FormControl\n          onChange={(e) => {            \n            const { value } = e.target;\n            setUrl(value)\n            // console.log(isURL(value))\n          }}\n          style={{\n            background: props.dark ? '#242730' : 'white',\n            color: props.dark ? 'white' : 'black'\n          }}\n          value={url}\n          placeholder={url} type=\"text\" />\n          <InputGroup.Addon\n          style={{\n            background: props.dark ? '#242730' : 'white',\n            color: props.dark ? 'white' : 'black'\n          }}>\n            <Glyphicon \n            glyph=\"globe\" />\n          </InputGroup.Addon>\n        </InputGroup>\n      </FormGroup>\n    </form>\n  )\n}","/**\n * eAtlas code\n *  \n * React component which takes a GeoJSON object. Loops through its\n * properties and show the list to start with. Each property \n * can show all avialable values. Each value can be selected/deselected.\n *\n * Current code can deal with only one GeoJSON property's keys.\n * \n * Next is handling multiple GeoJSON key value pairs.\n * Next will be replacing current \"hard\" code in the parent code,\n * so that all key values can be dynamically filtered.\n * \n * This should be generalizeable to any GeoJSON file, or that is the\n * aim.\n */\nimport React, { Component } from 'react';\n\nimport './style.css';\nimport { humanize } from '../utils';\nimport { isEmptyOrSpaces } from '../JSUtils';\nimport { describeFeatureVariables, getKeyColumns } from '../geojsonutils';\nimport { Button, SIZE, KIND } from 'baseui/button';\nimport MultiSelect from './MultiSelect';\n\nconst SHOWN_ITEMS = 5;\nexport default class Variables extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      list: null,\n      showAll: false,\n      selected: props.multiVarSelect || {},\n      n: SHOWN_ITEMS\n    }\n    this._geoJSONPropsOrValues = this._geoJSONPropsOrValues.bind(this);\n    this._showSelectedVars = this._showSelectedVars.bind(this);\n    this._generateList = this._generateList.bind(this);\n    this._processData = this._processData.bind(this);\n    this._multiSelect = this._multiSelect.bind(this);\n    this._showTopn = this._showTopn.bind(this);\n    this._shorten = this._shorten.bind(this);\n    this._button = this._button.bind(this);\n  }\n\n  componentDidMount() {\n    const { data } = this.props;\n    if (!data || data.length === 0) return (null);\n    this._processData(data);\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    const { data } = this.props;\n    if (!data || data.length === 0) return;\n\n    if (data.length !== prevProps.data.length ||\n      this.state.showAll !== prevState.showAll) {\n      this._processData(data);\n    }\n  }\n\n  /**\n   * The main function in this clase.\n   * \n   * Loops through properties of a GeoJSON object, \n   * generates both properties and their available values.\n   * Uses Set to avaoid duplicates for each property values set.\n   * \n   */\n  _generateList() {\n    const { data, onSelectCallback, style, subStyle,\n      propertyValuesCallback } = this.props;\n    const selected = this.state.selected;\n    const description = describeFeatureVariables(data[0]); // describe first feature\n    const keys = getKeyColumns({ features: data });\n    const all = Object.keys(data[0].properties);\n    const limit = this.state.showAll ? all.length : 10;\n    // console.log(limit);\n\n    const list = all.slice(0, limit)\n      .map(key =>\n        <span\n          style={style}\n          onClick={() => {\n            if (key === \"date\") return;\n            let sublist = [];\n            data.forEach(feature =>\n              Object.keys(feature.properties).forEach(property =>\n                property === key && feature.properties[key] &&\n                !sublist.includes(feature.properties[key]) &&\n                sublist.push(\n                  feature.properties[key]\n                )\n              )\n            )\n            // before turning them into spans\n            typeof (propertyValuesCallback) === 'function' &&\n              propertyValuesCallback({ key, sublist })\n\n            sublist = sublist.map(each => each &&\n              <span\n                style={subStyle}\n                onClick={() => {\n                  //add each to the key\n                  if (!selected.hasOwnProperty(key)) {\n                    selected[key] = new Set()\n                  }\n                  selected[key].add(each + \"\"); // make sure it is string\n                  typeof (onSelectCallback) === 'function' &&\n                    onSelectCallback(selected)\n                  this.setState({ selected })\n                }}\n                className=\"sub\"\n                key={each + \"\"}\n              >\n                {this._shorten(each, 20)}\n              </span>\n            )\n            this.setState({\n              sublist: sublist,\n              key\n            })\n          }}\n          key={key}>\n          {this._shorten(key)}\n          {' '}\n          <i // keep it i\n            style={{ color: 'orange' }}\n            className=\"data-type\">\n            [\n            {description[key].name.substring(0, 3)}\n            {keys && keys.includes(key) && ', UNQ'}\n            ]\n          </i>\n        </span>\n      )\n    return (list)\n  }\n\n  _shorten(key, n = 10) {\n    if (typeof (key) !== 'string') return key\n    return key.length < n ? humanize(key) :\n      humanize(key).substring(0, n) + \"...\";\n  }\n\n  /**\n   * As state changes regenerate key/vlaues\n   * @param {*} data \n   */\n  _processData(data) {\n    const list = this._generateList();\n    this.setState({\n      list,\n      // if we do following, exploring variables becomes less useful\n      // key: null,    // reset sublist\n      // sublist: null // reset sublist\n    });\n  }\n\n  /**\n   * \n   * @param {*} shownSublist array of spans class tagcloud\n   * @param {*} n \n   */\n  _showTopn(shownSublist) {\n    const { sublist, showAll } = this.state;\n    let n = this.state.n;\n    if (shownSublist.length < n) n = shownSublist.length\n    return <>\n      {shownSublist.length > SHOWN_ITEMS &&\n        <div style={{ width: '100%' }}>\n          {showAll ?\n            this._button(showAll, \"Less\", SHOWN_ITEMS) :\n            this._button(showAll, undefined, sublist.length)\n          }\n        </div>\n      }\n      {shownSublist.slice(0, n)}\n      <p>Showing {n} out of {shownSublist.length}</p>\n    </>;\n  }\n\n  /**\n   * Word cloud of all values for a particular key.\n   * \n   * @param {*} selected \n   * @param {*} key \n   */\n  _showSelectedVars(selected, key) {\n    const { onSelectCallback } = this.props;\n    let ret = []\n    selected && selected[key] && selected[key].size > 0 &&\n      selected[key].forEach(each => {\n        if (ret.length === 0) ret.push(<p key=\"chosen-label\">\n          <b>{` ${humanize(key)}'s `}</b> values</p>)\n        //add remove\n        ret.push(<i\n          className=\"active-variable\"\n          style={this.props.subStyle}\n          key={\"remove-\" + each} onClick={() => {\n            selected[key].delete(each);\n            if (selected[key].size === 0) delete selected[key]\n            typeof (onSelectCallback) === 'function' &&\n              onSelectCallback(selected)\n            this.setState({ selected });\n          }}>{`${each} `}<span\n            style={{ borderRadius: '50%' }}\n            className=\"unselect-variable\">x</span></i>)\n      });\n    return (ret)\n  }\n\n  /**\n   * Show:\n   * 1. If filtered sublist has been populated and it is\n   * above 5 (top 5)\n   * 2. If all has been filtered then show nothing\n   * 3. If 5 or less has been filtered show them\n   * 4. Otherwise just show sublist UNfiltered (top 5)\n   */\n  _geoJSONPropsOrValues(shownSublist, selected, key, sublist) {\n    // console.log(selected);\n    const { n } = this.state;\n    if (!sublist) return null\n    if ((!shownSublist || shownSublist.length === 0) &&\n      (!selected || !selected[key] || selected[key].size === 0)) {\n      return this._showTopn(sublist)\n    } else if (selected && selected[key] && selected[key].size ===\n      sublist.length) {\n      return null\n    } else if (shownSublist.length > n) {\n      return this._showTopn(shownSublist)\n    }\n    return shownSublist\n  }\n\n  render() {\n    const { list, sublist, key, selected, showAll } = this.state;\n    const { data, onSelectCallback } = this.props;\n    const shownSublist = sublist && selected && key &&\n      sublist.filter(each => {\n        return selected[key] && each && !selected[key].has(each.key)\n      })\n\n    if (data && Object.keys(data[0].properties)\n      .filter(p => !isEmptyOrSpaces(p)).length === 0) {\n      return (\n        <h3>There are no columns to inspect or filter.</h3>\n      )\n    }\n    return (\n      <div style={this.props.style}>\n        Dataset:\n          <div>\n          <div className=\"tagcloud\">\n            {\n              //show main GeoJSON key if there is one chosen\n              key ?\n                <>\n                  <i>{`${humanize(key)}`}</i>\n                  <span\n                    onClick={() => this.setState({\n                      sublist: null,\n                      key: null\n                    })}\n                    style={{ borderRadius: '50%' }}\n                    className=\"unselect-variable\">x</span>\n                </> :\n                data && data.length > 1 &&\n                  Object.keys(data[0].properties).length > 10 &&\n                  !showAll ?\n                  <>\n                    First (10) of {\n                      Object.keys(data[0].properties).length}:\n                      {/* TODO: swap once theme is active */}\n                    {this._button(showAll)}\n                    {list}\n                  </> :\n                  <>\n                    {\n                      Object.keys(data[0].properties).length > 10 &&\n                      this._button(showAll, \"Less\")\n                    }\n                    {list}\n                  </>\n            }\n          </div>\n          {\n            this._multiSelect(key, selected, sublist, onSelectCallback)\n          }\n          <div className=\"tagcloud\">\n            {\n              this._geoJSONPropsOrValues(shownSublist, selected, key, sublist)\n            }\n          </div>\n          <div className=\"tagcloud\">\n            {\n              // simplest logic\n              // if you click me, I will remove myself from the list\n              this._showSelectedVars(selected, key)\n            }\n          </div>\n        </div>\n      </div>\n    )\n  }\n\n  _multiSelect(key, selected, sublist, onSelectCallback) {\n    return key &&\n      <MultiSelect title=\"Choose value\" multiVarSelect={selected} values={sublist && sublist.length > 0 &&\n        sublist.map(e => ({ id: e.key, value: e.key }))} filter={key} onSelectCallback={(filter) => {\n          typeof (onSelectCallback) === 'function' &&\n            onSelectCallback(filter.selected || {});\n          this.setState({\n            selected: filter.selected || {} // not \"\"\n          });\n        } }\n        // sync state\n        value={selected && selected[key] && Array.from(selected[key])\n          .map(e => ({ id: e, value: e }))} />;\n  }\n\n  _button(showAll, title = \"Show all\", n) {\n    return <Button size={SIZE.compact} kind={KIND.secondary}\n      onClick={() => {\n        this.setState({\n          showAll: !showAll,\n          n: n ? n : this.state.n\n        });\n      }}>{title}</Button>;\n  }\n}\n","import React from 'react';\nimport { Table } from 'baseui/table';\nimport { Pagination } from 'baseui/pagination';\n\nimport { humanize } from '../utils';\n\nexport default function DataTable(props) {\n  const [currentPage, setCurrentPage] = React.useState(1);\n\n  const { data } = props;\n  if (!data || data.length === 0) return null\n  const numPages = Math.floor(data.length / 10)\n\n  const columns = Object.keys(data[0].properties)\n    .map(each => humanize(each))\n\n  const rows = data.slice(currentPage * 10, (currentPage * 10) + 10)\n    .map(feature => Object.keys(feature.properties).map(e =>\n      feature.properties[e]))\n\n  return (\n    <>\n      <Pagination\n        numPages={numPages}\n        currentPage={currentPage}\n        onPageChange={({ nextPage }) => {\n          setCurrentPage(Math.min(Math.max(nextPage, 1), numPages));\n        }}\n      />\n      <Table columns={columns} data={rows} />\n      {/* // not nice 1000px */}\n      <Pagination\n        numPages={numPages}\n        currentPage={currentPage}\n        onPageChange={({ nextPage }) => {\n          setCurrentPage(Math.min(Math.max(nextPage, 1), numPages));\n        }}\n      />\n    </>\n  )\n}","import React from 'react';\n\nimport { Slider } from 'baseui/slider';\nimport { Checkbox } from 'baseui/checkbox';\nimport { Button } from 'baseui/button';\nimport { StatefulButtonGroup } from 'baseui/button-group';\nimport { StatefulSelect, TYPE } from 'baseui/select';\n\nimport {\n  suggestUIforNumber, humanize\n} from '../utils';\n\nexport default class UI extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      checks: [],\n    }\n  }\n\n  render() {\n    const {\n      title, sublist, suggested, onChange, steps\n    } = this.props;\n    if (!title || !sublist || sublist.length === 0) return null;\n    const new_checks = this.state.checks;\n    const ui_name = suggested || suggestUIforNumber(sublist.length)\n    let ui_returned = null;\n    if (ui_name === \"checkbox\") {\n      ui_returned = <>\n        {\n          sublist.map((each, i) =>\n            // deal with each checked!\n            <Checkbox\n              key={each}\n              checked={this.state.checks[i]}\n              value={each}\n              onChange={() => {\n                new_checks[i] = !new_checks[i]\n                this.setState({\n                  checks: new_checks\n                })\n              }}>\n              {each}\n            </Checkbox>\n          )\n        }\n      </>\n    } else if (ui_name === \"slider\" && parseInt(sublist[0])) {\n      const s = sublist;\n      ui_returned =\n        <>\n          <Slider\n            value={this.state.value || [s[0]]}\n            min={parseInt(s[0])}\n            max={parseInt(s[s.length - 1])}\n            step={steps || 1} //something\n            onChange={({ value }) => {\n              this.setState({ value });\n              typeof (onChange) === 'function' && onChange(value[0])\n            }}\n          />\n          {title}\n        </>\n    } else if (ui_name === \"buttongroups\") {\n      ui_returned = <>\n        Checkbox Mode StatefulButtonGroup\n        <StatefulButtonGroup mode=\"checkbox\"\n          initialState={{ selected: [0] }}\n        >\n          {\n            sublist.map((each, i) =>\n              <Button\n                key={each + \"-\" + i}\n                value={each}\n                onClick={(e) => console.log(e.target.value)}>\n                {each}\n              </Button>\n            )\n          }\n        </StatefulButtonGroup>\n      </>\n    } else {\n      ui_returned = <StatefulSelect\n        options={sublist.map(each => ({ id: each }))}\n        labelKey=\"id\"\n        placeholder={\"Choose \" + humanize(title)}\n        type={TYPE.search}\n        onChange={event => \n          console.log(event && event.value[0] && event.value[0].id)\n        }\n      />\n    }\n    return ui_returned\n  }\n}","import React, { useState } from 'react';\n\nimport { makeWidthFlexible, Treemap } from 'react-vis';\nconst FlexibleTreemap = makeWidthFlexible(Treemap); \n\nconst H = 250;\n/**\n * props.data needs to be in this formard\n * {\n *    title: 'sometitle',\n *    color: 1,\n *    children: [1,2,3,4].map(e => ({\n *      name: e,\n *      size: Math.random() * 500,\n *      color: Math.random(),\n *      style: {\n *        border: 'thin solid red'\n *      }\n *     }\n *   ))\n * }\n * \n * @param {Object} props react props\n */\nexport default function TreeMap(props) {\n  const [hoveredNode, setHoveredNode] = useState(false)\n  const { data, plotStyle, title } = props;\n  \n  const treeProps = {\n    animation: {\n      damping: 9,\n      stiffness: 300\n    },\n    data,\n    onLeafMouseOver: x => setHoveredNode({ hoveredNode: x }),\n    onLeafMouseOut: () => setHoveredNode({ hoveredNode: false }),\n    // onLeafClick: () => this.setState({ treemapData: _getRandomData() }),\n    mode: 'squarify',\n    getLabel: x => x.name,\n    // see \n    // https://github.com/uber/react-vis/issues/262#issuecomment-281757385\n    width: plotStyle && plotStyle.width || H + 50,\n    height: plotStyle && plotStyle.height || H\n  };\n\n  if(!data || data.length === 0) return null;\n  return (\n    <div className=\"dynamic-treemap-example\">\n      <h6>{title}</h6>\n      {<FlexibleTreemap {...treeProps} />}\n        {hoveredNode && hoveredNode.value}\n    </div>\n  )\n}","import React, { useState, useEffect } from 'react';\nimport { Button, KIND, SIZE } from 'baseui/button';\nimport { Accordion, Panel } from 'baseui/accordion';\nimport { VerticalBarSeries, HorizontalBarSeries, LineSeries } from 'react-vis';\n\nimport MultiSelect from './MultiSelect';\nimport TreeMap from './TreeMap';\nimport { humanize } from '../utils';\nimport { isString, isNumber } from '../JSUtils';\nimport { xyObjectByProperty } from '../utils';\nimport SeriesPlot from './Showcases/SeriesPlot';\n\nconst VIS = ['Vertical Bar', 'Horizontal Bar',\n  'Line', 'Pop. Pyramid', 'Treemap'];\n\n/**\n * Generate approprate series/marks for a React-vis\n * type from data and column name.\n * \n * @param {Object} data geojson features to generate counts from\n * @param {String} column name of column in feature to generate counts from\n * @param {String} vis type of visualization (react-vis type)\n * @param {Object} plotStyle styling of the plot (css)\n * @param {Boolean} noLimit boolean to crop chart\n */\nfunction generateVIS(data, column, vis, plotStyle, noLimit, dark) {\n  if (!data || data.length === 0 || !isString(column) || !isString(vis)) {\n    return;\n  }\n  let counts = xyObjectByProperty(data, column)\n\n  if (vis === 'Treemap') {\n    return (\n      <TreeMap\n        plotStyle={plotStyle}\n        data={{\n          title: column + \" \" + vis,\n          color: 1,\n          children: counts.map((e, i) => ({\n            name: e.x,\n            size: +(e.y) / data.length,\n            color: isNumber(e.x) || i,\n            style: {\n              border: 'thin solid red'\n            }\n          }))\n        }}\n        title={humanize(column)}\n      />\n    )\n  }\n  if (vis.startsWith('Vertical') ||\n    vis.startsWith(\"Horizontal\") ||\n    vis.startsWith(\"Line\")) {\n    return (\n      <SeriesPlot\n        dark={dark}\n        noLimit={noLimit}\n        plotStyle={plotStyle}\n        data={counts}\n        type={\n          vis.startsWith(\"Vertical\") ?\n            VerticalBarSeries :\n            vis.startsWith(\"Horizontal\") ?\n              HorizontalBarSeries :\n              LineSeries\n        }\n        title={humanize(column)} noYAxis={true}\n      />\n    )\n  }\n}\nexport default function AddVIS(props) {\n  const [column, setColumn] = useState(false)\n  const [vis, setVis] = useState(false)\n  const [list, setList] = useState([]);\n  // useEffect(() => {\n  // if props.data changes only then it should react to it\n  // setVis(false);\n  // setColumn([])\n  // }, [props.data])\n\n\n  const { data, onSelectCallback, dark,\n    noAccordion, plotStyle, noLimit } = props;\n\n  if (!data || data.length === 0) return null;\n\n  const columns = Object.keys(data[0].properties);\n\n  return (\n    <div>\n      <h6>Generate graphs from columns</h6>\n      <div className=\"searchField\">\n        <MultiSelect\n          single={true}\n          title=\"Choose column\"\n          values={columns.map(e => ({ id: humanize(e), value: e }))}\n          onSelectCallback={(selected) => {\n            setColumn(selected);\n            typeof onSelectCallback === 'function' &&\n              onSelectCallback(selected)\n          }}\n          // sync state\n          value={column}\n        />\n        {column.length > 0 &&\n          <MultiSelect\n            single={true}\n            title=\"Choose vis\"\n            values={VIS.map(e => ({ id: e, value: e }))}\n            onSelectCallback={(selected) => {\n              setVis(selected)\n            }}\n            // sync state\n            value={vis}\n          />}\n      </div>\n      <Button\n        kind={KIND.secondary} size={SIZE.compact}\n        onClick={() => {\n          if (column.length === 0 || vis.length === 0 || !column[0]) return;\n          setList([\n            ...list,\n            generateVIS(data, column[0].value, vis[0].value, plotStyle, noLimit, dark)\n          ])\n          // console.log(column[0].value, vis[0].value);\n        }}>Add</Button>\n      <div className=\"visArea\">\n        {!noAccordion ?\n          <Accordion\n            expanded={true}\n            onChange={({ expanded }) => console.log(expanded)}\n          >\n            {\n              list.map((plot, i) =>\n                <Panel key={'panel-' + i}>\n                  <Button\n                    kind={KIND.secondary} size={SIZE.compact}\n                    onClick={() => {\n                      setList(\n                        list.filter((e, j) => i !== j)\n                      )\n                    }}>X</Button>\n                  {plot}\n                </Panel>\n              )\n            }\n          </Accordion> :\n          <center>\n            {list.map((plot, i) =>\n              plot && \n              <div>\n                <Button\n                  kind={KIND.secondary} size={SIZE.compact}\n                  onClick={() => {\n                    setList(\n                      list.filter((e, j) => i !== j)\n                    )\n                  }}>X</Button>\n                {plot}\n              </div>)\n            }\n          </center>\n        }\n      </div>\n    </div >\n  )\n}","/*\nUtility Functions\n\nthanks https://github.com/realm/github-gantt/blob/master/utilities.js\n\n*/\nvar isString = function(x) {\n    return x !== null && x !== undefined && x.constructor === String\n}\n\nvar isNumber = function(x) {\n    return x !== null && x !== undefined && x.constructor === Number\n}\n\nvar isBoolean = function(x) {\n    return x !== null && x !== undefined && x.constructor === Boolean\n}\n\nvar isObject = function(x) {\n    return x !== null && x !== undefined && x.constructor === Object\n}\n\nvar isArray = function(x) {\n    return x !== null && x !== undefined && x.constructor === Array\n}\n\nvar isDate = function(d) {\n  if ( Object.prototype.toString.call(d) === \"[object Date]\" ) {\n    if ( isNaN( d.getTime() ) ) {\n      return false;\n    }\n    else {\n      return true;\n    }\n  }\n  else {\n    return false;\n  }\n}\n\n// var isRealmObject = function(x) {\n//     return x !== null && x !== undefined && x.constructor === Realm.Object\n// }\n\n// var isRealmList = function(x) {\n//     return x !== null && x !== undefined && x.constructor === Realm.List\n// }\n\nvar sanitizeFloat = function(number) {\n    if (isNumber(number)) {\n        return number;\n    }\n    else if (isString(number)) {\n        let n = parseFloat(number);\n        if (isNaN(n)) {\n          return null;\n        }\n        else {\n          return n;\n        }\n    }\n    else {\n        return null;\n    }\n}\n\nvar sanitizeInt = function(number) {\n    if (isNumber(number)) {\n        return number;\n    }\n    else if (isString(number)) {\n        return parseInt(number);\n    }\n    else {\n        return null;\n    }\n}\n\nvar sanitizeString = function(string) {\n    if (isString(string)) {\n        return string;\n    }\n    else if (isNumber(string)) {\n        return string.toString();\n    }\n    else {\n        return null;\n    }\n}\n\nvar sanitizeStringNonNull = function(string) {\n    if (isString(string)) {\n        return string;\n    }\n    else if (isNumber(string)) {\n        return string.toString();\n    }\n    else {\n        return \"\";\n    }\n}\n\nvar sanitizeBool = function(bool) {\n    if (isBoolean(bool)) {\n        return bool;\n    }\n    else if (isNumber(bool)) {\n        return Boolean(bool);\n    }\n    else {\n        return null;\n    }\n}\n\nfunction isEmptyOrSpaces(str){\n  return str === null || str.match(/^ *$/) !== null;\n}\n\nexports.isString = isString;\nexports.isNumber = isNumber;\nexports.isBoolean = isBoolean;\nexports.isObject = isObject;\nexports.isArray = isArray;\nexports.isDate = isDate;\n// exports.isRealmObject = isRealmObject;\n// exports.isRealmList = isRealmList;\nexports.sanitizeFloat = sanitizeFloat;\nexports.sanitizeInt = sanitizeInt;\nexports.sanitizeString = sanitizeString;\nexports.sanitizeStringNonNull = sanitizeStringNonNull;\nexports.sanitizeBool = sanitizeBool;\nexports.isEmptyOrSpaces = isEmptyOrSpaces;","module.exports = __webpack_public_path__ + \"static/media/notes.d652360a.md\";","import * as helpers from '@turf/helpers';\n\nimport { fetchData } from '../../utils';\nimport { DEV_URL, PRD_URL } from '../../Constants';\n\nconst URL = (process.env.NODE_ENV === 'development' ? DEV_URL : PRD_URL);\n\n  /**\n   * The logic here is simple even if the code is not:\n   * Unique object of all \"geography\" with corresponding code in data[1]\n   * \n   * Then using turfjs generate geojson features using data[0] (json) values\n   * and \"geography\" from the data[1].\n   * \n   * Then return the \"collection\"\n   */\n\nconst fetchSPENSER = (callback) => {\n  const fullURL = URL + '/api/spenser2';\n  fetchData(fullURL, (data, error) => {\n    console.log(data.length);\n    \n    if (!error && data[1]) {\n      console.log(JSON.parse(data[1]))\n      let collection = [];\n      const map_code_point = {}\n      JSON.parse(data[1]).features.forEach(f => {\n        map_code_point[f.properties.Area] =\n          f.geometry.coordinates\n      })\n      for (let index = 0; index < data[0].length; index++) {\n        let e = data[0][index]; //just too large for forEach.\n        const line = helpers.multiPolygon(\n          map_code_point[e.c] // in the data Area is c for code\n          , //properties next\n          { code:e.c, age:e.a, sex: e.s, ethnicity: e.e, year: e.y }\n        )        \n        collection.push(line)\n      }\n      collection = helpers.featureCollection(collection);\n      console.log(collection);\n      \n      callback && callback(collection)\n    } else {\n      console.log(error);\n    }\n  })\n}\n\nconst fetchQuant = (callback) => {\n  const fullURL = URL + '/api/quant';\n  // console.log(fullURL);\n\n  fetchData(fullURL, (data, error) => {\n    if (!error && data.length == 2) {\n      // console.log(JSON.parse(data[1]))\n      let collection = [];\n      const map_code_point = {}\n      JSON.parse(data[1]).features.forEach(f => {\n        map_code_point[f.properties.msoa11cd] =\n          f.geometry.coordinates\n      })\n      data[0].forEach(e => {\n        const line = helpers.lineString([\n          map_code_point[e.origin_msoacode],\n          map_code_point[e.destination_msoacode],\n        ], //properties next\n          { base: +(e.base), hs2: +(e.data) }\n        )\n        if (line.geometry.coordinates[0] && line.geometry.coordinates[1]) {\n          collection.push(line)\n        }\n      })\n      collection = helpers.featureCollection(collection);\n      // console.log(collection);\n      \n      callback && callback(collection, fullURL)\n    } else {\n      console.log(error);\n    }\n  })\n}\nexport {\n  fetchSPENSER,\n  fetchQuant\n}","import * as React from 'react';\nimport {\n  Card,\n  StyledBody,\n  StyledAction,\n} from 'baseui/card';\nimport { Button } from 'baseui/button';\nexport default (props) => {\n  if (!props) {\n    return null;\n  }\n  return (\n    <Card\n      // overrides={{ Root: { style: { width: props.width || '128px' } } }}\n      headerImage={props.image}\n      title={props.title}\n    >\n      <StyledBody>\n        {props.body}\n      </StyledBody>\n      <StyledAction>\n        <Button\n          onClick={() => typeof props.loadCallback === 'function' &&\n            props.loadCallback()}\n          overrides={{ BaseButton: { style: { width: '100%' } } }}>\n          {props.button}\n        </Button>\n      </StyledAction>\n    </Card>\n  );\n}","import * as React from 'react';\nimport { Button, KIND, SIZE } from 'baseui/button';\nimport {\n  Modal,\n  ModalHeader,\n  ModalBody,\n  ModalFooter,\n  ModalButton,\n  FocusOnce,\n} from 'baseui/modal';\nimport { FlexGrid, FlexGridItem } from 'baseui/flex-grid';\nimport { fetchQuant } from './Showcases/util_quant';\n\nimport File from './File'\nimport URL from './URL';\nimport Card from './Card';\nimport { DEV_URL, PRD_URL } from '../Constants';\n\n/**\n * The package is by mapbox. \n * \n * GDAL specs have been taken into consideration according to\n * package docs. The package creats lines and polygons from \n * correct csv files.\n * \n * There has been good effort into guessing the naming of\n * lat/longs, see \n * https://github.com/mapbox/csv2geojson/blob/gh-pages/index.js\n * \n * From the package\n * var latRegex = /(Lat)(itude)?/gi,\n *  lonRegex = /(L)(on|ng)(gitude)?/i;\n * \n */\nconst csv2geojson = require('csv2geojson');\n\nconst partURL = (process.env.NODE_ENV === 'development' ? DEV_URL : PRD_URL);\n\nexport default function (props) {\n  const [isOpen, setOpen] = React.useState(false);\n  const { urlCallback, toggleOpen } = props;\n\n  function cards() {\n    const info = {\n      REGIONS: {\n        image: \"images/spenser.png\",\n        body: \"England regions\",\n        api: partURL + '/api/covid19r'\n      },\n      WORLD : {\n        image: \"images/spenser.png\",\n        body: \"England regions\",\n        api: partURL + '/api/covid19w'\n      },\n    };\n    return (Object.keys(info).map(key =>\n      <FlexGridItem key={key} {...itemProps}>\n        {\n          <Card button=\"Load\" title={key} image={info[key]['image']}\n            body={info[key]['body']} loadCallback={() => {\n              const api = info[key]['api'];\n              // if api is function call and provied\n              // geojson returned in case of quant for instance.\n              api && typeof (api) === 'function' ?\n                api((geojson, apiURL) => urlCallback(undefined, geojson, apiURL)) :\n                typeof (urlCallback) === 'function'\n                && urlCallback(api)\n              setOpen(false);\n            }} />\n        }\n      </FlexGridItem>\n\n    ))\n  }\n\n\n  return (\n    <React.Fragment>\n      <Button\n        kind={KIND.secondary} size={SIZE.compact}\n        onClick={() => {\n          setOpen(s => !s); // or s === isOpen\n          typeof toggleOpen === 'function' && toggleOpen()\n        }}>Add data</Button>\n      <Modal\n        onClose={() => {\n          typeof (toggleOpen) === 'function' && toggleOpen()\n          setOpen(false);\n        }}\n        isOpen={isOpen}>\n        <ModalHeader>Your data remains on your browser. It is NOT uploaded anywhere.</ModalHeader>\n        <ModalBody>\n          <FocusOnce>\n            <URL urlCallback={(url) => {\n              setOpen(false);\n              typeof (urlCallback) === 'function'\n                && urlCallback(url)\n            }} />\n          </FocusOnce>\n          <File contentCallback={({ text, name }) => {\n            if (name && (name.split(\".\")[1].match(/geo/) //test.json\n              || name.split(\".\")[1].match(/json/))) {\n              try {\n                const json = JSON.parse(text);\n                typeof (urlCallback) === 'function'\n                  && urlCallback(null, json, name)\n                setOpen(false);\n              } catch (e) {\n                console.log(e);\n              }\n            } else {\n              // err has any parsing errors\n              csv2geojson.csv2geojson(text, (err, data) => {\n                if (!err) {\n                  typeof (urlCallback) === 'function'\n                    && urlCallback(null, data, name)\n                }\n              });\n            }\n          }} />\n          <FlexGrid\n            flexGridColumnCount={3}\n            flexGridColumnGap=\"scale800\"\n            flexGridRowGap=\"scale800\"\n          >\n            {cards()}\n          </FlexGrid>\n        </ModalBody>\n        <ModalFooter>\n          <ModalButton onClick={() => {\n            setOpen(false);\n            typeof (toggleOpen) === 'function' && toggleOpen();\n          }}>Close</ModalButton>\n        </ModalFooter>\n      </Modal>\n    </React.Fragment >\n  );\n}\n\nconst itemProps = {\n  // backgroundColor: 'mono300',\n  // height: 'scale1000',\n  display: 'flex',\n  alignItems: 'center',\n  justifyContent: 'center',\n};","import React from 'react';\nimport { MenuItem, DropdownButton } from 'react-bootstrap';\n\nimport { humanize } from '../utils';\n\nexport default class RBDropDown extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      title: props.hasOwnProperty('title') ? props.title : \"No Title\",\n      menuitems: props.hasOwnProperty('menuitems') ? props.menuitems : []\n    }\n    this._generateMenuItems = this._generateMenuItems.bind(this);\n  }\n\n  _generateMenuItems(menuitems) {\n    const isArray = menuitems && typeof (menuitems[0]) !== 'string';\n    return menuitems.map((entry, i) => {\n      let key, value;\n      if (isArray) {\n        key = Object.keys(entry)[0];\n        value = Object.values(entry)[0];\n      }\n      if ((!isArray && entry === \"\") ||\n        (isArray && key === \"\" && value === \"\")) {\n        return (<MenuItem\n          className=\"mi-class\" key={i} divider />);\n      }\n      else {\n        return (<MenuItem\n          className=\"mi-class\" key={i} eventKey={entry // the object\n          }>\n          {humanize(isArray ? value : entry)}\n        </MenuItem>);\n      }\n    });\n  }\n\n  static getDerivedStateFromProps(props, state) {\n    if (props.hasOwnProperty('title') && props.title !== state.title) {\n      return {\n        title: props.title\n      }\n    }\n    if (props.hasOwnProperty('menuitems') && props.menuitems.length !== state.menuitems.length) {\n      return {\n        menuitems: props.menuitems\n      }\n    }\n    return null\n  }\n\n  render() {\n    const { title, menuitems } = this.state;\n    const { size, classNames } = this.props;\n    const keyIsArray = menuitems && typeof (menuitems[0]) !== 'string';\n\n    // console.log(title);\n    if (!menuitems || menuitems.length === 0) {\n      return (null)\n    }\n\n    return (\n      <DropdownButton\n        style={{ width: '100%' }}\n        title={title}\n        className={typeof (classNames) === 'object'\n          && classNames.length > 0 ? classNames.join(\" \") : classNames}\n        id={typeof (size) === 'string' ? size : \"dropdown-size-medium\"}\n        onSelect={(event) => {\n          //update title\n          this.setState({\n            title: keyIsArray ? Object.values(event)[0] : event\n          })\n          if (typeof (this.props.onSelectCallback) === 'function') {\n            this.props.onSelectCallback(keyIsArray ? Object.values(event)[0] : event)\n          }\n          //die gracefully\n        }}>\n        {\n          this._generateMenuItems(menuitems)\n        }\n      </DropdownButton>\n    )\n  }\n}\n","import React from 'react';\nimport RBDropDown from './RBDropdownComponent';\n\nexport default class MapboxBaseLayers extends React.Component {\n    constructor(props) {\n        super(props)\n        this.state = {\n            bases: [\n                'dark',\n                'basic',\n                'streets',\n                'bright',\n                'light',\n                'satellite',\n                'No map'\n            ],\n            selected: 'dark'\n        }\n    }\n\n    render() { \n        const {selected, bases} = this.state;\n        const {onSelectCallback} = this.props;\n        // console.log(selected);\n        \n        return(\n            <RBDropDown\n                title={selected === 'dark' ? \"Default(dark)\" : selected}\n                menuitems={bases}\n                onSelectCallback= {(selected) => {\n                    this.setState({selected});\n                    typeof(onSelectCallback) === 'function' &&\n                    onSelectCallback(selected)\n                }}\n            />\n        )\n    }\n}","import React, { Component } from 'react';\n\n// react bootstrap\nimport { Alert } from 'react-bootstrap';\n\n// local\n\nclass ToastAlert extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      timeDuration: false\n    }\n  }\n\n  // lifeCycles\n  //-----------------------------------------------\n  componentWillUnmount() {\n    if (this.dismissTimeoutId) clearTimeout(this.dismissTimeoutId)\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (!nextProps.alert) return;\n    const oldId = this.props.alert;\n    const newId = nextProps.alert;\n    if (oldId !== newId) {\n      const { time } = nextProps.alert;\n      this.setState({\n        timeDuration: Boolean(alert)\n      },\n        () => {\n          this.dismissTimeout = setTimeout(() => this.setState({ timeDuration: false }),\n            time || 3000)\n        });\n    }\n  }\n\n  // local methods\n\n  // render\n  render() {\n    const { alert } = this.props;\n    const { timeDuration } = this.state;\n\n    if (!timeDuration || !alert || !alert.content)\n      return null;\n\n    else {\n      return (\n        <Alert style={{\n          border: 'none',\n          background: '#f8d7da',\n          color: '#721c24',\n          textAlign: 'center'\n        }} variant={\"danger\"} >\n          {alert.content}\n        </Alert>\n      )\n\n    }\n  }\n}\nexport default ToastAlert;\n","import React from 'react';\nimport { colorRangeNames} from '../utils';\n\nexport default function ColorPicker(props) {\n  const { colourCallback } = props;\n  return (\n    <div className=\"color-picker-container\">\n      <p>Color range:</p>\n      {\n        colorRangeNames.map((each, i) => {\n            return (\n              <div\n                key={each}\n                style={{\n                  backgroundColor: i === 0 ? 'red' :\n                    i === 1 ? 'blue' : i === 2 ? 'green' :\n                      i === 3 ? 'orange' : i === 4 ? 'brown' : 'yellow'\n                }}\n                className=\"color-box\"\n                onClick={() => {                  \n                  typeof colourCallback === 'function' &&\n                    colourCallback(each)\n                }}/>\n            )\n          })\n      }\n    </div>\n  )\n}","import * as React from 'react';\nimport { Button, KIND, SIZE } from 'baseui/button';\nimport {\n  Modal,\n  ModalHeader,\n  ModalBody,\n  ModalFooter,\n} from 'baseui/modal';\n\nexport default (props) => {\n  const [open, setOpen] = React.useState(false);\n  const { toggleOpen, title, component, button } = props;\n\n  return (\n    <React.Fragment>\n      <i\n        style={{\n          margin: 5,\n          cursor: 'pointer',\n          fontSize: '1.5em'\n        }}\n        onClick={() => {\n          typeof toggleOpen === 'function' && toggleOpen();\n          setOpen(true);\n        }}\n        className={button || \"fa fa-table\"}></i>\n      <Modal size=\"80%\"\n        onClose={() => {\n          typeof (toggleOpen) === 'function' && toggleOpen()\n          setOpen(false);\n        }} isOpen={open}>\n        <ModalHeader>{title}</ModalHeader>\n        <ModalBody>\n          {component}\n        </ModalBody>\n        <ModalFooter>\n          <Button\n            kind={KIND.secondary} size={SIZE.compact}\n            onClick={() => {\n              setOpen(false);\n              typeof (toggleOpen) === 'function' && toggleOpen();\n            }}>Okay</Button>\n        </ModalFooter>\n      </Modal>\n    </React.Fragment>\n  );\n};","import React, { useState } from 'react';\nimport {\n  XYPlot, XAxis, YAxis, LineSeries,\n  Crosshair, DiscreteColorLegend\n} from 'react-vis';\nimport { format } from 'd3-format';\n\nimport { shortenName } from '../../utils';\n\nconst W = 250;\n\n/**\n * React Hook to generate a multi line plot. Requires: \n * multi line data {data: [[{x:v,y:v},],[]]} object arrays and\n * maximum of 10 lines.\n * \n * Note: options.legend must match order of options.data multi\n * dimensional array.\n * TODO: consider {data: {legend1: array, legend2: array}}\n * \n * @param {Object} options \n */\nexport default function MultiLinePlot(options) {\n  const [hint, setHint] = useState();\n\n  if (!Array.isArray(options.data) ||\n    options.data.length > 10) return null;\n\n  const limit = 10;\n\n  const { plotStyle, title, noXAxis, noYAxis,\n    onValueClick, data, legend } = options;\n\n  return options.data && options.data.length > 1 &&\n    // https://github.com/uber/react-vis/issues/584#issuecomment-401693372\n    <div className=\"unselectable\" style={{ position: 'relative', color: '#fff' }}>\n      {!options.noLimit &&\n        options.data && options.data.length > limit &&\n        <h4>Plotting first {limit} values:</h4>}\n      {noYAxis && title &&\n        <h4>{title}</h4>\n      }\n      <XYPlot xType=\"ordinal\"\n        margin={{ bottom: (plotStyle && plotStyle.marginBottom) || 40 }} // default is 40\n        animation={{ duration: 1 }}\n        height={(plotStyle && plotStyle.height) || W}\n        width={(plotStyle && plotStyle.width) || W}\n        onMouseLeave={() => { setHint(false) }}\n      >\n        {!noXAxis && // if provided dont\n          <XAxis\n            tickSize={0}\n            tickFormat={v => shortenName(v, 10)}\n            position=\"right\" tickLabelAngle={-65} style={{\n              line: { strokeWidth: 0 },\n              text: { fill: options.dark ? '#fff' : '#000' } //, fontWeight: plotStyle && plotStyle.fontWeight || 400 }\n            }} />}\n        {!noYAxis && // if provided dont\n          <YAxis\n            tickSize={0}\n            tickLabelAngle={-45} tickFormat={v => format(\".2s\")(v)} style={{\n              line: { strokeWidth: 0 },\n              title: { fill: options.dark ? '#fff' : '#000' },\n              text: { fill: options.dark ? '#fff' : '#000' } //, fontWeight: plotStyle && plotStyle.fontWeight || 400 }\n            }} position=\"start\" title={title} />\n        }\n        {data.map((line, i) =>\n          <LineSeries\n            key={\"line-\" + i}\n            onValueClick={onValueClick}\n            onNearestX={(_, { index }) => {\n              setHint(data.map(d => d[index]))\n            }}\n            style={{ fill: 'none' }}\n            data={line} />)}\n        {hint && <Crosshair\n          values={hint}\n          className={'test-class-name'}\n        />}\n      </XYPlot>\n      <DiscreteColorLegend\n        orientation=\"horizontal\" width={W}\n        items={legend} />\n    </div>;\n}","import React, { useState, useEffect } from 'react';\nimport { ascending, quantile } from 'd3-array';\n\nimport { isNumber } from '../../JSUtils';\nimport { convertRange } from '../../utils';\n\nimport './style.css'\n\nexport default (props) => {\n  const { data, lineAttrs, plotStyle, dark } = props;\n  if (!data || !Array.isArray(data) || data.length === 0) return null;\n  let isNumeric = true;\n  data.forEach(e => {\n    if (!isNumber(e)) {\n      isNumeric = false\n    }\n  });\n  if (!isNumeric) return null;\n  // proceed\n  const W = 100, H = (plotStyle && plotStyle.height) || 100, limit = 5;\n  // Compute summary statistics used for the box:\n  let data_sorted = data.sort(ascending)\n  data_sorted = data_sorted.map(e => convertRange(e, {\n    oldMax: data_sorted[data_sorted.length - 1],\n    oldMin: data_sorted[0],\n    newMax: W - 5, newMin: 5\n  }))\n\n  let q1 = +quantile(data_sorted, .25).toFixed(2)\n  let median = +quantile(data_sorted, .5).toFixed(2)\n  let q3 = +quantile(data_sorted, .75).toFixed(2)\n  let interQuantileRange = +(q3 - q1).toFixed(2)\n  // https://www.purplemath.com/modules/boxwhisk3.htm\n  let min = +(q1 - 1.5 * interQuantileRange).toFixed(2)\n  let max = +(q1 + 1.5 * interQuantileRange).toFixed(2)\n  // console.log(min, max, q1, q3, interQuantileRange);\n  const outliers = data_sorted.filter(e => e > max || e < min)\n  // console.log(outliers);\n\n  // rescale variables according to screensize\n  const Y = 5, yHeight = 60, yMiddle = Y + (yHeight / 2);\n\n  // show less on scale depending on settings\n  let scale = data;\n  if (data.length > limit) {\n    scale = [];\n    data.forEach((item, idx) => {\n      let d = Math.floor(data.length / limit);\n      if (d === 1) d = 2;\n      if ((idx % d) === 0) {\n        let l = Math.floor(item);\n        if (l > 1000) l = (l / 1000).toFixed(1) + \"k\"\n        scale.push(l)\n      }\n    })\n  }\n  // console.log(scale);\n\n  return (\n    <div style={{\n      width: '100%',\n      height: H,\n      position: 'relative',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center'\n    }}>\n      <div style={{\n        width: '100%',\n        height: '100%',\n        maxWidth: '600px',\n      }}>\n        <svg width='100%' height='100%'>\n          <g style={{\n            stroke: (plotStyle && plotStyle.lineColor) || 'rgb(18, 147, 154)'\n          }}>\n            <line\n              x1={min + \"%\"}\n              x2={q1 + \"%\"}\n              y1={yMiddle + \"%\"}\n              y2={yMiddle + \"%\"}\n              {...lineAttrs}\n            />\n            {/* bottom line */}\n            <line\n              style={{ strokeWidth: 1 }}\n              x1={min + \"%\"} x2={min + \"%\"} y1={Y + \"%\"}\n              y2={(Y + yHeight) + \"%\"} {...lineAttrs} />\n            <line\n              x1={max + \"%\"}\n              x2={q3 + \"%\"}\n              y1={yMiddle + \"%\"}\n              y2={yMiddle + \"%\"}\n              {...lineAttrs}\n            />\n            {/* top line */}\n            <line\n              style={{ strokeWidth: 1 }}\n              x1={max + \"%\"} x2={max + \"%\"} y1={Y + \"%\"}\n              y2={(Y + yHeight) + \"%\"} {...lineAttrs} />\n            <rect\n              x={q1 + \"%\"}\n              width={interQuantileRange + \"%\"}\n              y={Y + \"%\"}\n              height={yHeight + \"%\"}\n              fill={(plotStyle && plotStyle.fillColor) || 'rgb(18, 147, 154)'}\n              stroke={(dark ? \"white\" : \"black\") + \" 0.5px\"}\n            />\n            {/* median */}\n            <line\n              style={{ stroke: dark ? 'white' : 'black', strokeWidth: 1 }}\n              x1={median + \"%\"} x2={median + \"%\"}\n              y1={Y + \"%\"} y2={(Y + yHeight) + \"%\"} {...lineAttrs} />\n            {/* outliers */}\n            {\n              outliers.map((e, i) => <circle\n                key={e + \"-\" + i}\n                r=\"5\"\n                // avoid placing first on top/bottom line\n                cx={(e > max ? e + 2 : e - 2) + \"%\"}\n                cy={yMiddle + \"%\"}\n                style={{\n                  fill: 'none',\n                  opacity: 1\n                }}></circle>)\n            }\n            {/* axis */}\n            {/* <line \n            x1={'5%'} y1=\"80%\" x2={(W - 10) + \"%\"} y2={'80%'} /> */}\n            {\n              scale && scale.map((v, i) => {\n                const x1 = i * (W / scale.length);\n                return (\n                  <g key={x1 + \"-\" + i}>\n                    {/* <line \n                    style={{ stroke: 'white', strokeWidth: 0.5 }}\n                  x1={x1 + \"%\"} y1={\"80%\"} x2={x1} y2={'82%'} /> */}\n                    <text fill={dark ? 'white' : 'black'} x={(x1 + 2) + \"%\"} y={\"85%\"}\n                      // transform=\"rotate(10)\" style={{textAnchor:\"end\"}}\n                      className=\"d3-axis-labels\">{v}</text>\n                  </g>\n                )\n              })\n            }\n          </g>\n        </svg>\n      </div>\n    </div>\n  )\n}","import React from 'react';\nimport {\n  Tabs, Tab, FormGroup, InputGroup,\n  FormControl, Glyphicon, Checkbox\n} from 'react-bootstrap';\nimport { Button, KIND, SIZE } from 'baseui/button';\n\nimport './DeckSidebar.css';\nimport DataInput from '../DataInput';\nimport MapboxBaseLayers from '../MapboxBaseLayers';\nimport {\n  xyObjectByProperty, percentDiv,\n  searchNominatom,\n  humanize, generateLegend, sortNumericArray\n} from '../../utils';\nimport { LineSeries, VerticalBarSeries } from 'react-vis';\nimport Variables from '../Variables';\nimport RBAlert from '../RBAlert';\nimport { propertyCount } from '../../geojsonutils';\nimport {DEV_URL, PRD_URL, LAYERSTYLES} from '../../Constants';\nimport ColorPicker from '../ColourPicker';\nimport Modal from '../Modal';\nimport DataTable from '../Table';\n\nimport { yearSlider } from '../Showcases/Widgets';\nimport { popPyramid, crashes_plot_data } from '../Showcases/Plots';\nimport SeriesPlot from '../Showcases/SeriesPlot';\nimport { isEmptyOrSpaces, isNumber } from '../../JSUtils';\nimport MultiSelect from '../MultiSelect';\nimport AddVIS from '../AddVIS';\nimport MultiLinePlot from '../Showcases/MultiLinePlot';\nimport Boxplot from '../Boxplot/Boxplot';\n// import GenerateUI from '../UI';\n\nconst URL = (process.env.NODE_ENV === 'development' ? DEV_URL : PRD_URL);\n\nexport default class DeckSidebar extends React.Component {\n  constructor(props) {\n    super(props)\n    this.state = {\n      radius: 100,\n      elevation: 4,\n      // must match the order in plumber.R\n      all_road_types: [\"Dual carriageway\",\n        \"Single carriageway\", \"Roundabout\", \"Unknown\",\n        \"Slip road\", \"One way street\"],\n      year: \"\",\n      reset: false,\n      multiVarSelect: {},\n      barChartVariable: \"road_type\",\n      datasetName: props.datasetName\n    }\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    const { data, alert, loading } = this.props;\n    const { elevation, radius, reset,\n      barChartVariable } = this.state;\n    // avoid rerender as directly operating on document.get* \n    // does not look neat. Keeping it React way.\n    if (reset !== nextState.reset ||\n      elevation !== nextState.elevation ||\n      radius !== nextState.radius ||\n      alert !== nextProps.alert ||\n      loading !== nextProps.loading ||\n      barChartVariable !== nextState.barChartVariable) return true;\n    //TODO:  a more functional way is needed        \n    if (data && nextProps && nextProps.data &&\n      data.length === nextProps.data.length) {\n      return false\n    }\n    return true;\n  }\n\n  /**\n   * Render the sidebar empty if no data is loaded.\n   * Partly because we like to load from a URL.\n   */\n  render() {\n    const { elevation,\n      radius, all_road_types, year,\n      subsetBoundsChange, multiVarSelect, barChartVariable } = this.state;\n    const { onChangeRadius, onChangeElevation,\n      onSelectCallback, data, colourCallback, layerStyle,\n      toggleSubsetBoundsChange, urlCallback, alert,\n      onlocationChange, column, dark, toggleOpen, toggleHexPlot } = this.props;\n    let plot_data = [];\n    let plot_data_multi = [[], []];\n    const notEmpty = data && data.length > 1;\n    plot_data = crashes_plot_data(notEmpty, data, plot_data, plot_data_multi);\n    const severity_data = propertyCount(data, \"accident_severity\");    \n    let columnDomain = [];\n    let columnData = notEmpty ?\n      xyObjectByProperty(data, column || barChartVariable) : [];\n    const geomType = notEmpty && data[0].geometry.type.toLowerCase();\n    // console.log(geomType);\n    if(notEmpty && column && (geomType === 'polygon' ||\n    geomType === 'multipolygon' || \"linestring\") &&\n      isNumber(data[0].properties[column])) {\n        // we dont need to use generateDomain(data, column)\n        // columnData already has this in its x'es\n        columnDomain = columnData.map(e => e.x);\n        // we will just sort it        \n        columnDomain = sortNumericArray(columnDomain);\n        // console.log(columnDomain);\n        \n        this.props.showLegend(\n          generateLegend(\n            {domain: columnDomain, \n              title: humanize(column)\n            }\n          )\n        );\n    }\n\n    const columnPlot = {\n      data: columnData,\n      opacity: 1,\n      stroke: 'rgb(72, 87, 104)',\n      fill: 'rgb(18, 147, 154)',\n    }\n\n    const resetState = (urlOrName) => {      \n      this.setState({\n        reset: true,\n        year: \"\",\n        multiVarSelect: {},\n        barChartVariable: \"road_type\",\n        datasetName: urlOrName || this.state.datasetName\n      })\n    }\n    return (\n      <>\n        <div\n          style={{\n            color: dark ? \"white\" : \"black\",\n            background: dark ? \"#242730\" : \"white\"\n          }}\n          className=\"side-panel\">\n          <RBAlert alert={alert} />\n          <div \n              style={{\n                background: dark ? '#29323C' : '#eee'\n              }}\n              className=\"side-pane-header\">\n            {\n              data && data.length && data[0].properties.TotalCases ?\n              <h2>\n                {this.props.TotalCases + \" cases\"}\n              </h2>\n              :\n              <h2>{data && data.length ?\n                data.length + \" row\" + (data.length > 1 ? \"s\" : \"\") + \".\"\n                : \"Nothing to show\"}\n              </h2>\n            }\n            dataset: {this.props.datasetName}\n          </div>\n          <div>\n            <DataInput\n              toggleOpen={() => typeof toggleOpen === 'function' && toggleOpen()}\n              urlCallback={(url, geojson, name) => {\n                resetState(url || name);\n                typeof (urlCallback) === 'function'\n                  && urlCallback(url, geojson);\n                typeof (toggleOpen) === 'function' && toggleOpen()\n              }\n              } />\n            <Modal\n              toggleOpen={() => typeof toggleOpen === 'function' && toggleOpen()}\n              component={<DataTable data={data} />} />\n            {\n              this.state.reset &&\n              <Button\n                kind={KIND.secondary} size={SIZE.compact}\n                onClick={() => {\n                  resetState();\n                  typeof (urlCallback) === 'function'\n                    && urlCallback(URL + \"/api/covid19\");\n                  typeof (this.props.showLegend) === 'function' &&\n                  this.props.showLegend(false);\n                }}>Reset</Button>\n            }\n          </div>\n          <div className=\"side-panel-body\">\n            <div className=\"side-panel-body-content\">\n                {/* <DateSlider data={yy} multiVarSelect={multiVarSelect}\n                  onSelectCallback={(changes) => console.log(changes)} \n                  callback={(changes) => console.log(changes)}/> */}\n              {/* range of two values slider is not native html */\n                yearSlider({data, year, multiVarSelect,\n                  // for callback we get { year: \"\",multiVarSelect }\n                  onSelectCallback, callback: (changes) => this.setState(changes)})\n              }\n              {\n                //only if there is such a property\n                data && data.length > 1 && data[0].properties['road_type'] &&\n                <MultiSelect\n                  title={humanize('road_type')}\n                  filter='road_type' // showcase/hardcode section\n                  multiVarSelect={multiVarSelect}\n                  // showcase/hardcode section all_road_types\n                  values={all_road_types.map(e => ({ id: e, value: e }))}\n                  onSelectCallback={(filter) => {\n                    onSelectCallback && onSelectCallback(filter);\n                    this.setState({\n                      multiVarSelect: filter.selected || {} // not \"\"\n                    })\n                  }}\n                  // sync state\n                  value={multiVarSelect && multiVarSelect['road_type'] &&\n                    Array.from(multiVarSelect['road_type'])\n                      .map(e => ({ id: e, value: e }))}\n                />\n              }\n              <br />\n              {/* TODO: generate this declaritively too */}\n              {\n                severity_data && severity_data.map(each =>\n                  percentDiv(each.x, 100 * each.y / data.length, () => {\n                    if (multiVarSelect && multiVarSelect['accident_severity'] &&\n                      multiVarSelect['accident_severity'].has(each.x)) {\n                      delete multiVarSelect['accident_severity'];\n                    } else {\n                      multiVarSelect['accident_severity'] = new Set([each.x]);\n                      this.setState({ multiVarSelect })\n                    }\n                    onSelectCallback &&\n                      onSelectCallback(Object.keys(multiVarSelect).length === 0 ?\n                        { what: '' } : { what: 'multi', selected: multiVarSelect })\n                  }, dark))\n              }\n              <hr style={{ clear: 'both' }} />\n              {columnDomain.length > 1 &&\n              <Boxplot dark={dark} data={columnDomain}/>}\n\n              <Tabs defaultActiveKey={\"1\"} id=\"main-tabs\">\n                <Tab eventKey=\"1\" title={\n                  <i style={{ fontSize: '2rem' }}\n                    className=\"fa fa-info\" />\n                }>\n                  {/* pick a column and vis type */}\n                  <AddVIS data={data} dark={dark} />\n                  {/* distribution example */}\n                  {notEmpty &&\n                    data[0].properties.hasOwnProperty(['age_of_casualty']) &&\n                    <SeriesPlot\n                      dark={dark}\n                      title=\"Casualty age\" noYAxis={true}\n                      plotStyle={{ height: 100 }} noLimit={true}\n                      type={LineSeries}\n                      // sorts the results if x is a number\n                      // TODO: do we want to do this?\n                      // also think about sorting according to y\n                      data={xyObjectByProperty(data, \"age_of_casualty\")}\n                    />\n                  }\n                  {notEmpty && plot_data_multi[0].length > 0 &&\n                    <MultiLinePlot\n                      dark={dark}\n                      data={\n                        [...plot_data_multi, plot_data]\n                      } legend={[\"Male\", \"Female\", \"Total\"]}\n                      title=\"Crashes\" noYAxis={true}\n                      plotStyle={{ height: 100, marginBottom: 50 }}\n                    />\n                  }\n                  {\n                    notEmpty &&\n                    Object.keys(data[0].properties)\n                      .filter(p => !isEmptyOrSpaces(p)).length > 0 &&\n                    <>\n                      <h6>Column for layer:</h6>\n                      <MultiSelect\n                        title=\"Choose Column\"\n                        single={true}\n                        values={\n                          Object.keys(data[0].properties).map(e =>\n                            ({ id: humanize(e), value: e }))\n                        }\n                        onSelectCallback={(selected) => {\n                          // array of seingle {id: , value: } object\n                          const newBarChartVar = (selected && selected[0]) ?\n                            selected[0].value : barChartVariable;\n                          this.setState({\n                            barChartVariable: newBarChartVar\n                          });\n                          typeof onSelectCallback === 'function' &&\n                            onSelectCallback({\n                              what: 'column', selected: newBarChartVar\n                            });\n                        }}\n                      />\n                    </>\n                  }\n                  {/* TODO: example of generating vis based on column\n                  cloudl now be deleted. */}\n                  {<SeriesPlot\n                    dark={dark}\n                    data={columnPlot.data}\n                    type={VerticalBarSeries}\n                    onValueClick={(datapoint) => {\n                      // convert back to string\n                      multiVarSelect[column ||\n                        barChartVariable] = new Set([datapoint.x + \"\"]);\n                      this.setState({ multiVarSelect })\n                      onSelectCallback &&\n                        onSelectCallback({ what: 'multi', selected: multiVarSelect })\n                    }}\n                    onDragSelected={(datapoints) => {\n                      multiVarSelect[column ||\n                        barChartVariable] = new Set(datapoints.map(e => e + \"\"));\n                      this.setState({ multiVarSelect })\n                      onSelectCallback &&\n                        onSelectCallback({ what: 'multi', selected: multiVarSelect })\n                    }}\n                    plotStyle={{ marginBottom: 100 }} noYAxis={true}\n\n                  />}\n                  {popPyramid({ data, dark: dark })}\n                </Tab>\n                <Tab eventKey=\"2\" title={\n                  <i style={{ fontSize: '2rem' }}\n                    className=\"fa fa-sliders\" />\n                }>\n                  {notEmpty &&\n                    <div>\n                      <ColorPicker colourCallback={(color) =>\n                          typeof colourCallback === 'function' &&\n                          colourCallback(color)} />\n                      <input\n                        type=\"range\"\n                        id=\"radius\"\n                        min={50}\n                        max={1000}\n                        step={50}\n                        value={radius}\n                        onChange={(e) => {\n                          this.setState({\n                            radius: e.target.value,\n                          })\n                          typeof (onChangeRadius) === 'function' &&\n                            onChangeRadius(e.target.value)\n                        }}\n                      />\n                      <h5>Radius: {radius}.</h5>\n                      <input\n                        type=\"range\"\n                        id=\"elevation\"\n                        min={2}\n                        max={8}\n                        step={2}\n                        value={elevation}\n                        onChange={(e) => {\n                          this.setState({\n                            elevation: e.target.value\n                          })\n                          typeof (onChangeElevation) === 'function' &&\n                            onChangeElevation(e.target.value)\n                        }}\n                      />\n                      <h5>Elevation: {elevation}.</h5>\n                    </div>\n                    }\n                  {notEmpty &&\n                    <>\n                      <h6>Deck Layer:</h6>\n                      <MultiSelect\n                        title=\"Choose Layer\"\n                        single={true}\n                        values={\n                          LAYERSTYLES.map(e =>\n                            ({ id: humanize(e), value: e }))\n                        }\n                        onSelectCallback={(selected) => {\n                          // array of seingle {id: , value: } object\n                          const newBarChartVar = (selected && selected[0]) ?\n                            selected[0].value : barChartVariable;\n                          this.setState({\n                            barChartVariable: newBarChartVar\n                          });\n                          typeof onSelectCallback === 'function' &&\n                            onSelectCallback({\n                              what: 'layerStyle', selected: newBarChartVar\n                            });\n                        }}\n                      />\n                    </>\n                  }\n                  Map Styles\n                  <br />\n                  <MapboxBaseLayers\n                    onSelectCallback={(selected) =>\n                      onSelectCallback &&\n                      onSelectCallback({\n                        selected: selected,\n                        what: 'mapstyle'\n                      })\n                    }\n                  />\n                  <Checkbox\n                    onChange={() => toggleHexPlot && toggleHexPlot()}\n                  >Hex Plot</Checkbox>\n                  <Checkbox\n                    onChange={() => {\n                      this.setState({ subsetBoundsChange: !subsetBoundsChange })\n                      if (toggleSubsetBoundsChange && typeof (toggleSubsetBoundsChange) === 'function') {\n                        toggleSubsetBoundsChange(!subsetBoundsChange) //starts with false\n                      }\n                    }}\n                  >Subset by map boundary</Checkbox>\n                  \n                </Tab>\n                {/* <Tab eventKey=\"3\" title={\n                  <i style={{ fontSize: '2rem' }}\n                    className=\"fa fa-tasks\" />\n                }>\n                  Tab 3\n                </Tab> */}\n                <Tab eventKey=\"3\" title={\n                  <i style={{ fontSize: '2rem' }}\n                    className=\"fa fa-filter\" />\n                }>\n                  {\n                    data && data.length > 0 &&\n                    <Variables\n                      dark={dark}\n                      multiVarSelect={multiVarSelect}\n                      onSelectCallback={(mvs) => {\n                        typeof (onSelectCallback) === 'function' &&\n                          onSelectCallback(\n                            Object.keys(mvs).length === 0 ?\n                              { what: '' } : { what: 'multi', selected: mvs })\n                        this.setState({ multiVarSelect: mvs })\n                      }}\n                      data={data} />\n                  }\n                </Tab>\n              </Tabs>\n            </div>\n            <div className=\"space\"></div>\n            <form className=\"search-form\" onSubmit={(e) => {\n              e.preventDefault();\n              // console.log(this.state.search);\n              searchNominatom(this.state.search, (json) => {\n                // console.log(json && json.length > 0 && json[0].boundingbox);\n                let bbox = json && json.length > 0 && json[0].boundingbox;\n                bbox = bbox && bbox.map(num => +(num))\n                typeof onlocationChange === 'function' && bbox &&\n                  onlocationChange({\n                    bbox: bbox,\n                    lon: +(json[0].lon), lat: +(json[0].lat)\n                  })\n              })\n            }}>\n              <FormGroup>\n                <InputGroup>\n                  <FormControl\n                    style={{\n                      background: dark ? '#242730' : 'white',\n                      color: dark ? 'white' : 'black'\n                    }}\n                    onChange={(e) => this.setState({ search: e.target.value })}\n                    placeholder=\"fly to...\" type=\"text\" />\n                  <InputGroup.Addon\n                    style={{\n                      background: dark ? '#242730' : 'white',\n                      color: dark ? 'white' : 'black'\n                    }}>\n                    <Glyphicon glyph=\"search\" />\n                  </InputGroup.Addon>\n                </InputGroup>\n              </FormGroup>\n            </form>\n          </div>\n        </div>\n      </>\n    )\n  }\n}\n\n","import React from 'react';\nimport {\n  XYPlot, XAxis, YAxis, HorizontalRectSeries\n} from 'react-vis';\nimport { format } from 'd3-format';\n\nimport { propertyCountByProperty } from '../../geojsonutils';\nimport { xyObjectByProperty } from '../../utils';\n\nconst W = 250;\n\n/**\n * Generate a population pyramid using Rect-vis series objects.\n * Series objects are formatted as {left,right,bottom, top}\n * \n * Currently semi hardcoded for sex_of_casualty and date from\n * STATS19 dataset\n * \n * @param {Object} options \n */\nconst popPyramid = (options) => {\n  if (!options || !options.data || !options.data[0] ||\n    !options.data[0].properties.date ||\n    !options.data[0].properties.sex_of_casualty) return;\n  const mf = propertyCountByProperty(options.data, \"sex_of_casualty\",\n    [\"Male\", \"Female\"], \"date\");\n  const mf_array_male = [];\n  const mf_array_female = [];\n  if (Object.keys(mf).length === 1) return;\n\n  mf && Object.keys(mf).forEach((y, i) => {\n    mf_array_male.push({\n      x: 0,\n      x0: +(mf[y].Male),\n      y: i === 0 ? 0 : i,\n      y0: i + 1,\n      color: \"#428BCA\"\n    })\n  })\n  mf && Object.keys(mf).forEach((y, i) => {\n    mf_array_female.push({\n      x: 0,\n      x0: -1 * (+(mf[y].Female)),\n      y: i === 0 ? 0 : i,\n      y0: i + 1\n    })\n  })\n  return (\n    <XYPlot\n      margin={{ left: options.margin || 60 }} // default is 40\n      height={options.plotStyle && options.plotStyle.height || W}\n      width={options.plotStyle && options.plotStyle.width || W} >\n      <HorizontalRectSeries\n        color='rgb(18, 147, 154)'\n        stroke='black'\n        data={mf_array_female} />\n      <HorizontalRectSeries\n        color='rgb(239, 93, 40)'\n        stroke='black'\n        data={mf_array_male} />\n\n      <YAxis\n        tickSize={0}\n        tickFormat={v => v === 0 ? 2009 : v - 2 + 2009}\n        style={{\n          line: { strokeWidth: 0 },\n          text: { fill: options.dark ? '#fff' : '#000', fontWeight: 400 }\n        }}\n      />\n      {/* left={(W / 2) - 10} */}\n      <XAxis\n        tickSize={0}\n        tickFormat={v => format(\".2s\")(v < 0 ? -1 * v : v)}\n        style={{\n          line: { strokeWidth: 0 },\n          text: { fill: options.dark ? '#fff' : '#000', fontWeight: 400 }\n        }}\n      />\n    </XYPlot>\n  )\n}\n\nfunction crashes_plot_data(notEmpty, data, plot_data, plot_data_multi) {\n  if (notEmpty) {\n    Object.keys(data[1].properties).forEach(each => {\n      if (each.match(/date|datetime|datestamp|timestamp/g) &&\n        typeof (data[1].properties[each]) === 'string' &&\n        data[1].properties[each].split(\"/\")[2]) { //date in 09/01/2019 HARDCODE\n        plot_data = xyObjectByProperty(data, \"date\");\n        const mf = propertyCountByProperty(data, \"sex_of_casualty\", plot_data.map(e => e.x), \"date\");\n        plot_data.length > 1 && // more than one years\n          Object.keys(mf)\n            //2009: {Male: 3295, Female: 2294}\n            .forEach(k => {\n              plot_data_multi[0]\n                .push({\n                  x: k,\n                  y: mf[k].Male\n                });\n              plot_data_multi[1]\n                .push({\n                  x: k,\n                  y: mf[k].Female\n                });\n            });\n      }\n    });\n  }\n  return plot_data;\n}\n\nexport {\n  crashes_plot_data,\n  popPyramid\n}","import React, { useState } from 'react';\nimport { Slider } from 'baseui/slider';\n\nimport GenerateUI from '../UI';\nimport { DateTime } from \"luxon\";\n\nconst DateSlider = (props) => {\n  const {data, multiVarSelect, onSelectCallback,\n    callback} = props;\n  const [value, setValue] = useState()\n\n  if(!data || data.length === 0) return null;\n  const s = Array.from(Array(data.length).keys()).slice(1,data.length-1)\n\n  return (\n    <>\n    <Slider\n      value={value || [s[0]]}\n      min={parseInt(s[0])}\n      max={parseInt(s[s.length - 1])}\n      step={1}\n      onChange={({ value }) => {\n        setValue(value);\n        // keep it the same in delete\n        multiVarSelect['date'] = new Set([data[value-1] + \"\"]);\n        typeof (callback) === 'function' &&\n        callback({\n          date: data[value-1] + \"\",\n          multiVarSelect\n        });\n        console.log(data[value-1], data);\n        typeof (onSelectCallback) === 'function' &&\n          onSelectCallback({ selected: multiVarSelect, what: 'multi' });\n      }}\n    />\n    {<h5>Dates(s): {value ? data[value-1] : data[0] + \"-\" + data[data.length - 1]}.\n        {value &&\n            <i style={{ fontSize: '2rem' }} className=\"fa fa-trash\"\n              onClick={() => {\n                // remove\n                setValue(null);\n                delete multiVarSelect.date\n                typeof (onSelectCallback) === 'function' &&\n                  onSelectCallback(Object.keys(multiVarSelect).length === 0 ?\n                    { what: '' } : { what: 'multi', selected: multiVarSelect });\n                typeof (callback) === 'function' &&\n                  callback({\n                  date: \"\",\n                  multiVarSelect\n                });\n              }} />}\n        </h5>}\n  </>)\n}\n\nconst yearSlider = (options) => {\n  const {data, year, multiVarSelect, onSelectCallback,\n    callback} = options;  \n  return data && data.length > 1 &&\n    (data[0].properties.date || data[0].properties['YEAR']) &&\n    (DateTime.fromFormat(data[0].properties.date + '', 'dd/MM/yyyy').isValid ||\n      DateTime.fromFormat(data[0].properties['YEAR'] + '', 'yyyy').isValid) &&\n    <GenerateUI\n      title={\n        // TODO: change min max labels dynamically\n        // so should all the values generated\n        <h5>Year(s): {year ? year : \"2009 - 2017\"}.\n        {year &&\n            <i style={{ fontSize: '2rem' }} className=\"fa fa-trash\"\n              onClick={() => {                         \n                multiVarSelect.date ? \n                delete multiVarSelect.date : delete multiVarSelect.YEAR;\n                typeof (onSelectCallback) === 'function' &&\n                  onSelectCallback(Object.keys(multiVarSelect).length === 0 ?\n                    { what: '' } : { what: 'multi', selected: multiVarSelect });\n                callback({\n                  year: \"\",\n                  multiVarSelect\n                });\n              }} />}\n        </h5>}\n      sublist={data[0].properties.date ?\n        Array.apply(null, { length: 9 }).map(Number.call, Number).map(d => d + 2009) :\n        Array.apply(null, { length: 31 }).map(Number.call, Number).map(d => d + 2020)}\n      suggested=\"slider\"\n      onChange={(value) => {\n        // the kye is one of `date` or `YEAR`\n        // keep it the same in delete\n        multiVarSelect[data[0].properties.date ?\n          'date' : 'YEAR'] = new Set([value + \"\"]);\n        callback({\n          year: value + \"\",\n          multiVarSelect\n        });\n        typeof (onSelectCallback) === 'function' &&\n          onSelectCallback({ selected: multiVarSelect, what: 'multi' });\n      }} />;\n}\n\nexport {\n  yearSlider,\n  DateSlider,\n}","import React, { Component } from 'react';\nimport { Slider } from 'baseui/slider';\nimport { XYPlot, XAxis, YAxis, HexbinSeries, Hint } from 'react-vis';\n\nexport default class HexHeatmap extends Component {\n  state = {\n    hoveredNode: null,\n    radius: 10,\n    offset: 0,\n  };\n  render() {\n    const { data, options } = this.props;\n    const { radius, hoveredNode } = this.state;\n    if(!data || !data.length) return null\n    return (\n      <div className=\"centered-and-flexed\" style={{color:'#fff'}}>\n        <Slider\n            value={[this.state.radius]}\n            min={5}\n            max={50}\n            step={5}\n            onChange={({ value }) => {\n              this.setState({ radius: value[0] });\n              // typeof (onChange) === 'function' && onChange(value[0])\n            }}\n          />\n          {\"Radius (pixels)\"}\n        <XYPlot\n          margin={{ left: 10, bottom: 10 }}\n          height={options &&\n            options.plotStyle && options.plotStyle.height || 350}\n          width={options &&\n            options.plotStyle && options.plotStyle.width || 350}\n          onMouseLeave={() => this.setState({ hoveredNode: null })}\n        >\n          <HexbinSeries\n            animation\n            className=\"hexbin-example\"\n            style={{\n              stroke: '#125C77',\n              strokeLinejoin: 'round'\n            }}\n            // onValueMouseOver={d => this.setState({ hoveredNode: d })}\n            colorRange={['orange', 'cyan']}\n            radius={radius}\n            data={data}\n          />\n          {options && !options.noXAxis && \n          <XAxis tickLabelAngle={-45} style={{\n            text: { fill: '#fff', fontWeight: 400 }\n          }} />}\n          {options && !options.noYAxis && \n          <YAxis tickLabelAngle={-45} style={{\n            text: { fill: '#fff', fontWeight: 400 }\n          }} />}\n          {/* {hoveredNode && (\n            <Hint\n              style={{ background: '#fff', position: 'relative' }}\n              xType=\"literal\"\n              yType=\"literal\"\n              getX={d => 50}\n              getY={d => 50}\n              value={{\n                x: hoveredNode.x,\n                y: hoveredNode.y,\n                value: hoveredNode.length\n              }}\n            />\n          )} */}\n        </XYPlot>\n      </div>\n    );\n  }\n}\n","import React, { useState, useEffect } from 'react';\nimport HexbinSeries from '../Showcases/HexbinSeries';\n\nimport { coordsAsXY } from '../../geojsonutils';\n\nexport default (props) => {\n  // const [value, setValue] = useState([]);\n  const [open, setOpen] = useState(props.isMobile === false);\n  useEffect(() => {\n    // if props.open change to false is\n    // the only time it should react to it\n    if (props.open === true) return;\n    setOpen(props.open);\n  }, [props.open])\n\n  const { data } = props;\n  const notEmpty = data && data.length > 1;\n\n  if (notEmpty && data[0].geometry.type.toUpperCase() === 'POINT') {\n    return (\n      <div\n        style={{\n          marginRight: !open ? -350 : 0\n        }}\n        className=\"right-panel-container\">\n        <div\n          className=\"close-button\"\n          onClick={() => setOpen(!open)}\n          style={{ color: 'white' }}>\n          <i\n            style={{\n              //bottom and just outside the div\n              marginLeft: -16,\n              bottom: 0,\n              position: 'absolute',\n              backgroundColor: '#242730',\n              fontSize: '2rem', color: 'white !important'\n            }}\n            className={open ? \"fa fa-arrow-circle-right\" :\n              \"fa fa-arrow-circle-left\"} />\n        </div>\n        <div className=\"right-side-panel\">\n          {notEmpty &&\n            <HexbinSeries\n              data={coordsAsXY({ features: data })}\n              options={{ noXAxis: true, noYAxis: true }} />}\n        </div>\n      </div>\n    );\n  } else {\n    return null\n  }\n\n};","import React, { useState } from \"react\";\n\nimport DeckSidebar from \"./DeckSidebar\";\nimport HexPlot from './HexPlot';\n\n/**\n * The idea of this component is to avoid \n * rerender in the main component, everytime\n * open/close is executed. \n * \n * It could add further states to save main component rerendering \n * if need be.\n * \n */\nexport default (props) => {\n  const [open, setOpen] = useState(!props.isMobile);\n  const [hex, setHex] = useState(false);\n\n  // console.log(hex);\n\n  return (\n    <div className=\"side-panel-container\"\n      style={{ marginLeft: open ? 0 : '-320px' }}>\n      <DeckSidebar {...props}\n        // Note: \n        // *****************************\n        // Hooks is strange see this\n        // https://stackoverflow.com/a/54069332/2332101\n        // *****************************\n        toggleOpen={() => setOpen(o => !o)}   // o is current open\n        toggleHexPlot={() => setHex(h => !h)} // h is current hex\n      />\n      {hex &&\n        <HexPlot open={open} isMobile={props.isMobile}\n          data={props.data} />}\n      <div\n        className=\"close-button\"\n        onClick={() => setOpen(!open)}\n        style={{ color: 'white' }}>\n        <div style={{ backgroundColor: '#242730' }}>\n          <i\n            style={{ fontSize: '2rem', color: 'white !important' }}\n            className={open ? \"fa fa-arrow-circle-left\" :\n              \"fa fa-arrow-circle-right\"} />\n        </div>\n      </div>\n    </div>\n  );\n}","// https://github.com/ReactTraining/react-router/blob/master/FAQ.md#how-do-i-access-the-history-object-outside-of-components\n// history.js\nimport { createBrowserHistory } from 'history'\nexport default createBrowserHistory()","import React from 'react';\nimport { LineSeries } from 'react-vis';\nimport { Table } from 'baseui/table';\nimport { humanize } from '../utils';\nimport SeriesPlot from './Showcases/SeriesPlot';\nimport { propertyCountByProperty } from '../geojsonutils';\nimport MultiLinePlot from './Showcases/MultiLinePlot';\n\nconst WIDTH = 220;\nconst BAR_HEIGHT = 80;\n\nexport default class Tooltip extends React.Component {\n  constructor(props) {\n    super();\n    this.state = {\n      isMobile: props.isMobile,\n    };\n    this._listPropsAndValues = this._listPropsAndValues.bind(this);\n  }\n\n  componentWillMount() {\n    window.addEventListener('resize', this._handleWindowSizeChange.bind(this));\n  }\n\n  // make sure to remove the listener\n  // when the component is not mounted anymore\n  componentWillUnmount() {\n    window.removeEventListener('resize', this._handleWindowSizeChange.bind(this));\n  }\n\n  _handleWindowSizeChange = () => {\n    this.forceUpdate()\n  };\n\n  /**\n   * hoverdObject can be of two types so far:\n   * 1. collections of points with `.points` property\n   * 2. properties of `.type === 'Feature'`.\n   */\n  render() {\n    const { topx, topy, hoveredObject } = this.props;\n    const { isMobile } = this.state;\n    // console.log(topx, topy);\n\n    if (!hoveredObject) return null;\n\n    const type_feature = hoveredObject.type && \n    hoveredObject.type === 'Feature';\n    const cluster = hoveredObject && hoveredObject.cluster \n    // {cluster: true, cluster_id: 8, point_count: 54, \n    // point_count_abbreviated: 54}\n\n    let list;\n    let severity_keys = [];\n    let crashes_data = [];\n    let severity_data = [];\n    let severity_data_separate = [];    \n    if (!type_feature && !cluster) {\n      list = hoveredObject.points.map(feature => {\n        const aKey = {}\n        if (feature.properties.hasOwnProperty('accident_severity')) {\n          aKey.severity = feature.properties.accident_severity;\n        }\n        if (feature.properties.hasOwnProperty('date')) {\n          aKey.year = feature.properties.date.split(\"/\")[2];\n        }\n        return (aKey)\n      });\n      const map = new Map()\n      // aggregate severity and years\n      list.forEach(element => {\n        if (element.hasOwnProperty('severity')) {\n          if (map.get(element.severity)) {\n            map.set(element.severity, map.get(element.severity) + 1)\n          } else {\n            map.set(element.severity, 1)\n          }\n        }\n        if (element.hasOwnProperty('year')) {\n          if (map.get(element.year)) {\n            map.set(element.year, map.get(element.year) + 1)\n          } else {\n            map.set(element.year, 1)\n          }\n        }\n      });\n      // list severity and year counts\n      Array.from(map.keys()).forEach(key => {\n        // console.log(key, [ ...map.keys() ]);\n        if (parseInt(key)) { // TODO: replace with moment check - is it year?\n          crashes_data.push({ x: key, y: map.get(key) })\n        } else {\n          // {x: serious, y: 20}\n          // {x: slight: y: 21}\n          severity_data.push({ x: key, y: map.get(key) })\n        }\n      })\n      // separate the severity into [[],[]] arrays\n      severity_keys = Array.from(new Set(severity_data.map(e => e.x)));\n      const severity_by_year = propertyCountByProperty(hoveredObject.points,\n        \"accident_severity\", severity_keys, \"date\");\n      // now turn it into [[],[]]\n      //{2009: {Slight: 1}, 2010: {Slight: 3}, 2012: {Slight: 4}, \n      // 2013: {Slight: 3}, 2014: {Serious: 1}, 2015: {Slight: 6}, \n      // 2016: {Serious: 1, Slight: 2}, 2017: {Slight: 1}}\n      Object.keys(severity_by_year).forEach(y => {\n        severity_by_year[y] &&\n        Object.keys(severity_by_year[y]).forEach(kk => {\n          // get index of kk\n          const index = severity_keys.indexOf(kk);\n          if(!severity_data_separate[index]) {\n            severity_data_separate[index] = [];\n          }\n          // 2016: {Serious: 1, Slight: 2}\n          severity_data_separate[index].push({\n            x: +(y), y: severity_by_year[y][kk]\n          })\n        })\n      })\n    }\n    // console.log(crashes_data);\n    \n    const w = window.innerWidth;\n    const y = window.innerHeight;\n    const n_topy = isMobile ? 10 :\n      topy + (WIDTH + BAR_HEIGHT) > y ? topy - WIDTH : topy;\n    const n_left = isMobile ? 10 :\n      topx + WIDTH > w ? topx - WIDTH : topx;    \n    const tooltip =\n      <div\n        className=\"xyz\" style={{\n          top: topy + (WIDTH + BAR_HEIGHT) > y ? n_topy : topy,\n          left: topx + WIDTH > w ? n_left : topx\n        }}>\n        <div>\n          <b>Total: {cluster ? hoveredObject.point_count : \n            type_feature ? 1 : hoveredObject.points.length}</b>\n        </div>\n        <div>\n          {\n            // Simple logic, if points and less two points or less,\n            // or not poingts, hard to expect React-vis generating plot.\n            // so list the values of the non-point or list both points.\n            !cluster && (type_feature || hoveredObject.points.length <= 2) &&\n            this._listPropsAndValues(hoveredObject)\n          }\n          {\n            severity_data_separate.length > 1 ?\n            <MultiLinePlot\n              data={[...severity_data_separate, crashes_data]}\n              legend={[...severity_keys, 'Total']}\n              title=\"Crashes\" noYAxis={true}\n              plotStyle={{ height: 100, marginBottom: 50 }}\n            /> :\n            <SeriesPlot title={severity_keys.length === 1 && severity_keys[0]} \n            data= {crashes_data} type= {LineSeries} />\n          }\n        </div>\n      </div >\n    return (tooltip)\n  }\n\n  _listPropsAndValues(hoveredObject) {\n    let DATA = []\n    const props = hoveredObject.properties;\n    if(props) {\n      DATA = Object.keys(props)\n      .map(p => {\n        return([humanize(p), props[p]])\n      })\n    } else { // two points passed go through first one\n      DATA = Object.keys(hoveredObject.points[0].properties)\n      .map(p => {\n        let points = [\n          humanize(p), \n          hoveredObject.points[0].properties[p],\n        ]\n        if(hoveredObject.points[1]) {\n          points.push(hoveredObject.points[1].properties[p])\n        }\n        return(points)\n      })\n    }\n    return <Table style={{maxWidth: '320px'}} \n    columns={\n      hoveredObject.points && \n      hoveredObject.points.length === 2 ? \n      ['Property', 'Value p1', 'Value p2'] : ['Property', 'Value'] \n    } data={DATA} />\n\n  }\n}","/**\n * Main entry to the application.\n * \n * The crucial bits are:\n * \n     this.state = {\n      data,            <= main data holding param   \n      layers: [],      <= mapgl layers object\n      initialViewState:<= deckgl/mapgl initial state object\n      legend: false    <= map legend to avoid rerender.\n    }\n * and\n * DeckSidebarContainer which holds DeckSidebar object itself.\n * \n * Main funcitons:\n * _generateLayer which is the main/factory of filtering state\n * of the map area of the application.\n * \n */\nimport React from 'react';\nimport DeckGL from 'deck.gl';\nimport MapGL, { NavigationControl, FlyToInterpolator } from 'react-map-gl';\nimport centroid from '@turf/centroid';\nimport bbox from '@turf/bbox';\nimport _ from 'underscore';\n\nimport {\n  fetchData, generateDeckLayer,\n  getParamsFromSearch, getBbx,\n  isMobile, colorScale,\n  colorRanges,\n  convertRange, getMin, getMax, isURL\n} from './utils';\nimport Constants from './Constants';\nimport DeckSidebarContainer from\n  './components/DeckSidebar/DeckSidebarContainer';\nimport history from './history';\n\nimport './App.css';\nimport Tooltip from './components/Tooltip';\nimport { sfType } from './geojsonutils';\nimport { isNumber, isArray } from './JSUtils';\n\nconst osmtiles = {\n  \"version\": 8,\n  \"sources\": {\n    \"simple-tiles\": {\n      \"type\": \"raster\",\n      \"tiles\": [\n        // \"http://tile.openstreetmap.org/{z}/{x}/{y}.png\",\n        // \"http://b.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n        // \"http://tile.stamen.com/toner/{z}/{x}/{y}.png\"\n        'https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.jpg'\n      ],\n      \"tileSize\": 256\n    }\n  },\n  \"layers\": [{\n    \"id\": \"simple-tiles\",\n    \"type\": \"raster\",\n    \"source\": \"simple-tiles\",\n  }]\n};\nconst URL = (process.env.NODE_ENV === 'development' ? Constants.DEV_URL : Constants.PRD_URL);\nconst defualtURL = \"data/COVID19_NZ.json\";\n\n// Set your mapbox access token here\nconst MAPBOX_ACCESS_TOKEN = process.env.REACT_APP_MAPBOX_ACCESS_TOKEN;\n\nconst gradient = {\n  height: '200px',\n  // TODO: which browsers?\n  backgroundColor: 'red', /* For browsers that do not support gradients */\n  backgroundImage: 'linear-gradient(to top, red , yellow)' /* Standard syntax (must be last) */\n}\n\nconst LIGHT_SETTINGS = {\n  lightsPosition: [-0.144528, 49.739968, 8000, -3.807751, 54.104682, 8000],\n  ambientRatio: 0.4,\n  diffuseRatio: 0.6,\n  specularRatio: 0.2,\n  lightsStrength: [0.8, 0.0, 0.8, 0.0],\n  numberOfLights: 2\n};\n\nexport default class Welcome extends React.Component {\n  constructor(props) {\n    super(props)\n    const init = {\n      longitude: -1.6362,\n      latitude: 53.8321,\n      zoom: 5,\n    }\n    const param = getParamsFromSearch(props.location.search);\n    if (param) {\n      //lat=53.814&lng=-1.534&zoom=11.05&bea=0&pit=55&alt=1.5\n      Object.keys(param).forEach(key => {\n        Object.keys(init).forEach(iKey => {\n          if (iKey.startsWith(key)) {\n            init[key] = param[key]\n          }\n        })\n      })\n    }\n\n    this.state = {\n      layerStyle: 'heatmap',\n      column: 'TotalCases',\n      loading: true,\n      layers: [],\n      backgroundImage: gradient.backgroundImage,\n      radius: 100,\n      elevation: 4,\n      mapStyle: MAPBOX_ACCESS_TOKEN ? (\"mapbox://styles/mapbox/\" +\n        (props.dark ? \"dark\" : \"basic\") + \"-v9\") : osmtiles,\n      initialViewState: init,\n      subsetBoundsChange: false,\n      lastViewPortChange: new Date(),\n      colourName: 'default',\n      iconLimit: 500,\n      legend: false\n    }\n    this._generateLayer = this._generateLayer.bind(this)\n    this._renderTooltip = this._renderTooltip.bind(this);\n    this._fetchAndUpdateState = this._fetchAndUpdateState.bind(this);\n    this._fitViewport = this._fitViewport.bind(this);\n  }\n\n  componentDidMount() {\n    this._fetchAndUpdateState()\n  }\n\n  /**\n   * Main function to fetch data and update state.\n   * \n   * @param {String} aURL to use if not default `/api/covid19` is used.\n   * @param {Object} customError to use in case of urlCallback object/urls.\n   */\n  _fetchAndUpdateState(aURL, customError) {\n    if (aURL && !isURL(aURL)) return;\n    if (customError && typeof (customError) !== 'object') return;\n    // TODO: more sanity checks?\n    const fullURL = aURL ?\n      // TODO: decide which is better.\n      // URL + \"/api/url?q=\" + aURL : // get the server to parse it \n      aURL : // do not get the server to parse it \n      URL + defualtURL;\n\n    fetchData(fullURL, (data, error) => {\n      if (!error) {\n        // this._updateURL(viewport)\n        this.setState({\n          loading: false,\n          data: data,\n          alert: customError || null\n        })\n        this._fitViewport(data)\n        this._generateLayer()\n      } else {\n        this.setState({\n          loading: false,\n          alert: { content: 'Could not reach: ' + fullURL }\n        })\n        //network error?\n      }\n    })\n  }\n\n  /**\n   * Welcome should hold own state in selected as:\n   * {property: Set(val1, val2), ...}.\n   * \n   * @param {*} values includes\n   * radius: specific to changing geoms\n   * elevation: specific to changing geoms\n   * filter: multivariate filter of properties\n   * cn: short for colorName passed from callback\n   * TODO: other\n   */\n  _generateLayer(values = {}) {\n    const { radius, elevation, filter, cn } = values;\n\n    if (filter && filter.what === 'mapstyle') {\n      this.setState({\n        mapStyle: !MAPBOX_ACCESS_TOKEN ? osmtiles :\n          filter && filter.what === 'mapstyle' ? \"mapbox://styles/mapbox/\" + filter.selected + \"-v9\" : this.state.mapStyle,\n      })\n      return;\n    }\n    let data = this.state.data && this.state.data.features\n    const { colourName, iconLimit } = this.state;\n    let column = (filter && filter.what === 'column' && filter.selected) ||\n      this.state.column;\n\n    if (!data) return;\n    if (filter && filter.what === \"%\") {\n      data = data.slice(0, filter.selected / 100 * data.length)\n    }\n    // to optimize the search keep state as the source of truth\n    if (this.state.coords) {\n      data = this.state.filtered;\n    }\n    const geomType = sfType(data[0]).toLowerCase();\n    //if resetting a value\n    if (filter && filter.selected !== \"\") {\n      data = data.filter(\n        d => {\n          if (filter.what === 'multi') {\n            // go through each selection\n            const selected = filter.selected;\n            // selected.var > Set()\n            for (let each of Object.keys(selected)) {\n              const nextValue = each === \"date\" ?\n                d.properties[each].split(\"/\")[2] : d.properties[each] + \"\"\n              // each from selected must be in d.properties\n              if (!selected[each].has(nextValue)) {\n                return false\n              }\n            }\n          }\n          if (filter.what === 'coords') {\n            // coords in \n            if (_.difference(filter.selected || this.state.coords,\n              d.geometry.coordinates.flat()).length !== 0) {\n              return false;\n            }\n          }\n          return (true)\n        }\n      )\n    }\n    // console.log(data.length);\n    let layerStyle = (filter && filter.what ===\n      'layerStyle' && filter.selected) || this.state.layerStyle || 'grid';\n    if (geomType !== \"point\") layerStyle = \"geojson\"\n    if (data.length < iconLimit && !column &&\n      geomType === \"point\") layerStyle = 'icon';\n    const options = {\n      radius: radius ? radius : this.state.radius,\n      cellSize: radius ? radius : this.state.radius,\n      elevationScale: elevation ? elevation : this.state.elevation,\n      lightSettings: LIGHT_SETTINGS,\n      colorRange: colorRanges(cn || colourName)\n    };\n    if (layerStyle === 'geojson') {\n      options.getFillColor = (d) => colorScale(d, data) //first prop\n    }\n    let columnNameOrIndex =\n      (filter && filter.what === 'column' && filter.selected) || column || 1;\n    if (layerStyle === 'heatmap') {\n      options.getPosition = d => d.geometry.coordinates\n      // options.getWeight = d => d.properties[columnNameOrIndex]\n    }\n    if (geomType === 'linestring') {\n      layerStyle = \"line\"\n      // https://github.com/uber/deck.gl/blob/master/docs/layers/line-layer.md\n      options.getColor = d => [235, 170, 20]\n      options.getPath = d => d.geometry.coordinates\n      options.onClick = (info) => {\n        // console.log(info);\n        if (info && info.hasOwnProperty('coordinate')) {\n          if (['path', 'arc', 'line'].includes(this.state.layerStyle) &&\n            info.object.geometry.coordinates) {\n            this._generateLayer({\n              filter: {\n                what: 'coords',\n                selected: info.object.geometry.coordinates[0]\n              }\n            })\n          }\n        }\n      }\n      if (layerStyle === 'line') {\n        // options.getSourceColor = d => [Math.sqrt(+(d.properties.base)) * 1000, 140, 0]\n        // options.getTargetColor = d => [Math.sqrt(+(d.properties.hs2)) * 1e13, 140, 0]\n        options.getSourcePosition = d => d.geometry.coordinates[0] // geojson\n        options.getTargetPosition = d => d.geometry.coordinates[1] // geojson\n      }\n      if (isNumber(data[0] && data[0].properties &&\n        data[0].properties[columnNameOrIndex])) {\n        const colArray = data.map(f => f.properties[columnNameOrIndex])\n        const max = getMax(colArray);\n        const min = getMin(colArray)\n        options.getWidth = d => {\n          let newMax = 10, newMin = 0.1;\n          if (data.length > 100000) {\n            newMax = 0.5; newMin = 0.005\n          }\n          const r = convertRange(\n            d.properties[columnNameOrIndex], {\n            oldMin: min, oldMax: max, newMax: newMax, newMin: newMin\n          })\n          return r\n        }; // avoid id\n      }\n    }\n    const cols = Object.keys(data && data[0] && \n      data[0].properties);\n    if (geomType === \"polygon\" || geomType === \"multipolygon\") {\n      // TODO: remove SPENSER\n      const SPENSER = isArray(cols) && cols.length > 0 && \n      cols[1] === 'GEOGRAPHY_CODE';\n      if (SPENSER) {\n        options.getElevation = d => (isNumber(d.properties[column]) &&\n          column !== 'YEAR' && d.properties[column]) || null\n      }\n      // TODO: allow user to specify column.\n      options.getFillColor = (d) =>\n        colorScale(d, data, column ? column : SPENSER ? 1 : 0)\n    }\n    if(geomType === \"point\" && cols.includes(\"TotalCases\")) {\n      options.getPosition = d => d.geometry.coordinates;\n      options.getFillColor = d => colorScale(d, data, 1) //2nd prop\n      options.getRadius = d => +(Object.values(d.properties)[2]) * 30\n    }\n    const alayer = generateDeckLayer(\n      layerStyle, data, this._renderTooltip, options\n    )\n\n    this.setState({\n      loading: false,\n      layerStyle, geomType,\n      tooltip: \"\",\n      filtered: data,\n      layers: [alayer],\n      radius: radius ? radius : this.state.radius,\n      elevation: elevation ? elevation : this.state.elevation,\n      road_type: filter && filter.what === 'road_type' ? filter.selected :\n        this.state.road_type,\n      colourName: cn || colourName,\n      column, // all checked\n      coords: filter && filter.what === 'coords' ? filter.selected :\n        this.state.coords\n    })\n  }\n\n  _fitViewport(newData, bboxLonLat) {\n    const data = newData || this.state.data;\n    if (!data || data.length === 0) return;\n    const center = centroid(data).geometry.coordinates;\n    const bounds = bboxLonLat ?\n      bboxLonLat.bbox : bbox(data)\n    // console.log(center, bounds);\n\n    this.map.fitBounds(bounds)\n    const viewport = {\n      ...this.state.viewport,\n      longitude: bboxLonLat ? bboxLonLat.lon : center[0],\n      latitude: bboxLonLat ? bboxLonLat.lat : center[1],\n      transitionDuration: 500,\n      transitionInterpolator: new FlyToInterpolator(),\n      // transitionEasing: d3.easeCubic\n    };\n    this.setState({ viewport })\n  }\n\n  _renderTooltip({ x, y, object }) {\n    const hoveredObject = object;\n    // console.log(hoveredObject && hoveredObject.points[0].properties.speed_limit);\n    // console.log(hoveredObject)\n    // return\n    if (!hoveredObject) {\n      this.setState({ tooltip: \"\" })\n      return;\n    }\n    this.setState({\n      tooltip:\n        // react did not like x and y props.\n        <Tooltip\n          isMobile={isMobile()}\n          topx={x} topy={y} hoveredObject={hoveredObject} />\n    })\n  }\n\n  _updateURL(viewport) {\n    const { latitude, longitude, zoom, bearing, pitch, altitude } = viewport;\n    const { subsetBoundsChange, lastViewPortChange } = this.state;\n\n    //if we do history.replace/push 100 times in less than 30 secs \n    // browser will crash\n    if (new Date() - lastViewPortChange > 1000) {\n      history.push(\n        `/?lat=${latitude.toFixed(3)}` +\n        `&lng=${longitude.toFixed(3)}` +\n        `&zoom=${zoom.toFixed(2)}` +\n        `&bea=${bearing}` +\n        `&pit=${pitch}` +\n        `&alt=${altitude}`\n      )\n      this.setState({ lastViewPortChange: new Date() })\n      // if(zoom < 6) {\n      //   this._fetchAndUpdateState('http://eatlas.geoplumber.com/api/covid19r');\n      // } else {\n      //   this._fetchAndUpdateState();\n      // }\n    }\n    const bounds = this.map && this.map.getBounds()\n    if (bounds && subsetBoundsChange) {\n      const box = getBbx(bounds)\n      // console.log(\"bounds\", box);\n      const { xmin, ymin, xmax, ymax } = box;\n      fetchData(URL + defualtURL + xmin + \"/\" +\n        ymin + \"/\" + xmax + \"/\" + ymax,\n        (data, error) => {\n          if (!error) {\n            // console.log(data.features);\n            this.setState({\n              data: data.features,\n            })\n            this._generateLayer()\n          } else {\n            //network error?\n          }\n        })\n    }\n\n  }\n\n  render() {\n    const { tooltip, viewport, initialViewState,\n      loading, mapStyle, alert,\n      layerStyle, geomType, legend, coords } = this.state;\n    // console.log(geomType, legend);\n\n    return (\n      <div id=\"html2pdf\">\n        {/* just a little catch to hide the loader \n        when no basemap is presetn */}\n        <div className=\"loader\" style={{\n          zIndex: loading ? 999 : -1,\n          visibility: typeof mapStyle === 'string' &&\n            mapStyle.endsWith(\"No map-v9\") ? 'hidden' : 'visible'\n        }} />\n        <MapGL\n          ref={ref => {\n            // save a reference to the mapboxgl.Map instance\n            this.map = ref && ref.getMap();\n          }}\n          mapStyle={mapStyle}\n          onViewportChange={(viewport) => {\n            this._updateURL(viewport)\n            this.setState({ viewport })\n          }}\n          height={window.innerHeight - 54 + 'px'}\n          width={window.innerWidth + 'px'}\n          //crucial bit below\n          viewState={viewport ? viewport : initialViewState}\n        // mapboxApiAccessToken={MAPBOX_ACCESS_TOKEN}\n        >\n          <div className='mapboxgl-ctrl-top-right' style={{\n            zIndex: 9\n          }}>\n            <NavigationControl\n              {...viewport}\n              onViewportChange={viewport => this.setState({ viewport })}\n            />\n          </div>\n          <DeckGL\n            viewState={viewport ? viewport : initialViewState}\n            initialViewState={initialViewState}\n            layers={this.state.layers}\n            // see docs below, url split for readability\n            // https://deck.gl/#/documentation/developer-guide/\n            // adding-interactivity?\n            // section=using-the-built-in-event-handling\n            onClick={(e) => {\n              if (!e.layer && coords) {\n                this.setState({ coords: null })\n                this._generateLayer()\n              }\n            }}\n          >\n            {tooltip}\n          </DeckGL>\n        </MapGL>\n        <DeckSidebarContainer\n          dark={this.props.dark}\n          layerStyle={layerStyle}\n          isMobile={isMobile()}\n          key=\"decksidebar\"\n          alert={alert}\n          TotalCases={this.state.filtered && \n            this.state.filtered.map(e => e.properties.TotalCases).reduce(\n            (t,v) => t+v\n          )}\n          data={this.state.filtered}\n          colourCallback={(colourName) =>\n            this._generateLayer({ cn: colourName })\n          }\n          urlCallback={(url_returned, geojson_returned) => {\n            this.setState({\n              tooltip: \"\",\n              road_type: \"\",\n              radius: 100,\n              elevation: 4,\n              loading: true,\n              coords: null,\n              layerStyle: url_returned && url_returned.endsWith(\"covid19w\") ?\n              \"heatmap\" : this.state.layerStyle\n            })\n            if (geojson_returned) {\n              // confirm valid geojson\n              try {\n                this.setState({\n                  data: geojson_returned\n                })\n                this._fitViewport(geojson_returned)\n                this._generateLayer()\n              } catch (error) {\n                // load up default\n                this._fetchAndUpdateState(undefined, { content: error.message });\n              }\n            } else {\n              this._fetchAndUpdateState(url_returned);\n            }\n          }}\n          column={this.state.column}\n          onSelectCallback={(selected) => this._generateLayer({ filter: selected })}\n          onChangeRadius={(value) => this._generateLayer({ radius: value })}\n          onChangeElevation={(value) => this._generateLayer({ elevation: value })}\n          toggleSubsetBoundsChange={(value) => {\n            this.setState({\n              loading: true,\n              subsetBoundsChange: value\n            })\n            this._fetchAndUpdateState();\n          }}\n          onlocationChange={(bboxLonLat) => {\n            this._fitViewport(bboxLonLat)\n          }}\n          showLegend={(legend) => this.setState({ legend })}\n          datasetName={defualtURL}\n        />\n        {\n          legend && (geomType === 'polygon' ||\n            geomType === 'multipolygon') &&\n          <div className=\"right-side-panel mapbox-legend\">\n            {legend}\n          </div>\n        }\n      </div>\n    );\n  }\n}","/**\n * geoplumber R package code.\n */\nimport React, { useState } from 'react';\nimport { Navbar, Nav, NavItem } from 'react-bootstrap';\nimport { Link, withRouter } from 'react-router-dom';\n\nimport { ATILOGO } from '../utils';\n\nconst navs = [\n  {\n    key: 1,\n    to: \"fui\",\n    title: \"DUI\"\n  },\n  {\n    key: 2,\n    to: \"about\",\n    title: \"About\"\n  },\n];\n\nfunction Header(props) {\n  const [dark, setDark] = useState(props.dark)\n  return (\n    <Navbar inverse={dark} collapseOnSelect>\n      <Navbar.Header>\n        <Navbar.Brand>\n          <Link to=\"/\">\n            <span style={{color: dark ? 'white' : 'black'}}>COVID19</span>\n          </Link>\n        </Navbar.Brand>\n        <Navbar.Toggle />\n      </Navbar.Header>\n      <Navbar.Collapse>\n        <Nav>\n          {\n            navs.map((item, i) => {\n              return (\n                <NavItem\n                  key={i}\n                  eventKey={item.key}\n                  onClick={() => props.history.push(item.to)}>\n                  {item.title}\n                </NavItem>\n              )\n            })\n          }\n        </Nav>\n        {/* trick RB with navbar-nav > li a but do it like following*/}\n        {/* <div className=\"nav navbar-nav\">\n            <li>\n              <a href=\"https://github.com/layik/eAtlas\">\n                <i style={{ fontSize: '1.5em' }} className=\"fa fa-github\"></i>\n              </a>\n            </li>\n          </div> */}\n        <Nav pullRight>\n          <NavItem href=\"https://github.com/layik/eAtlas\">\n            <i style={{ fontSize: '1.5em' }} className=\"fa fa-github\"></i>\n          </NavItem>\n        </Nav>\n        <Nav pullRight>\n          <NavItem onClick={() => {\n            typeof props.toggleTheme === 'function' && props.toggleTheme()\n            setDark(!dark)\n          }}>\n            <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n              <g transform=\"matrix( 1 0 0 1 4 1 )\">\n                <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\n                  d=\"M15.3999 11C15.7999 10.1 16 9 16 8C16 3.6 12.4 0 8 0C3.6 0 0 3.6 0 8C0 9.1 0.200098 10.1 0.600098 11L2.19995 15L13.8 15L15.3999 11ZM11 22L12.6001 18L3.3999 18L5 22L11 22Z\" fill={\n                    dark ? '#fff' : '#000'\n                  } opacity=\"1\">\n                </path>\n              </g>\n            </svg>\n          </NavItem>\n        </Nav>\n      </Navbar.Collapse>\n    </Navbar >\n  )\n}\n\n// thanks to https://stackoverflow.com/a/42124328/2332101\nexport default withRouter(Header);\n","/**\n * L Hama\n */\nimport React, { Component } from 'react';\nimport marked from \"marked\";\n\n/**\n * Separate the Header and the main content.\n * Up to this point we are still not using SSR\n */\nclass About extends Component {\n  state = { markdown: null }\n  componentDidMount() {\n    const readmePath = require(\"./notes.md\");\n\n    fetch(readmePath)\n      .then(response => {\n        return response.text()\n      })\n      .then(text => {\n        this.setState({\n          markdown: marked(text)\n        })\n      })\n  }\n  render() {\n    const { markdown } = this.state;\n\n    return (\n      <section style={{ background: 'white', padding: '5%' }}>\n        <article dangerouslySetInnerHTML={{ __html: markdown }}></article>\n      </section>\n    )\n  }\n}\n\nexport default About;\n","import { Component } from 'react'\n//https://tylermcginnis.com/react-router-code-splitting/\n//we can further add our laoding spinner here.\nexport default class DynamicImport extends Component {\n  state = {\n    component: null\n  }\n  componentDidMount () {\n    this.props.load()\n      .then((component) => {\n        this.setState(() => ({\n          component: component.default ? component.default : component\n        }))\n      })\n  }\n  render() {\n    return this.props.children(this.state.component)\n  }\n}","/**\n * geoplumber R package code.\n */\nimport React, { useState } from 'react';\nimport { Switch, Route } from 'react-router-dom';\n\nimport Welcome from './Welcome';\nimport Header from './components/Header';\nimport About from './About';\nimport DynamicImport from './components/DynamicImport';\n\nimport { Provider as StyletronProvider } from 'styletron-react';\nimport { BaseProvider, LightTheme, DarkTheme } from 'baseui';\nimport { Client as Styletron } from 'styletron-engine-atomic';\n\nimport '../node_modules/react-vis/dist/style.css';\n\nimport './App.css';\n\nconst engine = new Styletron();\n\n/**\n * Code splitting.\n * @param {*} props \n */\nconst DUI = (props) => (\n  <DynamicImport load={() => import('./components/DUI')}>\n    {\n      (Component) => Component === null\n        ? <div className=\"loader\" style={{ zIndex: 999 }} />\n        : <Component {...props} />\n    }\n  </DynamicImport>\n)\n\n/**\n * Separate the Header and the main content.\n * Up to this point we are still not using SSR\n */\nfunction App() {\n    const [dark, setDark] = useState(false)\n    \n    return (\n      <main>\n        <Header dark={dark}\n        toggleTheme={() => setDark(!dark)}/>\n        <StyletronProvider value={engine}>\n          <BaseProvider theme={dark ? DarkTheme : LightTheme}>\n            <Switch>\n              <Route exact path=\"/\" component={(props) => <Welcome \n              {...props}\n              dark={dark}\n              />} />\n              <Route exact path=\"/fui\" component={(props) => <DUI \n              {...props}\n              dark={dark}\n              />} />\n              <Route exact path=\"/about\" component={About} />\n            </Switch>\n          </BaseProvider>\n        </StyletronProvider>\n      </main>\n    )\n}\n\nexport default App;\n","// In production, we register a service worker to serve assets from local cache.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on the \"N+1\" visit to a page, since previously\n// cached resources are updated in the background.\n\n// To learn more about the benefits of this model, read https://goo.gl/KwvDNy.\n// This link also includes instructions on opting out of this behavior.\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport default function register() {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Lets check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://goo.gl/SC7cgQ'\n          );\n        });\n      } else {\n        // Is not local host. Just register service worker\n        registerValidSW(swUrl);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the old content will have been purged and\n              // the fresh content will have been added to the cache.\n              // It's the perfect time to display a \"New content is\n              // available; please refresh.\" message in your web app.\n              console.log('New content is available; please refresh.');\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      if (\n        response.status === 404 ||\n        response.headers.get('content-type').indexOf('javascript') === -1\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","/**\n * geoplumber R package code.\n */\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\n\nimport App from './App';\n// brief about serviceworkers from CRA\n// https://stackoverflow.com/a/49314454/11101153\nimport { unregister } from './registerServiceWorker';\n\n// keep leaflet for now in case.\n\n// *** Do NOT remove, it seems the location for icon is missing or something\nimport L from 'leaflet';\ndelete L.Icon.Default.prototype._getIconUrl;\n\nL.Icon.Default.mergeOptions({\n  iconRetinaUrl: require('leaflet/dist/images/marker-icon-2x.png'),\n  iconUrl: require('leaflet/dist/images/marker-icon.png'),\n  shadowUrl: require('leaflet/dist/images/marker-shadow.png'),\n});\n\n/**\n * Separating index.js and App.js:\n * 1. doing above like launch configs here\n * 2. keep App.js clear for React application.\n */\nReactDOM.render(\n  <BrowserRouter basename=\"/eAtlas/\">\n    <App />\n  </BrowserRouter>, document.getElementById('root'));\n\nunregister();\n","import {\n  isNumber, isBoolean, isObject,\n  isDate, isString\n} from './JSUtils';\n\nconst { DateTime } = require(\"luxon\");\n\n// thanks turfjs\n//http://wiki.geojson.org/GeoJSON_draft_version_6\nconst sfType = (geojson) => {\n  if (geojson.type === \"FeatureCollection\") { return \"FeatureCollection\"; }\n  if (geojson.type === \"GeometryCollection\") { return \"GeometryCollection\"; }\n  if (geojson.type === \"Feature\" && geojson.geometry !== null) { \n    return geojson.geometry.type; \n  }  \n  return geojson.type;\n}\n\nconst properties = (geojson) => {\n  if (!geojson || !geojson.features) return null;\n  var properties = geojson.features[0].properties;\n  return Object.keys(properties);\n}\n\n/**\n * Find all columns which can be considered as key columns.\n * Using `getPropertyValues` we compare the length with\n * geojson objects and determin which olumn can be considered as key.\n * \n * @param {Object} geojson to process\n * @returns array of keys or null if none.\n */\nconst getKeyColumns = (geojson) => {\n  if (!geojson || !geojson.features) return null;  \n  const keys = [];\n  const all_property_counts = getPropertyValues(geojson);\n  Object.keys(all_property_counts).forEach(column => {\n    if(Array.from(all_property_counts[column]).length === \n    geojson.features.length) {\n      keys.push(column); \n      // if property values of column === geojson.features\n      // must be unique      \n    }\n  })\n  return keys.length > 0 ? keys : null;\n}\n\n/**\n * Given an array of [E010000001, S010000001] the function checks\n * all values within the array and returns true if all matches\n * pattern for UK ONS codes.\n * See https://en.wikipedia.org/wiki/ONS_coding_system\n * \n * @param {*} array \n */\nconst isONSCode = (array) => {\n  if(!array || array.length === 0) return false;\n  let result = true;\n  array.forEach(e => {\n    if(!isString(e) || e.length !== 9 || !e.match(/^[EWS]\\d{2}.{6}$/)) {\n      result = false;\n    }\n  })\n  return result;\n}\n/**\n * {some: data, another: value}\n * turn it into {some: type, another: type}\n * @param {Object} feature \n */\nconst describeFeatureVariables = (feature) => {\n  if (!feature || feature.type !== 'Feature') return null;\n  const description = {};\n\n  Object.keys(feature.properties).forEach(key => {\n    let v_type = String;\n    const value = feature.properties[key];\n\n    if (isDate(value) ||\n      DateTime.fromFormat(value + '', 'MMMM dd yyyy').isValid ||\n      DateTime.fromFormat(value + '', 'MMMM d yyyy').isValid ||\n      DateTime.fromFormat(value + '', 'MMM d yyyy').isValid ||\n      DateTime.fromFormat(value + '', 'MMM dd yyyy').isValid ||\n      DateTime.fromFormat(value + '', 'dd/MM/yyyy').isValid ||\n      DateTime.fromISO(value).isValid || // \"19-2-1999\"\n      DateTime.fromHTTP(value).isValid ||\n      (typeof value === Number && DateTime.fromMillis(value).isValid)) {\n      v_type = Date\n    } else if (isNumber(value)) {\n      v_type = Number\n    } else if (isBoolean(value)) {\n      v_type = Boolean\n    } else if (isObject(value)) {\n      v_type = Object\n    }\n    description[key] = v_type;\n  })\n  return (description)\n}\n\n/**\n * This function takes a geojson object and optionally a property\n * it returns a set (in array) object of all values for that property.\n * \n * If no property is given it gets all properties\n * of each feature and adds unique values for each in a Set.\n * \n * @param {Object} geojson \n * @param {String} property \n */\nconst getPropertyValues = (geojson, property) => {\n  if (!geojson || !geojson.features) return null;\n  const all = {}\n  let values = new Set();\n  geojson.features.forEach(feature => {\n    Object.keys(feature.properties).forEach((each) => {\n      if (property && property === each) {\n        // if the right property, \n        // add it to the value to be returnd\n        values.add(feature.properties[each])\n      } else {\n        if (typeof (all[each]) === 'object') { // a set\n          all[each].add(feature.properties[each])\n        } else {\n          all[each] = new Set();\n          all[each].add(feature.properties[each])\n        }\n      }\n    })\n  })\n  return property ? Array.from(values) : all;\n}\n\n/**\n * Get a list of {x:property, y:count} objects for a features in \n * a geojson object. The function can return the counts for\n * a specific list provided or it would get all values in \n * the given key/column of the data.\n * \n * @param {Object} data features to loop through. \n * @param {String} key a particular property as key\n * @param {Object} list of values to limit return their counts\n * \n * @returns {Object}\n */\nconst propertyCount = (data, key, list) => {\n  if (!data || !key) return;\n  let sub_data = []; // match it with list\n  let list_copy = list;  \n  if(!list || list.length === 0) {\n    list_copy = getPropertyValues ({\n      features: data\n    }, key)    \n  }\n  data.forEach(feature => {\n    Object.keys(feature.properties).forEach(each => {\n      if (each === key) {\n        // create an array matching given list\n        // if no list match first \n        const i = list_copy.indexOf(feature.properties[each]);\n        if (sub_data[i] &&\n          sub_data[i].x === feature.properties[each]) {\n          sub_data[i].y += 1;\n        }\n        else {\n          sub_data[i] = { x: feature.properties[each], y: 1 };\n        }\n      }\n    });\n  });\n  return sub_data;\n}\n\n/**\n * Generate an object with frequency of values of a particular property, arranged\n * under a different property. Given features = \n * [{p1: a, p2: b, p3: v1},\n * {p1: a, p2: b, p3: v1},\n * {p1: b, p2: a, p3: v2},\n * ].\n * The function returns an object {v1: {a: 2, b: 2}, v2: {a:1, b:1}}\n * \n * @param {Object} data features to loop through. \n * @param {String} key a particular property as key\n * @param {Object} list of values to return their counts\n * @param {String} key2 a different property as key\n * @returns {Object} \n */\nconst propertyCountByProperty = (data, key, list, key2) => {\n  if (!data || !key || !list || !key2 || key === key2) return;\n  let sub_data = {} // create object based on key2 values\n  data.forEach(feature => {\n    const k2 = key2 === 'date' &&  \n    DateTime.fromFormat(feature.properties[key2] + '', 'dd/MM/yyyy').isValid ? \n    feature.properties[key2].split(\"/\")[2] : feature.properties[key2];\n    Object.keys(feature.properties).forEach(each => {\n      if (each === key) {\n        // create object based on key2 values\n        if (sub_data[k2] && sub_data[k2][feature.properties[each]]) {\n          sub_data[k2][feature.properties[each]] += 1;\n        }\n        else {\n          sub_data[k2] = Object.assign(\n            sub_data[k2] || {}, { [feature.properties[each]]: 1}\n          );\n        }\n      }\n    });\n  });\n  return sub_data;\n}\n\nconst coordsAsXY = (geojson, sizeProperty) => {\n  if (!geojson.features) return null;\n  return (\n    geojson.features.map(each => {\n      // lon lat please\n      const result = {\n        x: each.geometry.coordinates[0],\n        y: each.geometry.coordinates[1]\n      }\n      if (sizeProperty && each.properties[sizeProperty]) {\n        result.size = each.properties[sizeProperty]\n      }\n      return (result)\n    })\n  )\n}\n\nexport {\n  describeFeatureVariables,\n  propertyCountByProperty,\n  getPropertyValues,\n  getKeyColumns,\n  propertyCount,\n  properties,\n  coordsAsXY,\n  isONSCode,\n  sfType\n}","function define(name, value) {\n  Object.defineProperty(exports, name, {\n    value: value,\n    enumerable: true\n  });\n}\n\n// TODO: change to domain name \ndefine(\"PRD_URL\", 'https://uoa-eresearch.github.io/eAtlas/');\ndefine(\"DEV_URL\", '');\ndefine(\"UI_LIST\", [\n  \"checkbox\",\n  \"radio\",\n  \"buttongroups\",\n  \"dropdown\",\n  \"slider\"]) \ndefine(\"LAYERSTYLES\", [\n  \"arc\",\n  \"geojson\",\n  \"grid\",\n  \"heatmap\",\n  \"hex\",\n  \"icon\",\n  \"line\",\n  \"path\",\n  \"scatterplot\",\n  \"sgrid\"\n])     \n"],"sourceRoot":""}